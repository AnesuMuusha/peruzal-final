<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Maps and Location - Xamarin iOS Guides</title>
    <meta name="generator" content="Hugo 0.17" />

    
    <meta name="description" content="Xamrin iOS guides for the Peruzal Cross Platform Mobile App Development course">
    
    <link rel="canonical" href="http://guides.peruzal.com/ios-guides/maps-and-location/">
    
    <meta name="author" content="Peruzal">
    

    <meta property="og:url" content="http://guides.peruzal.com/ios-guides/maps-and-location/">
    <meta property="og:title" content="Xamarin iOS Guides">
    <meta property="og:image" content="http://guides.peruzal.com/ios-guides/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Xamarin iOS Guides">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://guides.peruzal.com/ios-guides/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="http://guides.peruzal.com/ios-guides/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://guides.peruzal.com/ios-guides/fonts/icon.eot?52m981');
        src: url('http://guides.peruzal.com/ios-guides/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('http://guides.peruzal.com/ios-guides/fonts/icon.woff?52m981')
               format('woff'),
             url('http://guides.peruzal.com/ios-guides/fonts/icon.ttf?52m981')
               format('truetype'),
             url('http://guides.peruzal.com/ios-guides/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://guides.peruzal.com/ios-guides/stylesheets/application.css">
    <link rel="stylesheet" href="http://guides.peruzal.com/ios-guides/stylesheets/temporary.css">
    <link rel="stylesheet" href="http://guides.peruzal.com/ios-guides/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://guides.peruzal.com/ios-guides/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="http://guides.peruzal.com/ios-guides/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-red palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Maps and Location
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/peruzal" title="@peruzal on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://guides.peruzal.com/ios-guides/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://guides.peruzal.com/ios-guides/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Xamarin iOS Guides <span class="version">1.0.0</span></strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="iOS with Swift and Objective-C" href="http://guides.peruzal.com/ios-guides/">
	
	iOS with Swift and Objective-C
</a>



  
</li>



<li>
  
    



<a  title="Getting Started" href="http://guides.peruzal.com/ios-guides/getting-started/">
	
	Getting Started
</a>



  
</li>



<li>
  
    



<a  title="Setting up a Project" href="http://guides.peruzal.com/ios-guides/setup/">
	
	Setting up a Project
</a>



  
</li>



<li>
  
    



<a  title="Swift Fundamentals" href="http://guides.peruzal.com/ios-guides/swift/">
	
	Swift Fundamentals
</a>



  
</li>



<li>
  
    



<a  title="Swift Objective-C Interoperability" href="http://guides.peruzal.com/ios-guides/swift-objective-c-interoperability/">
	
	Swift Objective-C Interoperability
</a>



  
</li>



<li>
  
    



<a  title="Objective-C Fundamentals" href="http://guides.peruzal.com/ios-guides/objective-c/">
	
	Objective-C Fundamentals
</a>



  
</li>



<li>
  
    



<a  title="Common Views" href="http://guides.peruzal.com/ios-guides/common-views/">
	
	Common Views
</a>



  
</li>



<li>
  
    



<a  title="Form Input" href="http://guides.peruzal.com/ios-guides/form-input/">
	
	Form Input
</a>



  
</li>



<li>
  
    



<a  title="Model View Controller(MVC)" href="http://guides.peruzal.com/ios-guides/mvc/">
	
	Model View Controller(MVC)
</a>



  
</li>



<li>
  
    



<a  title="Auto Layout and Size Classes" href="http://guides.peruzal.com/ios-guides/auto-layout-and-size-classes/">
	
	Auto Layout and Size Classes
</a>



  
</li>



<li>
  
    



<a  title="Table View" href="http://guides.peruzal.com/ios-guides/tableview/">
	
	Table View
</a>



  
</li>



<li>
  
    



<a  title="Collection View" href="http://guides.peruzal.com/ios-guides/collection-view/">
	
	Collection View
</a>



  
</li>



<li>
  
    



<a  title="Tab Bar" href="http://guides.peruzal.com/ios-guides/tabbar-controller/">
	
	Tab Bar
</a>



  
</li>



<li>
  
    



<a  title="Scroll View" href="http://guides.peruzal.com/ios-guides/scrollview/">
	
	Scroll View
</a>



  
</li>



<li>
  
    



<a  title="Search Bar" href="http://guides.peruzal.com/ios-guides/searchbar/">
	
	Search Bar
</a>



  
</li>



<li>
  
    



<a  title="Navigation Patterns" href="http://guides.peruzal.com/ios-guides/navigation/">
	
	Navigation Patterns
</a>



  
</li>



<li>
  
    



<a  title="Passing Data between View Controllers" href="http://guides.peruzal.com/ios-guides/passing-data/">
	
	Passing Data between View Controllers
</a>



  
</li>



<li>
  
    



<a  title="Navigation Controller" href="http://guides.peruzal.com/ios-guides/navigation-controller/">
	
	Navigation Controller
</a>



  
</li>



<li>
  
    



<a  title="Location" href="http://guides.peruzal.com/ios-guides/location/">
	
	Location
</a>



  
</li>



<li>
  
    



<a class="current" title="Maps and Location" href="http://guides.peruzal.com/ios-guides/maps-and-location/">
	
	Maps and Location
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="iOS Frameworks and Device Sensors" href="http://guides.peruzal.com/ios-guides/ios-frameworks-and-device-sensors/">
	
	iOS Frameworks and Device Sensors
</a>



  
</li>



<li>
  
    



<a  title="Networking and Threading" href="http://guides.peruzal.com/ios-guides/networking-and-threading/">
	
	Networking and Threading
</a>



  
</li>



<li>
  
    



<a  title="Animations and Gestures" href="http://guides.peruzal.com/ios-guides/animations-and-gestures/">
	
	Animations and Gestures
</a>



  
</li>



<li>
  
    



<a  title="Persistence" href="http://guides.peruzal.com/ios-guides/persistence/">
	
	Persistence
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/peruzal" target="_blank" title="@peruzal on GitHub">
              @peruzal on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="mailto:info@peruzal.com" title="Email of info@peruzal.com">
              Contact via email
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Maps and Location </h1>

			

<h2 id="overview">Overview</h2>

<p>This guide is an introduction to using MapKit to set up a map view, plot locations, and draw overlays on it in your app.</p>

<h2 id="map-view-set-up">Map View Set Up</h2>

<p>Drag a Map Kit View from the Object Library onto your storyboard:
<img src="http://i.imgur.com/8CAY8rt.gif" alt="Place Map Kit View" /></p>

<p>Add MapKit framework to your view controller:</p>

<pre><code class="language-swift">import MapKit
</code></pre>

<p>Create an outlet:<br />
Control-drag the map view in the storyboard inside your view controller definition.
Release and name the outlet: mapView
<img src="http://i.imgur.com/0zspz18.gif" alt="Create Map Kit View outlet" /></p>

<p>You should now see a map when you build and run your project!</p>

<h2 id="set-up-initial-properties">Set Up Initial Properties</h2>

<p>You probably want to see a particular area of the world in your app rather than the entire world. So let’s set up so initial properties of the map.</p>

<p>For example, let’s center the map in San Francisco (37.7833, -122.4167).
There are two things you need to center the map at a location:
1. The coordinates<br />
2. A region to display to get the correct zoom level of the map. Create a MKCoordinateSpan that defines the area spanned by the region you want to display. One degree of latitude is approximately 111 km or 69 miles.</p>

<pre><code class="language-swift">override func viewDidLoad() {
    super.viewDidLoad()

    // set the region to display, this also sets a correct zoom level
    // set starting center location in San Francisco
    let centerLocation = CLLocation(latitude: 37.7833, longitude: -122.4167)
    goToLocation(centerLocation)
}

func goToLocation(location: CLLocation) {
    let span = MKCoordinateSpanMake(0.1, 0.1)
    let region = MKCoordinateRegionMake(location.coordinate, span)
    mapView.setRegion(region, animated: false)
}
</code></pre>

<p>Build and run your app again. You should see your map centered in San Francisco (or your desired location).</p>

<p>MKMapView already supports standard interactions like scrolling to a different part of the map and adjusting the zoom level. These interactions are enabled by default, but you can disable them by accessing the properties in the map view: zoomEnabled, scrollEnabled, pitchEnabled, rotateEnabled</p>

<h2 id="display-and-navigate-to-user-s-location">Display and Navigate to User&rsquo;s location</h2>

<p>You can also center the map at the user&rsquo;s current location.
First, request permission to use the user&rsquo;s location:</p>

<p><img src="http://i.imgur.com/Vgq2ecI.png" alt="Request permission" /></p>

<p>Import CoreLocation framework</p>

<pre><code class="language-swift">import CoreLocation
</code></pre>

<p>Add a locationManager:</p>

<pre><code class="language-swift">class MapViewController: UIViewController, CLLocationManagerDelegate {
  @IBOutlet weak var mapView: MKMapView!
  var locationManager : CLLocationManager!

  override func viewDidLoad() {
    super.viewDidLoad()
    ...
    locationManager = CLLocationManager()
    locationManager.delegate = self
    locationManager.desiredAccuracy = kCLLocationAccuracyNearestTenMeters
    locationManager.distanceFilter = 200
    locationManager.requestWhenInUseAuthorization()
  }
}
</code></pre>

<p>Edit the Info.plist to tell users why we&rsquo;re requesting their location:<br />
Click on Info.plist and add a new row with key: NSLocationWhenInUseUsageDescription and value: To show your location on the map
<img src="http://i.imgur.com/2hz5Mok.png" alt="Info.plist" /></p>

<p>To show the user&rsquo;s location on the map:
Click on your map view and then check Shows User Location in the Attributes Inspector<br />
<img src="http://i.imgur.com/CAChYxf.png" alt="Show User Location" /></p>

<p>Go to the user&rsquo;s location when permission has been given:</p>

<pre><code class="language-swift">func locationManager(_ manager: CLLocationManager, didChangeAuthorization status: CLAuthorizationStatus) {
    if status == CLAuthorizationStatus.authorizedWhenInUse {
        locationManager.startUpdatingLocation()
    }
}

func locationManager(_ manager: CLLocationManager, didUpdateLocations locations: [CLLocation]) {
    if let location = locations.first {
        let span = MKCoordinateSpanMake(0.1, 0.1)
        let region = MKCoordinateRegionMake(location.coordinate, span)
        mapView.setRegion(region, animated: false)
    }
}
</code></pre>

<h3 id="set-current-location-in-iphone-simulator">Set current location in iPhone simulator</h3>

<p>In the simulator, select Debug &gt; Location</p>

<p><img src="http://i.imgur.com/ktDU1oI.png" alt="Apple" /><br />
<em>Location with Apple selected</em></p>

<h2 id="add-map-annotations">Add Map Annotations</h2>

<p>MKAnnotation is used for annotations in a map. It contains the coordinate of the annotation only. A MKAnnotationView is used to display an annotation.
We&rsquo;ll go over different ways to display an annotation:</p>

<h3 id="mkpointannotation">MKPointAnnotation</h3>

<p>MKPointAnnotation is a simple annotation and supports a title.</p>

<p><img src="http://i.imgur.com/7tskBjZ.png" alt="MKPointAnnotation" /></p>

<pre><code class="language-swift">// add an Annotation with a coordinate: CLLocationCoordinate2D
func addAnnotationAtCoordinate(coordinate: CLLocationCoordinate2D) {
    let annotation = MKPointAnnotation()
    annotation.coordinate = coordinate
    annotation.title = &quot;An annotation!&quot;
    mapView.addAnnotation(annotation)
}

// add an annotation with an address: String
func addAnnotationAtAddress(address: String, title: String) {
    let geocoder = CLGeocoder()
    geocoder.geocodeAddressString(address) { (placemarks, error) in
        if let placemarks = placemarks {
            if placemarks.count != 0 {
                let coordinate = placemarks.first!.location!
                let annotation = MKPointAnnotation()
                annotation.coordinate = coordinate.coordinate
                annotation.title = title
                self.mapView.addAnnotation(annotation)
            }
        }
    }
}
</code></pre>

<h3 id="mkannotationview">MKAnnotationView</h3>

<p>MKAnnotationView is used to create an annotation with a custom image.
We&rsquo;ll need MKMapViewDelegate</p>

<pre><code class="language-swift">class MapViewController: UIViewController, MKMapViewDelegate {
  ...
}
</code></pre>

<p>Also implement the following in the view controller:</p>

<pre><code class="language-swift">func mapView(mapView: MKMapView, viewForAnnotation annotation: MKAnnotation) -&gt; MKAnnotationView? {
    let identifier = &quot;customAnnotationView&quot;

    // custom image annotation
    var annotationView = mapView.dequeueReusableAnnotationViewWithIdentifier(identifier)
    if (annotationView == nil) {
        annotationView = MKAnnotationView(annotation: annotation, reuseIdentifier: identifier)
    }
    else {
        annotationView!.annotation = annotation
    }
    annotationView!.image = UIImage(named: &quot;customAnnotationImage&quot;)

    return annotationView
}
</code></pre>

<p><img src="http://i.imgur.com/J4MJYFm.png" alt="MKAnnotationView" /></p>

<h3 id="mkpinannotationview">MKPinAnnotationView</h3>

<p>MKPinAnnotationView is a subclass of MKAnnotationView. It uses the pin graphic as the annotation image, and you can set the pin color and drop animation.</p>

<pre><code class="language-swift">func mapView(mapView: MKMapView, viewForAnnotation annotation: MKAnnotation) -&gt; MKAnnotationView? {
    let identifier = &quot;customAnnotationView&quot;
    // custom pin annotation
    var annotationView = mapView.dequeueReusableAnnotationViewWithIdentifier(identifier) as? MKPinAnnotationView
    if (annotationView == nil) {
        annotationView = MKPinAnnotationView(annotation: annotation, reuseIdentifier: identifier)
    }
    else {
        annotationView!.annotation = annotation
    }
    annotationView!.pinTintColor = UIColor.greenColor()

    return annotationView
}
</code></pre>

<p><img src="http://i.imgur.com/CAaXABK.png" alt="MKPinAnnotationView" /></p>

<h2 id="draw-map-overlays">Draw Map Overlays</h2>

<p>Here&rsquo;s an example of a circular overlay centered at a coordinate.</p>

<pre><code class="language-swift">override func viewDidLoad() {
    super.viewDidLoad()
    ...
    mapView.delegate = self
    // draw circular overlay centered in San Francisco
    let coordinate = CLLocationCoordinate2D(latitude: 37.7833, longitude: -122.4167)
    let circleOverlay: MKCircle = MKCircle(centerCoordinate: coordinate, radius: 1000)
    mapView.addOverlay(circleOverlay)
}
</code></pre>

<p>Implement the following in the view controller:</p>

<pre><code class="language-swift">func mapView(mapView: MKMapView, rendererForOverlay overlay: MKOverlay) -&gt; MKOverlayRenderer {
    let circleView = MKCircleRenderer(overlay: overlay)
    circleView.strokeColor = UIColor.redColor()
    circleView.lineWidth = 1
    return circleView
}
</code></pre>

<p><img src="http://i.imgur.com/lZUFlbz.png" alt="Map Overlay" /></p>

<h2 id="alternative-options">Alternative Options</h2>

<p>In addition to MapKit, you can integrate other map SDKs in your app.
One reason to use alternate maps is for cross platform consistency.</p>

<h3 id="google-maps">Google Maps</h3>

<ul>
<li><a href="https://developers.google.com/maps/documentation/ios-sdk/?hl=en">Google Maps SDK for iOS</a></li>
<li>The Google Places SDK is also packaged in Google Maps SDK, useful for autocomplete searching.</li>
</ul>

<h3 id="mapbox">Mapbox</h3>

<ul>
<li><a href="https://www.mapbox.com/mapbox-ios-sdk-legacy/">Mapbox iOS SDK</a></li>
<li>Mapbox is a set of open source tools used to create custom maps.</li>
</ul>

<h3 id="openstreetmap">OpenStreetMap</h3>

<ul>
<li><a href="http://wiki.openstreetmap.org/wiki/API">OpenStreetMap API</a></li>
<li>OpenStreetMap is a project that creates and distributes data of the world.</li>
<li>OpenStreetMap API allows reading and editing raw data, and does not provide a way to embed a map (like in MapKit or Google Maps).</li>
<li>OpenStreetMap has a lot of <a href="http://wiki.openstreetmap.org/wiki/Map_Features">map features</a> like buildings, highways, shops&hellip;</li>
</ul>

<h2 id="references">References</h2>

<ul>
<li><a href="https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/LocationAwarenessPG/Introduction/Introduction.html">Apple&rsquo;s Location and Maps Programming Guide</a></li>
<li><a href="https://developer.apple.com/library/mac/documentation/MapKit/Reference/MapKit_Framework_Reference/index.html">Apple&rsquo;s MapKit Framework Reference</a></li>
</ul>


			<aside class="copyright" role="note">
				
				&copy; 2016 Peruzal &ndash;
				
				Xamarin iOS Guides by 
				<a href="https://www.peruzal.com" target="_blank">Peruzal</a>
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://guides.peruzal.com/ios-guides/ios-frameworks-and-device-sensors/" title="iOS Frameworks and Device Sensors">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              iOS Frameworks and Device Sensors
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://guides.peruzal.com/ios-guides/navigation/" title="Navigation Patterns">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Navigation Patterns
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="http://guides.peruzal.com/ios-guides/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;
            
            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }
        

        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//gohugo.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/languages/cs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/languages/bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/languages/json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/languages/swift.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/languages/xml.min.js"></script>    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/languages/objectivec.min.js"></script>
  </body>
</html>
