



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Networking">
      
      
        <link rel="canonical" href="https://guides.peruzal.com/xamarin-forms-guide/networking/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Networking - Android Mobile App Development Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="#ffa000">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="amber" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#sending-and-managing-network-requests" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://guides.peruzal.com/xamarin-forms-guide" title="Android Mobile App Development Guide" class="md-header-nav__button md-logo">
          
            <img src="../images/logo-lines.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Android Mobile App Development Guide
            </span>
            <span class="md-header-nav__topic">
              
                Networking
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/Peruzal/xamarin-forms-guide/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Github
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://guides.peruzal.com/xamarin-forms-guide" title="Android Mobile App Development Guide" class="md-nav__button md-logo">
      
        <img src="../images/logo-lines.png" width="48" height="48">
      
    </a>
    Android Mobile App Development Guide
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/Peruzal/xamarin-forms-guide/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../project-structure/" title="Android Project Structure" class="md-nav__link">
      Android Project Structure
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../android-resources/" title="Understanding App Resources" class="md-nav__link">
      Understanding App Resources
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Android Common View
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Android Common View
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/view-attributes/" title="View Attributes" class="md-nav__link">
      View Attributes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/textview/" title="TextView" class="md-nav__link">
      TextView
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/button/" title="Button" class="md-nav__link">
      Button
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/edittext/" title="EditText" class="md-nav__link">
      EditText
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/image-view/" title="ImageView" class="md-nav__link">
      ImageView
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/image-button/" title="ImageButton" class="md-nav__link">
      ImageButton
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/radio-button/" title="RadioButton" class="md-nav__link">
      RadioButton
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/view/" title="View" class="md-nav__link">
      View
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/spinner/" title="Spinner" class="md-nav__link">
      Spinner
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/checkbox/" title="CheckBox" class="md-nav__link">
      CheckBox
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/switch/" title="Switch" class="md-nav__link">
      Switch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/seek-bar/" title="SeekBar" class="md-nav__link">
      SeekBar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/rating-bar/" title="RatingBar" class="md-nav__link">
      RatingBar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/progress-bar/" title="ProgressBar" class="md-nav__link">
      ProgressBar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android-common-views/search-view/" title="SearchView" class="md-nav__link">
      SearchView
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Layouts
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Layouts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../layouts/overview/" title="Layouts Overview" class="md-nav__link">
      Layouts Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../layouts/linear-layout/" title="Linear Layout" class="md-nav__link">
      Linear Layout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../layouts/relative-layout/" title="Relative Layout" class="md-nav__link">
      Relative Layout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../layouts/frame-layout/" title="Frame Layout" class="md-nav__link">
      Frame Layout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../layouts/layout-prformance/" title="Optimizing Layout Performance" class="md-nav__link">
      Optimizing Layout Performance
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../activities/" title="Activities" class="md-nav__link">
      Activities
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Navigation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Navigation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../navigation/common-navigation-patterns/" title="Common Navigation Patterns" class="md-nav__link">
      Common Navigation Patterns
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../navigation/intents/" title="Navigation with Intents" class="md-nav__link">
      Navigation with Intents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../navigation/swipe-tabbed-navigation/" title="Swipe and Tabbed Navigation" class="md-nav__link">
      Swipe and Tabbed Navigation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../navigation/navigation-drawer/" title="Navigation Drawer" class="md-nav__link">
      Navigation Drawer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../navigation/bottom-navigation/" title="Bottom Navigation" class="md-nav__link">
      Bottom Navigation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../navigation/task-stacks/" title="Navigation and Task Stacks" class="md-nav__link">
      Navigation and Task Stacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../navigation/common-intents/" title="Common Intents" class="md-nav__link">
      Common Intents
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../fragments/" title="Fragments" class="md-nav__link">
      Fragments
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../common-intents/" title="Common Intents" class="md-nav__link">
      Common Intents
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../android-permissions/" title="Understanding Android Permissions" class="md-nav__link">
      Understanding Android Permissions
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Networking
      </label>
    
    <a href="./" title="Networking" class="md-nav__link md-nav__link--active">
      Networking
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sending-and-managing-network-requests" title="Sending and Managing Network Requests" class="md-nav__link">
    Sending and Managing Network Requests
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#permissions" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-an-http-request-third-party" title="Sending an HTTP Request (Third Party)" class="md-nav__link">
    Sending an HTTP Request (Third Party)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-an-http-request-the-hard-way" title="Sending an HTTP Request (The "Hard" Way)" class="md-nav__link">
    Sending an HTTP Request (The "Hard" Way)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displaying-remote-images-the-easy-way" title="Displaying Remote Images (The "Easy" Way)" class="md-nav__link">
    Displaying Remote Images (The "Easy" Way)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displaying-remote-images-the-hard-way" title="Displaying Remote Images (The "Hard" Way)" class="md-nav__link">
    Displaying Remote Images (The "Hard" Way)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-for-network-connectivity" title="Checking for Network Connectivity" class="md-nav__link">
    Checking for Network Connectivity
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-network-is-connected" title="Checking Network is Connected" class="md-nav__link">
    Checking Network is Connected
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-the-internet-is-connected" title="Checking the Internet is Connected" class="md-nav__link">
    Checking the Internet is Connected
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#networking-with-the-volley-library" title="Networking with the Volley Library" class="md-nav__link">
    Networking with the Volley Library
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-volley" title="Why Volley?" class="md-nav__link">
    Why Volley?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-volley" title="Setup Volley" class="md-nav__link">
    Setup Volley
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-volley" title="How to use Volley?" class="md-nav__link">
    How to use Volley?
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constructing-a-requestqueue" title="Constructing a RequestQueue" class="md-nav__link">
    Constructing a RequestQueue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-singleton-queue" title="Creating a Singleton Queue" class="md-nav__link">
    Creating a Singleton Queue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requesting-images" title="Requesting images" class="md-nav__link">
    Requesting images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-json-data" title="Accessing JSON Data" class="md-nav__link">
    Accessing JSON Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canceling-requests" title="Canceling Requests" class="md-nav__link">
    Canceling Requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-with-okhttp" title="Using with OkHttp" class="md-nav__link">
    Using with OkHttp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting" title="Troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-and-executing-async-tasks" title="Creating and Executing Async Tasks" class="md-nav__link">
    Creating and Executing Async Tasks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-an-asynctask" title="Defining an AsyncTask" class="md-nav__link">
    Defining an AsyncTask
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-the-asynctask" title="Executing the AsyncTask" class="md-nav__link">
    Executing the AsyncTask
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-the-asynctask" title="Understanding the AsyncTask" class="md-nav__link">
    Understanding the AsyncTask
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations" title="Limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-thread-management" title="Custom Thread Management" class="md-nav__link">
    Custom Thread Management
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#displaying-images-with-the-picasso-library" title="Displaying Images with the Picasso Library" class="md-nav__link">
    Displaying Images with the Picasso Library
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup-picasso" title="Setup Picasso" class="md-nav__link">
    Setup Picasso
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-an-image-from-url" title="Loading an Image from Url" class="md-nav__link">
    Loading an Image from Url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-picasso" title="Configuring Picasso" class="md-nav__link">
    Configuring Picasso
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resizing-with-picasso" title="Resizing with Picasso" class="md-nav__link">
    Resizing with Picasso
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting_1" title="Troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outofmemoryerror-loading-errors" title="OutOfMemoryError Loading Errors" class="md-nav__link">
    OutOfMemoryError Loading Errors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-errors" title="Loading Errors" class="md-nav__link">
    Loading Errors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usages" title="Advanced Usages" class="md-nav__link">
    Advanced Usages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#showing-progressbar-with-picasso" title="Showing ProgressBar with Picasso" class="md-nav__link">
    Showing ProgressBar with Picasso
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjusting-image-size-dynamically" title="Adjusting Image Size Dynamically" class="md-nav__link">
    Adjusting Image Size Dynamically
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-staggered-grid-images-with-recyclerview" title="Creating Staggered Grid Images with RecyclerView" class="md-nav__link">
    Creating Staggered Grid Images with RecyclerView
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-transformations" title="Other Transformations" class="md-nav__link">
    Other Transformations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#converting-json-to-models" title="Converting JSON to Models" class="md-nav__link">
    Converting JSON to Models
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fetching-json-results" title="Fetching JSON Results" class="md-nav__link">
    Fetching JSON Results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-our-model" title="Setting up our Model" class="md-nav__link">
    Setting up our Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#putting-it-all-together" title="Putting It All Together" class="md-nav__link">
    Putting It All Together
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bonus-setting-up-your-adapter" title="Bonus: Setting Up Your Adapter" class="md-nav__link">
    Bonus: Setting Up Your Adapter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leveraging-the-gson-librarys" title="Leveraging the Gson Librarys" class="md-nav__link">
    Leveraging the Gson Librarys
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup" title="Setup" class="md-nav__link">
    Setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto-generating-model-classes" title="Auto-generating Model Classes" class="md-nav__link">
    Auto-generating Model Classes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-models-manually" title="Generating Models Manually" class="md-nav__link">
    Generating Models Manually
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initializing-collections" title="Initializing collections" class="md-nav__link">
    Initializing collections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parsing-the-response" title="Parsing the response" class="md-nav__link">
    Parsing the response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-options" title="Custom options" class="md-nav__link">
    Custom options
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matching-variable-names-to-json-keys" title="Matching variable names to JSON keys" class="md-nav__link">
    Matching variable names to JSON keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-enums" title="Mapping Enums" class="md-nav__link">
    Mapping Enums
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-camel-case-field-names" title="Mapping camel case field names" class="md-nav__link">
    Mapping camel case field names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-java-date-objects" title="Mapping Java Date objects" class="md-nav__link">
    Mapping Java Date objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-custom-java-types" title="Mapping custom Java types" class="md-nav__link">
    Mapping custom Java types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-multiple-date-formats" title="Mapping multiple Date formats" class="md-nav__link">
    Mapping multiple Date formats
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decoding-collections-of-items" title="Decoding collections of items" class="md-nav__link">
    Decoding collections of items
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-client-libraries" title="HTTP Client Libraries" class="md-nav__link">
    HTTP Client Libraries
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#android-async-http-client" title="Android Async HTTP Client" class="md-nav__link">
    Android Async HTTP Client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrofit-2" title="Retrofit 2" class="md-nav__link">
    Retrofit 2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#displaying-images-with-the-fresco-library" title="Displaying Images with the Fresco Library" class="md-nav__link">
    Displaying Images with the Fresco Library
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terms" title="Terms" class="md-nav__link">
    Terms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" title="Getting Started" class="md-nav__link">
    Getting Started
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customization" title="Customization" class="md-nav__link">
    Customization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-the-underlying-bitmap-out-of-a-draweeview" title="Getting the underlying Bitmap out of a DraweeView" class="md-nav__link">
    Getting the underlying Bitmap out of a DraweeView
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sharing-an-image-from-fresco" title="Sharing an Image from Fresco" class="md-nav__link">
    Sharing an Image from Fresco
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gotchas" title="Gotchas" class="md-nav__link">
    Gotchas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-a-parse-server" title="Configuring a Parse Server" class="md-nav__link">
    Configuring a Parse Server
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#differences-with-open-source-parse" title="Differences with Open Source Parse" class="md-nav__link">
    Differences with Open Source Parse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-a-new-parse-server" title="Setting a new Parse Server" class="md-nav__link">
    Setting a new Parse Server
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signing-up-with-heroku" title="Signing up with Heroku" class="md-nav__link">
    Signing up with Heroku
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-deployment" title="Testing Deployment" class="md-nav__link">
    Testing Deployment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#browsing-parse-data" title="Browsing Parse Data" class="md-nav__link">
    Browsing Parse Data
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlab" title="mLab" class="md-nav__link">
    mLab
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse-dashboard" title="Parse Dashboard" class="md-nav__link">
    Parse Dashboard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#robomongo" title="Robomongo" class="md-nav__link">
    Robomongo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-support-for-live-queries" title="Adding Support for Live Queries" class="md-nav__link">
    Adding Support for Live Queries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-client-sdk-integration" title="Enabling Client SDK integration" class="md-nav__link">
    Enabling Client SDK integration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-parse-server" title="Troubleshooting Parse Server" class="md-nav__link">
    Troubleshooting Parse Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-push-notifications" title="Enabling Push Notifications" class="md-nav__link">
    Enabling Push Notifications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storing-files-with-parse" title="Storing Files with Parse" class="md-nav__link">
    Storing Files with Parse
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-amazon-s3" title="Using Amazon S3" class="md-nav__link">
    Using Amazon S3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-data-driven-apps-with-parse" title="Building Data driven Apps with Parse" class="md-nav__link">
    Building Data driven Apps with Parse
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parse-on-heroku" title="Parse on Heroku" class="md-nav__link">
    Parse on Heroku
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternatives-to-parse" title="Alternatives to Parse" class="md-nav__link">
    Alternatives to Parse
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-parse" title="What is Parse?" class="md-nav__link">
    What is Parse?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup_1" title="Setup" class="md-nav__link">
    Setup
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing-parse-client" title="Testing Parse Client" class="md-nav__link">
    Testing Parse Client
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-users" title="Working with Users" class="md-nav__link">
    Working with Users
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-signup" title="User Signup" class="md-nav__link">
    User Signup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-session-login" title="User Session Login" class="md-nav__link">
    User Session Login
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-users" title="Querying Users" class="md-nav__link">
    Querying Users
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-data-objects" title="Working With Data Objects" class="md-nav__link">
    Working With Data Objects
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-parse-models" title="Creating Parse Models" class="md-nav__link">
    Creating Parse Models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-or-updating-objects" title="Saving or Updating Objects" class="md-nav__link">
    Saving or Updating Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-objects" title="Querying Objects" class="md-nav__link">
    Querying Objects
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objects-by-id" title="Objects By Id" class="md-nav__link">
    Objects By Id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects-by-query-conditions" title="Objects By Query Conditions" class="md-nav__link">
    Objects By Query Conditions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects-by-querying-geolocation" title="Objects by Querying GeoLocation" class="md-nav__link">
    Objects by Querying GeoLocation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#live-queries" title="Live Queries" class="md-nav__link">
    Live Queries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passing-objects-between-activities" title="Passing Objects Between Activities" class="md-nav__link">
    Passing Objects Between Activities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#associations" title="Associations" class="md-nav__link">
    Associations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#one-to-one-relationships" title="One-to-One Relationships" class="md-nav__link">
    One-to-One Relationships
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#many-to-many-relationships" title="Many-to-Many Relationships" class="md-nav__link">
    Many-to-Many Relationships
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleting-objects" title="Deleting Objects" class="md-nav__link">
    Deleting Objects
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#local-storage-mode" title="Local Storage Mode" class="md-nav__link">
    Local Storage Mode
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#saving-to-local-store" title="Saving To Local Store" class="md-nav__link">
    Saving To Local Store
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-from-local-store" title="Querying from Local Store" class="md-nav__link">
    Querying from Local Store
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-details" title="Further Details" class="md-nav__link">
    Further Details
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-data-browser" title="Using the Data Browser" class="md-nav__link">
    Using the Data Browser
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting_2" title="Troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-features" title="Additional Features" class="md-nav__link">
    Additional Features
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uploading-photos" title="Uploading Photos" class="md-nav__link">
    Uploading Photos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geo-location" title="Geo Location" class="md-nav__link">
    Geo Location
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#push-notifications" title="Push Notifications" class="md-nav__link">
    Push Notifications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#facebook-sdk" title="Facebook SDK" class="md-nav__link">
    Facebook SDK
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-button" title="Custom button" class="md-nav__link">
    Custom button
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-code" title="Server Code" class="md-nav__link">
    Server Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-data-driven-apps-with-firebase" title="Building Data driven Apps with Firebase" class="md-nav__link">
    Building Data driven Apps with Firebase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registration" title="Registration" class="md-nav__link">
    Registration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup_2" title="Setup" class="md-nav__link">
    Setup
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-firebase-to-your-app" title="Add Firebase to your app" class="md-nav__link">
    Add Firebase to your app
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-create-project" title="1. Create project" class="md-nav__link">
    1. Create project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-firebase-to-your-app" title="2. Add Firebase to your app" class="md-nav__link">
    2. Add Firebase to your app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configure-your-app" title="3. Configure your app" class="md-nav__link">
    3. Configure your app
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attribution" title="Attribution" class="md-nav__link">
    Attribution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references-and-further-reading" title="References and further reading" class="md-nav__link">
    References and further reading
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handling-progressbars" title="Handling ProgressBars" class="md-nav__link">
    Handling ProgressBars
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#indeterminate" title="Indeterminate" class="md-nav__link">
    Indeterminate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-based" title="Result-based" class="md-nav__link">
    Result-based
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#progress-within-actionbar" title="Progress within ActionBar" class="md-nav__link">
    Progress within ActionBar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#progress-within-listview-footer" title="Progress Within ListView Footer" class="md-nav__link">
    Progress Within ListView Footer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#progress-within-dialog" title="Progress within Dialog" class="md-nav__link">
    Progress within Dialog
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#third-party-libraries" title="Third-party Libraries" class="md-nav__link">
    Third-party Libraries
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sending-and-managing-network-requests" title="Sending and Managing Network Requests" class="md-nav__link">
    Sending and Managing Network Requests
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#permissions" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-an-http-request-third-party" title="Sending an HTTP Request (Third Party)" class="md-nav__link">
    Sending an HTTP Request (Third Party)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-an-http-request-the-hard-way" title="Sending an HTTP Request (The "Hard" Way)" class="md-nav__link">
    Sending an HTTP Request (The "Hard" Way)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displaying-remote-images-the-easy-way" title="Displaying Remote Images (The "Easy" Way)" class="md-nav__link">
    Displaying Remote Images (The "Easy" Way)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displaying-remote-images-the-hard-way" title="Displaying Remote Images (The "Hard" Way)" class="md-nav__link">
    Displaying Remote Images (The "Hard" Way)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-for-network-connectivity" title="Checking for Network Connectivity" class="md-nav__link">
    Checking for Network Connectivity
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-network-is-connected" title="Checking Network is Connected" class="md-nav__link">
    Checking Network is Connected
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-the-internet-is-connected" title="Checking the Internet is Connected" class="md-nav__link">
    Checking the Internet is Connected
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#networking-with-the-volley-library" title="Networking with the Volley Library" class="md-nav__link">
    Networking with the Volley Library
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-volley" title="Why Volley?" class="md-nav__link">
    Why Volley?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-volley" title="Setup Volley" class="md-nav__link">
    Setup Volley
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-volley" title="How to use Volley?" class="md-nav__link">
    How to use Volley?
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constructing-a-requestqueue" title="Constructing a RequestQueue" class="md-nav__link">
    Constructing a RequestQueue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-singleton-queue" title="Creating a Singleton Queue" class="md-nav__link">
    Creating a Singleton Queue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requesting-images" title="Requesting images" class="md-nav__link">
    Requesting images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-json-data" title="Accessing JSON Data" class="md-nav__link">
    Accessing JSON Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#canceling-requests" title="Canceling Requests" class="md-nav__link">
    Canceling Requests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-with-okhttp" title="Using with OkHttp" class="md-nav__link">
    Using with OkHttp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting" title="Troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-and-executing-async-tasks" title="Creating and Executing Async Tasks" class="md-nav__link">
    Creating and Executing Async Tasks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-an-asynctask" title="Defining an AsyncTask" class="md-nav__link">
    Defining an AsyncTask
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-the-asynctask" title="Executing the AsyncTask" class="md-nav__link">
    Executing the AsyncTask
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-the-asynctask" title="Understanding the AsyncTask" class="md-nav__link">
    Understanding the AsyncTask
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations" title="Limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-thread-management" title="Custom Thread Management" class="md-nav__link">
    Custom Thread Management
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#displaying-images-with-the-picasso-library" title="Displaying Images with the Picasso Library" class="md-nav__link">
    Displaying Images with the Picasso Library
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup-picasso" title="Setup Picasso" class="md-nav__link">
    Setup Picasso
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-an-image-from-url" title="Loading an Image from Url" class="md-nav__link">
    Loading an Image from Url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-picasso" title="Configuring Picasso" class="md-nav__link">
    Configuring Picasso
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resizing-with-picasso" title="Resizing with Picasso" class="md-nav__link">
    Resizing with Picasso
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting_1" title="Troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outofmemoryerror-loading-errors" title="OutOfMemoryError Loading Errors" class="md-nav__link">
    OutOfMemoryError Loading Errors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-errors" title="Loading Errors" class="md-nav__link">
    Loading Errors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usages" title="Advanced Usages" class="md-nav__link">
    Advanced Usages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#showing-progressbar-with-picasso" title="Showing ProgressBar with Picasso" class="md-nav__link">
    Showing ProgressBar with Picasso
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjusting-image-size-dynamically" title="Adjusting Image Size Dynamically" class="md-nav__link">
    Adjusting Image Size Dynamically
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-staggered-grid-images-with-recyclerview" title="Creating Staggered Grid Images with RecyclerView" class="md-nav__link">
    Creating Staggered Grid Images with RecyclerView
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-transformations" title="Other Transformations" class="md-nav__link">
    Other Transformations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#converting-json-to-models" title="Converting JSON to Models" class="md-nav__link">
    Converting JSON to Models
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fetching-json-results" title="Fetching JSON Results" class="md-nav__link">
    Fetching JSON Results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-our-model" title="Setting up our Model" class="md-nav__link">
    Setting up our Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#putting-it-all-together" title="Putting It All Together" class="md-nav__link">
    Putting It All Together
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bonus-setting-up-your-adapter" title="Bonus: Setting Up Your Adapter" class="md-nav__link">
    Bonus: Setting Up Your Adapter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leveraging-the-gson-librarys" title="Leveraging the Gson Librarys" class="md-nav__link">
    Leveraging the Gson Librarys
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup" title="Setup" class="md-nav__link">
    Setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto-generating-model-classes" title="Auto-generating Model Classes" class="md-nav__link">
    Auto-generating Model Classes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-models-manually" title="Generating Models Manually" class="md-nav__link">
    Generating Models Manually
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initializing-collections" title="Initializing collections" class="md-nav__link">
    Initializing collections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parsing-the-response" title="Parsing the response" class="md-nav__link">
    Parsing the response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-options" title="Custom options" class="md-nav__link">
    Custom options
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matching-variable-names-to-json-keys" title="Matching variable names to JSON keys" class="md-nav__link">
    Matching variable names to JSON keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-enums" title="Mapping Enums" class="md-nav__link">
    Mapping Enums
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-camel-case-field-names" title="Mapping camel case field names" class="md-nav__link">
    Mapping camel case field names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-java-date-objects" title="Mapping Java Date objects" class="md-nav__link">
    Mapping Java Date objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-custom-java-types" title="Mapping custom Java types" class="md-nav__link">
    Mapping custom Java types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-multiple-date-formats" title="Mapping multiple Date formats" class="md-nav__link">
    Mapping multiple Date formats
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decoding-collections-of-items" title="Decoding collections of items" class="md-nav__link">
    Decoding collections of items
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-client-libraries" title="HTTP Client Libraries" class="md-nav__link">
    HTTP Client Libraries
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#android-async-http-client" title="Android Async HTTP Client" class="md-nav__link">
    Android Async HTTP Client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrofit-2" title="Retrofit 2" class="md-nav__link">
    Retrofit 2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#displaying-images-with-the-fresco-library" title="Displaying Images with the Fresco Library" class="md-nav__link">
    Displaying Images with the Fresco Library
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terms" title="Terms" class="md-nav__link">
    Terms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" title="Getting Started" class="md-nav__link">
    Getting Started
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customization" title="Customization" class="md-nav__link">
    Customization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-the-underlying-bitmap-out-of-a-draweeview" title="Getting the underlying Bitmap out of a DraweeView" class="md-nav__link">
    Getting the underlying Bitmap out of a DraweeView
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sharing-an-image-from-fresco" title="Sharing an Image from Fresco" class="md-nav__link">
    Sharing an Image from Fresco
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gotchas" title="Gotchas" class="md-nav__link">
    Gotchas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-a-parse-server" title="Configuring a Parse Server" class="md-nav__link">
    Configuring a Parse Server
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#differences-with-open-source-parse" title="Differences with Open Source Parse" class="md-nav__link">
    Differences with Open Source Parse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-a-new-parse-server" title="Setting a new Parse Server" class="md-nav__link">
    Setting a new Parse Server
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signing-up-with-heroku" title="Signing up with Heroku" class="md-nav__link">
    Signing up with Heroku
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-deployment" title="Testing Deployment" class="md-nav__link">
    Testing Deployment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#browsing-parse-data" title="Browsing Parse Data" class="md-nav__link">
    Browsing Parse Data
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlab" title="mLab" class="md-nav__link">
    mLab
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse-dashboard" title="Parse Dashboard" class="md-nav__link">
    Parse Dashboard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#robomongo" title="Robomongo" class="md-nav__link">
    Robomongo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-support-for-live-queries" title="Adding Support for Live Queries" class="md-nav__link">
    Adding Support for Live Queries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-client-sdk-integration" title="Enabling Client SDK integration" class="md-nav__link">
    Enabling Client SDK integration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-parse-server" title="Troubleshooting Parse Server" class="md-nav__link">
    Troubleshooting Parse Server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-push-notifications" title="Enabling Push Notifications" class="md-nav__link">
    Enabling Push Notifications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storing-files-with-parse" title="Storing Files with Parse" class="md-nav__link">
    Storing Files with Parse
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-amazon-s3" title="Using Amazon S3" class="md-nav__link">
    Using Amazon S3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-data-driven-apps-with-parse" title="Building Data driven Apps with Parse" class="md-nav__link">
    Building Data driven Apps with Parse
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parse-on-heroku" title="Parse on Heroku" class="md-nav__link">
    Parse on Heroku
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternatives-to-parse" title="Alternatives to Parse" class="md-nav__link">
    Alternatives to Parse
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-parse" title="What is Parse?" class="md-nav__link">
    What is Parse?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup_1" title="Setup" class="md-nav__link">
    Setup
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing-parse-client" title="Testing Parse Client" class="md-nav__link">
    Testing Parse Client
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-users" title="Working with Users" class="md-nav__link">
    Working with Users
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-signup" title="User Signup" class="md-nav__link">
    User Signup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-session-login" title="User Session Login" class="md-nav__link">
    User Session Login
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-users" title="Querying Users" class="md-nav__link">
    Querying Users
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-data-objects" title="Working With Data Objects" class="md-nav__link">
    Working With Data Objects
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-parse-models" title="Creating Parse Models" class="md-nav__link">
    Creating Parse Models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saving-or-updating-objects" title="Saving or Updating Objects" class="md-nav__link">
    Saving or Updating Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-objects" title="Querying Objects" class="md-nav__link">
    Querying Objects
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objects-by-id" title="Objects By Id" class="md-nav__link">
    Objects By Id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects-by-query-conditions" title="Objects By Query Conditions" class="md-nav__link">
    Objects By Query Conditions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects-by-querying-geolocation" title="Objects by Querying GeoLocation" class="md-nav__link">
    Objects by Querying GeoLocation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#live-queries" title="Live Queries" class="md-nav__link">
    Live Queries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passing-objects-between-activities" title="Passing Objects Between Activities" class="md-nav__link">
    Passing Objects Between Activities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#associations" title="Associations" class="md-nav__link">
    Associations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#one-to-one-relationships" title="One-to-One Relationships" class="md-nav__link">
    One-to-One Relationships
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#many-to-many-relationships" title="Many-to-Many Relationships" class="md-nav__link">
    Many-to-Many Relationships
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleting-objects" title="Deleting Objects" class="md-nav__link">
    Deleting Objects
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#local-storage-mode" title="Local Storage Mode" class="md-nav__link">
    Local Storage Mode
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#saving-to-local-store" title="Saving To Local Store" class="md-nav__link">
    Saving To Local Store
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-from-local-store" title="Querying from Local Store" class="md-nav__link">
    Querying from Local Store
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#further-details" title="Further Details" class="md-nav__link">
    Further Details
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-data-browser" title="Using the Data Browser" class="md-nav__link">
    Using the Data Browser
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting_2" title="Troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-features" title="Additional Features" class="md-nav__link">
    Additional Features
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uploading-photos" title="Uploading Photos" class="md-nav__link">
    Uploading Photos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geo-location" title="Geo Location" class="md-nav__link">
    Geo Location
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#push-notifications" title="Push Notifications" class="md-nav__link">
    Push Notifications
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#facebook-sdk" title="Facebook SDK" class="md-nav__link">
    Facebook SDK
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-button" title="Custom button" class="md-nav__link">
    Custom button
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-code" title="Server Code" class="md-nav__link">
    Server Code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-data-driven-apps-with-firebase" title="Building Data driven Apps with Firebase" class="md-nav__link">
    Building Data driven Apps with Firebase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registration" title="Registration" class="md-nav__link">
    Registration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup_2" title="Setup" class="md-nav__link">
    Setup
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-firebase-to-your-app" title="Add Firebase to your app" class="md-nav__link">
    Add Firebase to your app
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-create-project" title="1. Create project" class="md-nav__link">
    1. Create project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-add-firebase-to-your-app" title="2. Add Firebase to your app" class="md-nav__link">
    2. Add Firebase to your app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configure-your-app" title="3. Configure your app" class="md-nav__link">
    3. Configure your app
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attribution" title="Attribution" class="md-nav__link">
    Attribution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references-and-further-reading" title="References and further reading" class="md-nav__link">
    References and further reading
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handling-progressbars" title="Handling ProgressBars" class="md-nav__link">
    Handling ProgressBars
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#indeterminate" title="Indeterminate" class="md-nav__link">
    Indeterminate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-based" title="Result-based" class="md-nav__link">
    Result-based
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#progress-within-actionbar" title="Progress within ActionBar" class="md-nav__link">
    Progress within ActionBar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#progress-within-listview-footer" title="Progress Within ListView Footer" class="md-nav__link">
    Progress Within ListView Footer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#progress-within-dialog" title="Progress within Dialog" class="md-nav__link">
    Progress within Dialog
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#third-party-libraries" title="Third-party Libraries" class="md-nav__link">
    Third-party Libraries
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Peruzal/xamarin-forms-guide/edit/master/docs/networking.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Networking</h1>
                
                <h2 id="sending-and-managing-network-requests">Sending and Managing Network Requests<a class="headerlink" href="#sending-and-managing-network-requests" title="Permanent link">&para;</a></h2>
<p>Network requests are used to retrieve or modify API data or media from a server. This is a very common task in Android development especially for dynamic data-driven clients.</p>
<p>The underlying Java class used for network connections is <a href="http://developer.android.com/reference/org/apache/http/impl/client/DefaultHttpClient.html">DefaultHTTPClient</a> or <a href="http://developer.android.com/reference/java/net/HttpURLConnection.html">HttpUrlConnection</a>.  Both of these are lower-level and require completely manual management of parsing the data from the input stream and executing the request asynchronously.  DefaultHTTPClient, otherwise known as the Apache HTTP Client, has been 
<a href="https://developer.android.com/about/versions/marshmallow/android-6.0-changes.html#behavior-apache-http-client">deprecated</a> since Android 6.0.  The reason for two different HTTP clients is described in this <a href="http://android-developers.blogspot.com/2011/09/androids-http-clients.html">blog article</a>.  A historical perspective is also discussed in <a href="http://fragmentedpodcast.com/2016/06/">this podcast</a>.</p>
<p>For most common cases, we are better off using a popular third-party library called <a href="http://loopj.com/android-async-http/">android-async-http</a> or <a href="http://square.github.io/okhttp/">OkHttp</a> which will handle the entire process of sending and parsing network requests for us in a more robust and easy-to-use way.</p>
<h3 id="permissions">Permissions<a class="headerlink" href="#permissions" title="Permanent link">&para;</a></h3>
<p>In order to access the internet, be sure to specify the following permissions in <code>AndroidManifest.xml</code>:</p>
<div class="codehilite"><pre><span></span><span class="o">&lt;?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s">&quot;1.0&quot;</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="o">?&gt;</span>
<span class="o">&lt;</span><span class="n">manifest</span> <span class="n">xmlns</span><span class="o">:</span><span class="n">android</span><span class="o">=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="n">package</span><span class="o">=</span><span class="s">&quot;com.example.simplenetworking&quot;</span>
    <span class="n">android</span><span class="o">:</span><span class="n">versionCode</span><span class="o">=</span><span class="s">&quot;1&quot;</span>
    <span class="n">android</span><span class="o">:</span><span class="n">versionName</span><span class="o">=</span><span class="s">&quot;1.0&quot;</span> <span class="o">&gt;</span>

   <span class="o">&lt;</span><span class="n">uses</span><span class="o">-</span><span class="n">permission</span> <span class="n">android</span><span class="o">:</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;android.permission.INTERNET&quot;</span> <span class="o">/&gt;</span> 
   <span class="o">&lt;</span><span class="n">uses</span><span class="o">-</span><span class="n">permission</span> <span class="n">android</span><span class="o">:</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span> <span class="o">/&gt;</span>

<span class="o">&lt;/</span><span class="n">manifest</span><span class="o">&gt;</span>
</pre></div>


<h3 id="sending-an-http-request-third-party">Sending an HTTP Request (Third Party)<a class="headerlink" href="#sending-an-http-request-third-party" title="Permanent link">&para;</a></h3>
<p>There are at least three major third-party networking libraries you should consider using.  </p>
<ul>
<li>
<p>The <strong>Android Async Http Client</strong> for making basic network calls.  It is the library often used for learning Android but would not be used in a production application.</p>
</li>
<li>
<p><strong>OkHttp</strong> for making synchronous and asynchronous calls.  </p>
</li>
<li>
<p><strong>Volley</strong> , a library built by Google that has fallen out of favor for OkHttp.   It was one of the first networking libraries released for Android and provides a more convenient way to make networking requests than using <code>AsyncTask</code>.</p>
</li>
</ul>
<p>There can be a bit of a learning curve when using these libraries, so your best bet when first learning is to use Android Async Http Client or Volley.  With OkHttp you also have to deal with the complexity of whether your callbacks need to be run on the main thread to update the UI, as explained in the guide.</p>
<p>Here is a comparison of the different aspects of the libraries.  </p>
<table>
<thead>
<tr>
<th></th>
<th>Android Async Http</th>
<th align="center">OkHttp</th>
<th align="right">Volley</th>
</tr>
</thead>
<tbody>
<tr>
<td>Debugging</td>
<td>Requires Proxy server</td>
<td align="center">Use LogInterceptor</td>
<td align="right">Use verbose mode</td>
</tr>
<tr>
<td>Disk Caching</td>
<td>Yes</td>
<td align="center">Yes</td>
<td align="right">Yes</td>
</tr>
<tr>
<td>Request Queueing</td>
<td>No</td>
<td align="center">No</td>
<td align="right">Included</td>
</tr>
<tr>
<td>Remote Image Fetching</td>
<td>Manual</td>
<td align="center">Requires Picasso or Glide</td>
<td align="right">Included</td>
</tr>
<tr>
<td>Animated GIF Support</td>
<td>No</td>
<td align="center">Requires Glide</td>
<td align="right">Requires Glide</td>
</tr>
<tr>
<td>Release Cadence</td>
<td>Infrequent</td>
<td align="center">Monthly</td>
<td align="right">Infrequent</td>
</tr>
<tr>
<td>Transport Layer</td>
<td>Apache HTTP Client</td>
<td align="center">OkHttp</td>
<td align="right">HttpUrlConnection (or OkHttp)</td>
</tr>
<tr>
<td>Synchronous Calls</td>
<td>use SyncHttpClient</td>
<td align="center">execute() instead of enqueue()</td>
<td align="right">use RequestFuture</td>
</tr>
<tr>
<td>HTTP/2</td>
<td>No</td>
<td align="center">Yes</td>
<td align="right">Works with OkHttp</td>
</tr>
<tr>
<td>Automatic Gzip processing</td>
<td>Yes</td>
<td align="center">Yes</td>
<td align="right">No (unless using OkHttp)</td>
</tr>
<tr>
<td>Author</td>
<td>James Smith</td>
<td align="center">Square</td>
<td align="right">Google</td>
</tr>
</tbody>
</table>
<p>One issue with Android Async Http Client is that the library has very limited ways to observe network traces that are useful for debugging.   Volley provides remote fetching images out of the box, while Android Async Http client requires more manual work and OkHttp needs the <strong>Picasso</strong> or <strong>Glide</strong> library in order to do so.</p>
<p>Another important point is that OkHttp is not only a standalone networking library but also can be used for the <a href="https://android.googlesource.com/platform/external/okhttp/+/master/okhttp-urlconnection/src/main/java/com/squareup/okhttp/internal/huc/HttpURLConnectionImpl.java">underlying implementation for HttpUrlConnection</a>.  For this reason, Volley can also leverage OkHttp to support automatic Gzip and HTTP/2 processing.</p>
<h3 id="sending-an-http-request-the-hard-way">Sending an HTTP Request (The "Hard" Way)<a class="headerlink" href="#sending-an-http-request-the-hard-way" title="Permanent link">&para;</a></h3>
<p>Sending an HTTP Request involves the following conceptual steps:</p>
<ol>
<li>Declare a URL Connection</li>
<li>Open InputStream to connection</li>
<li>Download and decode based on data type</li>
<li>Wrap in AsyncTask and execute in background thread</li>
</ol>
<p>This would translate to the following networking code to send a simple request (with try-catch structured exceptions not shown here for brevity):</p>
<div class="codehilite"><pre><span></span><span class="c1">// 1. Declare a URL Connection</span>
<span class="n">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="s">&quot;http://www.google.com&quot;</span><span class="o">);</span>
<span class="n">HttpURLConnection</span> <span class="n">conn</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
<span class="c1">// 2. Open InputStream to connection</span>
<span class="n">conn</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>
<span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
<span class="c1">// 3. Download and decode the string response using builder</span>
<span class="n">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
<span class="n">BufferedReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">InputStreamReader</span><span class="o">(</span><span class="n">in</span><span class="o">));</span>
<span class="n">String</span> <span class="n">line</span><span class="o">;</span>
<span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>


<p>The fourth step requires this networking request to be executed in a background task using <code>AsyncTasks</code> such as shown below:</p>
<div class="codehilite"><pre><span></span><span class="c1">// The types specified here are the input data type, the progress type, and the result type</span>
<span class="c1">// Subclass AsyncTask to execute the network request</span>
<span class="c1">// String == URL, Void == Progress Tracking, String == Response Received</span>
<span class="kd">private</span> <span class="kd">class</span> <span class="nc">NetworkAsyncTask</span> <span class="kd">extends</span> <span class="n">AsyncTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Void</span><span class="o">,</span> <span class="n">Bitmap</span><span class="o">&gt;</span> <span class="o">{</span>
     <span class="kd">protected</span> <span class="n">String</span> <span class="nf">doInBackground</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">strings</span><span class="o">)</span> <span class="o">{</span>
         <span class="c1">// Some long-running task like downloading an image.</span>
         <span class="c1">// ... code shown above to send request and retrieve string builder</span>
         <span class="k">return</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
     <span class="o">}</span>

     <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPostExecute</span><span class="o">(</span><span class="n">String</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
         <span class="c1">// This method is executed in the UIThread</span>
         <span class="c1">// with access to the result of the long running task</span>
         <span class="c1">// DO SOMETHING WITH STRING RESPONSE</span>
     <span class="o">}</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">void</span> <span class="nf">downloadResponseFromNetwork</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// 4. Wrap in AsyncTask and execute in background thread</span>
    <span class="k">new</span> <span class="n">NetworkAsyncTask</span><span class="o">().</span><span class="na">execute</span><span class="o">(</span><span class="s">&quot;http://google.com&quot;</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>


<h3 id="displaying-remote-images-the-easy-way">Displaying Remote Images (The "Easy" Way)<a class="headerlink" href="#displaying-remote-images-the-easy-way" title="Permanent link">&para;</a></h3>
<p>Displaying images is easiest using a third party library such as <code>Picasso</code> from Square which will download and cache remote images and abstract the complexity behind an easy to use DSL:</p>
<div class="codehilite"><pre><span></span><span class="n">String</span> <span class="n">imageUri</span> <span class="o">=</span> <span class="s">&quot;https://i.imgur.com/tGbaZCY.jpg&quot;</span><span class="o">;</span>
<span class="n">ImageView</span> <span class="n">ivBasicImage</span> <span class="o">=</span> <span class="o">(</span><span class="n">ImageView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">ivBasicImage</span><span class="o">);</span>
<span class="n">Picasso</span><span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">context</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="n">imageUri</span><span class="o">).</span><span class="na">into</span><span class="o">(</span><span class="n">ivBasicImage</span><span class="o">);</span>
</pre></div>


<p>Refer to our [[Picasso Guide|Displaying-Images-with-the-Picasso-Library]] for more detailed usage information and configuration.</p>
<h3 id="displaying-remote-images-the-hard-way">Displaying Remote Images (The "Hard" Way)<a class="headerlink" href="#displaying-remote-images-the-hard-way" title="Permanent link">&para;</a></h3>
<p>Suppose we wanted to load an image using only the built-in Android network constructs. In order to download an image from the network, convert the bytes into a bitmap and then insert the bitmap into an <code>ImageView</code>, you would use the following pseudo-code:</p>
<div class="codehilite"><pre><span></span><span class="c1">// 1. Declare a URL Connection</span>
<span class="n">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="s">&quot;https://i.imgur.com/tGbaZCY.jpg&quot;</span><span class="o">);</span>
<span class="n">HttpURLConnection</span> <span class="n">conn</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
<span class="c1">// 2. Open InputStream to connection</span>
<span class="n">conn</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>
<span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
<span class="c1">// 3. Download and decode the bitmap using BitmapFactory</span>
<span class="n">Bitmap</span> <span class="n">bitmap</span> <span class="o">=</span> <span class="n">BitmapFactory</span><span class="o">.</span><span class="na">decodeStream</span><span class="o">(</span><span class="n">in</span><span class="o">);</span>
<span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="c1">// 4. Insert into an ImageView</span>
<span class="n">ImageView</span> <span class="n">imageView</span> <span class="o">=</span> <span class="o">(</span><span class="n">ImageView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">imageView</span><span class="o">);</span>
<span class="n">imageView</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="n">bitmap</span><span class="o">);</span>
</pre></div>


<p>Here's the complete code needed to construct an <code>AsyncTask</code> that downloads a remote image and displays the image in an <code>ImageView</code> using just the official Google Android SDK. See the [[Creating and Executing Async Tasks]] for more information about executing asynchronous background tasks: </p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">ImageView</span> <span class="n">ivBasicImage</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>
        <span class="n">ivBasicImage</span> <span class="o">=</span> <span class="o">(</span><span class="n">ImageView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">ivBasicImage</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;https://i.imgur.com/tGbaZCY.jpg&quot;</span><span class="o">;</span>
        <span class="c1">// Download image from URL and display within ImageView</span>
        <span class="k">new</span> <span class="n">ImageDownloadTask</span><span class="o">(</span><span class="n">ivBasicImage</span><span class="o">).</span><span class="na">execute</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Defines the background task to download and then load the image within the ImageView</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">ImageDownloadTask</span> <span class="kd">extends</span> <span class="n">AsyncTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Void</span><span class="o">,</span> <span class="n">Bitmap</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="n">ImageView</span> <span class="n">imageView</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">ImageDownloadTask</span><span class="o">(</span><span class="n">ImageView</span> <span class="n">imageView</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">imageView</span> <span class="o">=</span> <span class="n">imageView</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="n">Bitmap</span> <span class="nf">doInBackground</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">addresses</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Bitmap</span> <span class="n">bitmap</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="n">InputStream</span> <span class="n">in</span><span class="o">;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="c1">// 1. Declare a URL Connection</span>
                <span class="n">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="n">addresses</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
                <span class="n">HttpURLConnection</span> <span class="n">conn</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
                <span class="c1">// 2. Open InputStream to connection</span>
                <span class="n">conn</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>
                <span class="n">in</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
                <span class="c1">// 3. Download and decode the bitmap using BitmapFactory</span>
                <span class="n">bitmap</span> <span class="o">=</span> <span class="n">BitmapFactory</span><span class="o">.</span><span class="na">decodeStream</span><span class="o">(</span><span class="n">in</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
              <span class="k">if</span><span class="o">(</span><span class="n">in</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
                 <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">bitmap</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="c1">// Fires after the task is completed, displaying the bitmap into the ImageView</span>
        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPostExecute</span><span class="o">(</span><span class="n">Bitmap</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Set bitmap image for the result</span>
            <span class="n">imageView</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>We could even create our own basic version of a library for loading images by wrapping up this logic into an object as <a href="https://gist.github.com/nesquena/d84f30b14288c786772b">outlined here</a>. </p>
<p>Of course, doing this the "hard" way is not recommended. In most cases, to avoid having to manually manage caching and download management, we are better off creating your own libraries or in most cases utilizing existing <a href="http://square.github.io/picasso/">third-party libraries</a>. </p>
<p><strong>Note:</strong> If you use the approach above to download and display many images within a ListView, you might run into some threading issues that cause buggy loading of images. The blog post <a href="http://android-developers.blogspot.com/2010/07/multithreading-for-performance.html">Multithreading for Performance</a> offers a solution in which you manage the active remote downloading background tasks to ensure that too many tasks are not being spun up at once. </p>
<h3 id="checking-for-network-connectivity">Checking for Network Connectivity<a class="headerlink" href="#checking-for-network-connectivity" title="Permanent link">&para;</a></h3>
<h4 id="checking-network-is-connected">Checking Network is Connected<a class="headerlink" href="#checking-network-is-connected" title="Permanent link">&para;</a></h4>
<p>First, make sure to setup the <code>android.permission.ACCESS_NETWORK_STATE</code> permission as shown above. To verify network availability you can then define and call this method:</p>
<div class="codehilite"><pre><span></span><span class="kd">private</span> <span class="n">Boolean</span> <span class="nf">isNetworkAvailable</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">ConnectivityManager</span> <span class="n">connectivityManager</span> 
          <span class="o">=</span> <span class="o">(</span><span class="n">ConnectivityManager</span><span class="o">)</span> <span class="n">getSystemService</span><span class="o">(</span><span class="n">Context</span><span class="o">.</span><span class="na">CONNECTIVITY_SERVICE</span><span class="o">);</span>
    <span class="n">NetworkInfo</span> <span class="n">activeNetworkInfo</span> <span class="o">=</span> <span class="n">connectivityManager</span><span class="o">.</span><span class="na">getActiveNetworkInfo</span><span class="o">();</span>
    <span class="k">return</span> <span class="n">activeNetworkInfo</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">activeNetworkInfo</span><span class="o">.</span><span class="na">isConnectedOrConnecting</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Having an active network interface doesn't guarantee that a particular networked service is available or that <strong>the internet is actually connected</strong>. Network issues, server downtime, low signal, captive portals, content filters and the like can all prevent your app from reaching a server. For instance you can't tell for sure if your app can reach Twitter until you receive a valid response from the Twitter service.</p>
</div>
<p>See <a href="http://developer.android.com/training/monitoring-device-state/connectivity-monitoring.html">this official connectivity guide</a> for more details.</p>
<h4 id="checking-the-internet-is-connected">Checking the Internet is Connected<a class="headerlink" href="#checking-the-internet-is-connected" title="Permanent link">&para;</a></h4>
<p>To verify if the device is actually connected to the internet, we can use the following method of pinging the Google DNS servers to check for the expected exit value:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isOnline</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Runtime</span> <span class="n">runtime</span> <span class="o">=</span> <span class="n">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">Process</span> <span class="n">ipProcess</span> <span class="o">=</span> <span class="n">runtime</span><span class="o">.</span><span class="na">exec</span><span class="o">(</span><span class="s">&quot;/system/bin/ping -c 1 8.8.8.8&quot;</span><span class="o">);</span>
        <span class="kt">int</span>     <span class="n">exitValue</span> <span class="o">=</span> <span class="n">ipProcess</span><span class="o">.</span><span class="na">waitFor</span><span class="o">();</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">exitValue</span> <span class="o">==</span> <span class="mi">0</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span>          <span class="o">{</span> <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span> <span class="o">}</span> 
      <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span> <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span> <span class="o">}</span>
    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>


<p>Note that this does not need to be run in background and does not require special privileges. See <a href="http://stackoverflow.com/a/27312494">this stackoverflow post</a> for the source of this solution.</p>
<h2 id="networking-with-the-volley-library">Networking with the Volley Library<a class="headerlink" href="#networking-with-the-volley-library" title="Permanent link">&para;</a></h2>
<p>Volley is a library that makes networking for Android apps easier and most importantly, faster. Volley Library was announced by <a href="https://plus.google.com/+FicusKirkpatrick">Ficus Kirkpatrick</a> at Google I/O '13.
It was first used by the Play Store team in Play Store Application and then they released it as an open source library.  Although it is part of the Android Open Source Project (AOSP), Google announced in January 2017 that Volley will move to a <a href="https://plus.google.com/+IanLake/posts/EvB2BeqDUjC">standalone library</a>.</p>
<h2 id="why-volley">Why Volley?<a class="headerlink" href="#why-volley" title="Permanent link">&para;</a></h2>
<ul>
<li>Volley can pretty much do everything with that has to do with Networking in Android.</li>
<li>Volley automatically schedules all network requests such as fetching responses for image from web.</li>
<li>Volley provides transparent disk and memory caching.</li>
<li>Volley provides powerful cancellation request API for canceling a single request or you can set blocks of requests to cancel.</li>
<li>Volley provides powerful customization abilities.</li>
<li>Volley provides debugging and tracing tools.</li>
</ul>
<h2 id="setup-volley">Setup Volley<a class="headerlink" href="#setup-volley" title="Permanent link">&para;</a></h2>
<p>Adding Volley to our <code>app/build.gradle</code> file:</p>
<div class="codehilite"><pre><span></span><span class="n">dependencies</span> <span class="err">{</span>
    <span class="n">compile</span> <span class="s1">&#39;com.android.volley:volley:1.0.0&#39;</span>
<span class="err">}</span>
</pre></div>


<p>And add the internet permission in <code>AndroidManifest.xml</code>:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;com.example.simplenetworking&quot;</span>
    <span class="na">android:versionCode=</span><span class="s">&quot;1&quot;</span>
    <span class="na">android:versionName=</span><span class="s">&quot;1.0&quot;</span> <span class="nt">&gt;</span>

   <span class="c">&lt;!-- Add permissions here --&gt;</span>
   <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span> <span class="nt">/&gt;</span> 
   <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<h2 id="how-to-use-volley">How to use Volley?<a class="headerlink" href="#how-to-use-volley" title="Permanent link">&para;</a></h2>
<p>Volley has two classes that you will have to deal with:</p>
<ol>
<li><code>RequestQueue</code> - Requests are queued up here to be executed</li>
<li><code>Request</code> (and any extension of it) - Constructing an network request</li>
</ol>
<p>A Request object comes in three major types:</p>
<ul>
<li><a href="http://afzaln.com/volley/com/android/volley/toolbox/JsonObjectRequest.html">JsonObjectRequest</a>  To send and receive JSON Object from the server</li>
<li><a href="http://afzaln.com/volley/com/android/volley/toolbox/JsonArrayRequest.html">JsonArrayRequest</a>  To receive JSON Array from the server</li>
<li><a href="http://afzaln.com/volley/com/android/volley/toolbox/ImageRequest.html">ImageRequest</a> - To receive an image from the server</li>
<li><a href="http://afzaln.com/volley/com/android/volley/toolbox/StringRequest.html">StringRequest</a>  To retrieve response body as String (ideally if you intend to parse the response by yourself)</li>
</ul>
<h3 id="constructing-a-requestqueue">Constructing a RequestQueue<a class="headerlink" href="#constructing-a-requestqueue" title="Permanent link">&para;</a></h3>
<p>All requests in Volley are placed in a queue first and then processed, here is how you will be creating a request queue:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="n">MainActivity</span> <span class="kd">extends</span> <span class="n">AppCompatActivity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">RequestQueue</span> <span class="n">mRequestQueue</span><span class="o">;</span>

    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">main_screen_layout</span><span class="o">);</span>
        <span class="c1">// ...</span>
        <span class="n">mRequestQueue</span> <span class="o">=</span> <span class="n">Volley</span><span class="o">.</span><span class="na">newRequestQueue</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h3 id="creating-a-singleton-queue">Creating a Singleton Queue<a class="headerlink" href="#creating-a-singleton-queue" title="Permanent link">&para;</a></h3>
<p>See <a href="https://developer.android.com/training/volley/requestqueue.html">this guide for creating a singleton to use for sending requests</a>. </p>
<h3 id="requesting-images">Requesting images<a class="headerlink" href="#requesting-images" title="Permanent link">&para;</a></h3>
<p>Volley provides the ability to make image requests and receive back as bitmap.  You can use this bitmap to set directly onto an ImageView.</p>
<div class="codehilite"><pre><span></span><span class="n">ImageRequest</span> <span class="n">imageRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageRequest</span><span class="o">(</span><span class="s">&quot;http://i.imgur.com/Nwk25LA.jpg&quot;</span><span class="o">,</span> 
  <span class="k">new</span> <span class="n">Response</span><span class="o">.</span><span class="na">Listener</span><span class="o">&lt;</span><span class="n">Bitmap</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResponse</span><span class="o">(</span><span class="n">Bitmap</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>

    <span class="o">},</span> 
    <span class="c1">// Image width &amp; height equals 0 means to use the actual size</span>
    <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> 
    <span class="c1">// ImageView scale type</span>
    <span class="n">ImageView</span><span class="o">.</span><span class="na">ScaleType</span><span class="o">.</span><span class="na">FIT_XY</span><span class="o">,</span> 
    <span class="c1">// 8 bytes per pixel image </span>
    <span class="n">Bitmap</span><span class="o">.</span><span class="na">Config</span><span class="o">.</span><span class="na">ARGB_8888</span><span class="o">,</span> <span class="k">new</span> <span class="n">Response</span><span class="o">.</span><span class="na">ErrorListener</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onErrorResponse</span><span class="o">(</span><span class="n">VolleyError</span> <span class="n">error</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">error</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">});</span>
</pre></div>


<h3 id="accessing-json-data">Accessing JSON Data<a class="headerlink" href="#accessing-json-data" title="Permanent link">&para;</a></h3>
<p>After this step you are ready to create your <code>Request</code> objects which represents a desired request to be executed. Then we add that request onto the queue. </p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">RequestQueue</span> <span class="n">mRequestQueue</span><span class="o">;</span>

        <span class="c1">// ...</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">fetchJsonResponse</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Pass second argument as &quot;null&quot; for GET requests</span>
        <span class="n">JsonObjectRequest</span> <span class="n">req</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JsonObjectRequest</span><span class="o">(</span><span class="n">Request</span><span class="o">.</span><span class="na">Method</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="s">&quot;http://ip.jsontest.com/&quot;</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span>
            <span class="k">new</span> <span class="n">Response</span><span class="o">.</span><span class="na">Listener</span><span class="o">&lt;</span><span class="n">JSONObject</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResponse</span><span class="o">(</span><span class="n">JSONObject</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">try</span> <span class="o">{</span>
                        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;Your IP Address is &quot;</span> <span class="o">+</span> <span class="n">response</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;ip&quot;</span><span class="o">);</span>
                        <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">result</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">},</span> <span class="k">new</span> <span class="n">Response</span><span class="o">.</span><span class="na">ErrorListener</span><span class="o">()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onErrorResponse</span><span class="o">(</span><span class="n">VolleyError</span> <span class="n">error</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">VolleyLog</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="s">&quot;Error: &quot;</span><span class="o">,</span> <span class="n">error</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
                <span class="o">}</span>
        <span class="o">});</span>

        <span class="cm">/* Add your Requests to the RequestQueue to execute */</span>
        <span class="n">mRequestQueue</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">req</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>And that will execute the request to the server and respond back with the result as specified in the <code>Response.Listener</code> callback. For a more detailed look at Volley, check out <a href="http://arnab.ch/blog/2013/08/asynchronous-http-requests-in-android-using-volley/">this volley tutorial</a>.</p>
<h3 id="canceling-requests">Canceling Requests<a class="headerlink" href="#canceling-requests" title="Permanent link">&para;</a></h3>
<p>You can tag a request with:</p>
<div class="codehilite"><pre><span></span><span class="n">StringRequest</span> <span class="n">stringRequest</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">RequestQueue</span> <span class="n">mRequestQueue</span> <span class="o">=</span> <span class="o">...;</span>

<span class="c1">// Set the tag on the request.</span>
<span class="n">stringRequest</span><span class="o">.</span><span class="na">setTag</span><span class="o">(</span><span class="n">TAG</span><span class="o">);</span>

<span class="c1">// Add the request to the RequestQueue.</span>
<span class="n">mRequestQueue</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">stringRequest</span><span class="o">);</span>
</pre></div>


<p>You can now cancel all requests with this tag using the <code>cancelAll</code> on the request queue:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onStop</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">onStop</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">mRequestQueue</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mRequestQueue</span><span class="o">.</span><span class="na">cancelAll</span><span class="o">(</span><span class="n">TAG</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h3 id="using-with-okhttp">Using with OkHttp<a class="headerlink" href="#using-with-okhttp" title="Permanent link">&para;</a></h3>
<p>Although Volley uses the <code>HttpUrlConnection</code> interface for networking calls, the OkHttp library instead can be used instead since it also provides an implementation of this interface:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OkHttpStack</span> <span class="kd">extends</span> <span class="n">HurlStack</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">OkHttpClient</span> <span class="n">client</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">OkHttpStack</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">(</span><span class="k">new</span> <span class="n">OkHttpClient</span><span class="o">());</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nf">OkHttpStack</span><span class="o">(</span><span class="n">OkHttpClient</span> <span class="n">client</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">client</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">NullPointerException</span><span class="o">(</span><span class="s">&quot;Client must not be null.&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">this</span><span class="o">.</span><span class="na">client</span> <span class="o">=</span> <span class="n">client</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span> <span class="kd">protected</span> <span class="n">HttpURLConnection</span> <span class="nf">createConnection</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
  <span class="o">}</span>   
<span class="o">}</span>
</pre></div>


<p>You can then generate a request queue:</p>
<div class="codehilite"><pre><span></span><span class="n">Volley</span><span class="o">.</span><span class="na">newRequestQueue</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="k">new</span> <span class="n">OkHttpStack</span><span class="o">());</span>
</pre></div>


<p>Follow this <a href="https://gist.github.com/JakeWharton/5616899">gist</a> for more information.</p>
<h3 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h3>
<p>You can enable verbose logging by simplify setting <code>VolleyLog.DEBUG</code> to be true before issuing network requests:</p>
<div class="codehilite"><pre><span></span><span class="n">VolleyLog</span><span class="o">.</span><span class="na">DEBUG</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
</pre></div>


<p>You can also activate verbose logging after an app has already been running by typing this command using the Android Debug Shell (ADB):</p>
<div class="codehilite"><pre><span></span>adb shell setprop log.tag.Volley VERBOSE
</pre></div>


<p>The output will show cache hits, queue additions, and network latency calls:</p>
<div class="codehilite"><pre><span></span><span class="mi">03</span><span class="o">-</span><span class="mi">13</span> <span class="mi">23</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">11</span><span class="p">.</span><span class="mi">382</span> <span class="mi">2565</span><span class="o">-</span><span class="mi">2565</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">test</span> <span class="n">D</span><span class="o">/</span><span class="n">Volley</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">MarkerLog</span><span class="p">.</span><span class="n">finish</span><span class="p">:</span> <span class="p">(</span><span class="mi">1494</span> <span class="n">ms</span><span class="p">)</span> <span class="p">[</span> <span class="p">]</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">i</span><span class="p">.</span><span class="n">imgur</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">Nwk25LA</span><span class="p">.</span><span class="n">jpg</span> <span class="mi">0</span><span class="n">x189700ee</span> <span class="n">LOW</span> <span class="mi">1</span>
<span class="mi">03</span><span class="o">-</span><span class="mi">13</span> <span class="mi">23</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">11</span><span class="p">.</span><span class="mi">382</span> <span class="mi">2565</span><span class="o">-</span><span class="mi">2565</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">test</span> <span class="n">D</span><span class="o">/</span><span class="n">Volley</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">MarkerLog</span><span class="p">.</span><span class="n">finish</span><span class="p">:</span> <span class="p">(</span><span class="o">+</span><span class="mi">0</span>   <span class="p">)</span> <span class="p">[</span> <span class="mi">1</span><span class="p">]</span> <span class="k">add</span><span class="o">-</span><span class="k">to</span><span class="o">-</span><span class="n">queue</span>
<span class="mi">03</span><span class="o">-</span><span class="mi">13</span> <span class="mi">23</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">11</span><span class="p">.</span><span class="mi">382</span> <span class="mi">2565</span><span class="o">-</span><span class="mi">2565</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">test</span> <span class="n">D</span><span class="o">/</span><span class="n">Volley</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">MarkerLog</span><span class="p">.</span><span class="n">finish</span><span class="p">:</span> <span class="p">(</span><span class="o">+</span><span class="mi">85</span>  <span class="p">)</span> <span class="p">[</span><span class="mi">191</span><span class="p">]</span> <span class="k">cache</span><span class="o">-</span><span class="n">queue</span><span class="o">-</span><span class="n">take</span>
<span class="mi">03</span><span class="o">-</span><span class="mi">13</span> <span class="mi">23</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">11</span><span class="p">.</span><span class="mi">382</span> <span class="mi">2565</span><span class="o">-</span><span class="mi">2565</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">test</span> <span class="n">D</span><span class="o">/</span><span class="n">Volley</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">MarkerLog</span><span class="p">.</span><span class="n">finish</span><span class="p">:</span> <span class="p">(</span><span class="o">+</span><span class="mi">107</span> <span class="p">)</span> <span class="p">[</span><span class="mi">191</span><span class="p">]</span> <span class="k">cache</span><span class="o">-</span><span class="n">hit</span>
<span class="mi">03</span><span class="o">-</span><span class="mi">13</span> <span class="mi">23</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">11</span><span class="p">.</span><span class="mi">383</span> <span class="mi">2565</span><span class="o">-</span><span class="mi">2565</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">test</span> <span class="n">D</span><span class="o">/</span><span class="n">Volley</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">MarkerLog</span><span class="p">.</span><span class="n">finish</span><span class="p">:</span> <span class="p">(</span><span class="o">+</span><span class="mi">957</span> <span class="p">)</span> <span class="p">[</span><span class="mi">191</span><span class="p">]</span> <span class="k">cache</span><span class="o">-</span><span class="n">hit</span><span class="o">-</span><span class="n">parsed</span>
<span class="mi">03</span><span class="o">-</span><span class="mi">13</span> <span class="mi">23</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">11</span><span class="p">.</span><span class="mi">383</span> <span class="mi">2565</span><span class="o">-</span><span class="mi">2565</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">test</span> <span class="n">D</span><span class="o">/</span><span class="n">Volley</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">MarkerLog</span><span class="p">.</span><span class="n">finish</span><span class="p">:</span> <span class="p">(</span><span class="o">+</span><span class="mi">0</span>   <span class="p">)</span> <span class="p">[</span><span class="mi">191</span><span class="p">]</span> <span class="n">post</span><span class="o">-</span><span class="n">response</span>
<span class="mi">03</span><span class="o">-</span><span class="mi">13</span> <span class="mi">23</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">11</span><span class="p">.</span><span class="mi">383</span> <span class="mi">2565</span><span class="o">-</span><span class="mi">2565</span><span class="o">/</span><span class="n">com</span><span class="p">.</span><span class="n">test</span> <span class="n">D</span><span class="o">/</span><span class="n">Volley</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">MarkerLog</span><span class="p">.</span><span class="n">finish</span><span class="p">:</span> <span class="p">(</span><span class="o">+</span><span class="mi">345</span> <span class="p">)</span> <span class="p">[</span> <span class="mi">1</span><span class="p">]</span> <span class="n">done</span>
</pre></div>


<h2 id="creating-and-executing-async-tasks">Creating and Executing Async Tasks<a class="headerlink" href="#creating-and-executing-async-tasks" title="Permanent link">&para;</a></h2>
<p>AsyncTask is a mechanism for executing operations in a background thread without having to manually handle thread creation or execution. AsyncTasks were designed to be used for short operations (a few seconds at the most) and you might want to use a `Service <a href="http://developer.android.com/reference/java/util/concurrent/Executor.html">Executor</a> for very long running tasks.</p>
<p>This is typically used for long running tasks that cannot be done on UIThread, such as downloading network data from an API or indexing data from elsewhere on the device. An <code>AsyncTask</code> streamlines the following common background process:</p>
<ol>
<li><strong>Pre</strong> - Execute code on the UI thread before starting a task (e.g show ProgressBar)</li>
<li><strong>Task</strong> - Run a background task on a thread given certain inputs (e.g fetch data)</li>
<li><strong>Updates</strong> - Display progress updates during the task (optional)</li>
<li><strong>Post</strong> - Execute code on UI thread following completion of the task (e.g show data)</li>
</ol>
<p>See [[Displaying Remote Images the Hard Way|Sending-and-Managing-Network-Requests#displaying-remote-images-the-hard-way]] for an example of how AsyncTask can be used for retrieving a remote image.</p>
<h3 id="defining-an-asynctask">Defining an AsyncTask<a class="headerlink" href="#defining-an-asynctask" title="Permanent link">&para;</a></h3>
<p>Creating an AsyncTask is as simple as defining a class that extends from <code>AsyncTask</code> such as: </p>
<div class="codehilite"><pre><span></span><span class="c1">// The types specified here are the input data type, the progress type, and the result type</span>
<span class="kd">private</span> <span class="kd">class</span> <span class="nc">MyAsyncTask</span> <span class="kd">extends</span> <span class="n">AsyncTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Void</span><span class="o">,</span> <span class="n">Bitmap</span><span class="o">&gt;</span> <span class="o">{</span>
     <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPreExecute</span><span class="o">()</span> <span class="o">{</span>
         <span class="c1">// Runs on the UI thread before doInBackground</span>
         <span class="c1">// Good for toggling visibility of a progress indicator</span>
         <span class="n">progressBar</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">ProgressBar</span><span class="o">.</span><span class="na">VISIBLE</span><span class="o">);</span>
     <span class="o">}</span>

     <span class="kd">protected</span> <span class="n">Bitmap</span> <span class="nf">doInBackground</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">strings</span><span class="o">)</span> <span class="o">{</span>
         <span class="c1">// Some long-running task like downloading an image.</span>
         <span class="n">Bitmap</span> <span class="o">=</span> <span class="n">downloadImageFromUrl</span><span class="o">(</span><span class="n">strings</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
         <span class="k">return</span> <span class="n">someBitmap</span><span class="o">;</span>
     <span class="o">}</span>

     <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onProgressUpdate</span><span class="o">(</span><span class="n">Progress</span><span class="o">...</span> <span class="n">values</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Executes whenever publishProgress is called from doInBackground</span>
        <span class="c1">// Used to update the progress indicator</span>
        <span class="n">progressBar</span><span class="o">.</span><span class="na">setProgress</span><span class="o">(</span><span class="n">values</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
     <span class="o">}</span>  

     <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPostExecute</span><span class="o">(</span><span class="n">Bitmap</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
         <span class="c1">// This method is executed in the UIThread</span>
         <span class="c1">// with access to the result of the long running task</span>
         <span class="n">imageView</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
         <span class="c1">// Hide the progress bar</span>
         <span class="n">progressBar</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">ProgressBar</span><span class="o">.</span><span class="na">INVISIBLE</span><span class="o">);</span>
     <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h3 id="executing-the-asynctask">Executing the AsyncTask<a class="headerlink" href="#executing-the-asynctask" title="Permanent link">&para;</a></h3>
<p>The worker once defined can be started anytime by creating an instance of the class and then invoke <code>.execute</code> to start the task:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// ...</span>
   <span class="c1">// Initiate the background task</span>
   <span class="n">downloadImageAsync</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kt">void</span> <span class="nf">downloadImageAsync</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// Now we can execute the long-running task at any time.</span>
    <span class="k">new</span> <span class="n">MyAsyncTask</span><span class="o">().</span><span class="na">execute</span><span class="o">(</span><span class="s">&quot;http://images.com/image.jpg&quot;</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>


<h3 id="understanding-the-asynctask">Understanding the AsyncTask<a class="headerlink" href="#understanding-the-asynctask" title="Permanent link">&para;</a></h3>
<p>AsyncTask accepts three generic types to inform the background work being done:</p>
<ul>
<li><code>AsyncTask&lt;Params, Progress, Result&gt;</code></li>
<li><code>Params</code> - the type that is passed into the execute() method.</li>
<li><code>Progress</code> - the type that is used within the task to track progress.</li>
<li><code>Result</code> - the type that is returned by doInBackground().</li>
</ul>
<p>For example <code>AsyncTask&lt;String, Void, Bitmap&gt;</code> means that the task requires a string input to execute, does not record progress and returns a Bitmap after the task is complete.</p>
<p>AsyncTask has multiple events that can be overridden to control different behavior:</p>
<ul>
<li><code>onPreExecute</code> - executed in the main thread to do things like create the initial progress bar view.</li>
<li><code>doInBackground</code> - executed in the background thread to do things like network downloads.</li>
<li><code>onProgressUpdate</code> - executed in the main thread when <code>publishProgress</code> is called from doInBackground.</li>
<li><code>onPostExecute</code> - executed in the main thread to do things like set image views.</li>
</ul>
<h3 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permanent link">&para;</a></h3>
<p>An <code>AsyncTask</code> is tightly bound to a particular <code>Activity</code>. In other words, if the <code>Activity</code> is destroyed or the configuration changes then the <code>AsyncTask</code> will not be able to update the UI on completion. As a result, for short one-off background tasks <strong>tightly coupled to updating an Activity</strong>, we should consider using an <code>AsyncTask</code> as outlined above. A good example is for a several second network request that will populate data into a <code>ListView</code> within an activity.</p>
<h3 id="custom-thread-management">Custom Thread Management<a class="headerlink" href="#custom-thread-management" title="Permanent link">&para;</a></h3>
<p>Using the <code>AsyncTask</code> is the easiest and most convenient way to manage background tasks from within an Activity. However, in cases where tasks need to be processed in parallel with more control, or the tasks <strong>need to continue executing even when the activity leaves the screen</strong>, you'll need to create a [[background service|Starting-Background-Services]] or [[manage threaded operations|Managing-Threads-and-Custom-Services]] more manually.</p>
<h2 id="displaying-images-with-the-picasso-library">Displaying Images with the Picasso Library<a class="headerlink" href="#displaying-images-with-the-picasso-library" title="Permanent link">&para;</a></h2>
<p>Displaying images is easiest using a third party library such as <a href="http://square.github.io/picasso/">Picasso</a> from Square which will download and cache remote images and abstract the complexity behind an easy to use DSL.</p>
<h3 id="setup-picasso">Setup Picasso<a class="headerlink" href="#setup-picasso" title="Permanent link">&para;</a></h3>
<p>Adding Picasso to our <code>app/build.gradle</code> file:</p>
<div class="codehilite"><pre><span></span><span class="n">dependencies</span> <span class="err">{</span>
    <span class="n">compile</span> <span class="s1">&#39;com.squareup.picasso:picasso:2.5.2&#39;</span>
<span class="err">}</span>
</pre></div>


<p><strong>Note</strong>: there is a bug with the current version of Picasso that prevents large images (i.e. 10MB) from being loaded, especially with newer camera phones that have larger resolutions.   If you are experiencing <a href="https://github.com/square/picasso/issues/364">this issue</a>, you may need to upgrade to the Picasso 2.6.0 snapshot.</p>
<p>To use this snapshot version, you need to add a custom separate Maven repo first:</p>
<div class="codehilite"><pre><span></span><span class="n">repositories</span> <span class="err">{</span>
    <span class="n">maven</span> <span class="err">{</span> <span class="n">url</span> <span class="ss">&quot;https://oss.sonatype.org/content/repositories/snapshots&quot;</span> <span class="err">}</span>
<span class="err">}</span>

<span class="o">//</span> <span class="k">add</span> <span class="n">directly</span> <span class="n">below</span> <span class="n">repositories</span> <span class="n">section</span>
<span class="n">dependencies</span> <span class="err">{</span>
    <span class="n">compile</span> <span class="s1">&#39;com.squareup.picasso:picasso:2.6.0-SNAPSHOT&#39;</span>
<span class="err">}</span>
</pre></div>


<h3 id="loading-an-image-from-url">Loading an Image from Url<a class="headerlink" href="#loading-an-image-from-url" title="Permanent link">&para;</a></h3>
<p>We can then load a remote image into any <code>ImageView</code> with:</p>
<div class="codehilite"><pre><span></span><span class="n">String</span> <span class="n">imageUri</span> <span class="o">=</span> <span class="s">&quot;https://i.imgur.com/tGbaZCY.jpg&quot;</span><span class="o">;</span>
<span class="n">ImageView</span> <span class="n">ivBasicImage</span> <span class="o">=</span> <span class="o">(</span><span class="n">ImageView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">ivBasicImage</span><span class="o">);</span>
<span class="n">Picasso</span><span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">context</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="n">imageUri</span><span class="o">).</span><span class="na">into</span><span class="o">(</span><span class="n">ivBasicImage</span><span class="o">);</span>
</pre></div>


<h3 id="configuring-picasso">Configuring Picasso<a class="headerlink" href="#configuring-picasso" title="Permanent link">&para;</a></h3>
<p>We can do more sophisticated work with Picasso configuring placeholders, error handling, adjusting size of the image, and scale type with:</p>
<div class="codehilite"><pre><span></span><span class="n">Picasso</span><span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">context</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="n">imageUri</span><span class="o">).</span><span class="na">fit</span><span class="o">().</span><span class="na">centerCrop</span><span class="o">()</span>
    <span class="o">.</span><span class="na">placeholder</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">user_placeholder</span><span class="o">)</span>
    <span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">user_placeholder_error</span><span class="o">)</span>
    <span class="o">.</span><span class="na">into</span><span class="o">(</span><span class="n">imageView</span><span class="o">);</span>
</pre></div>


<p>Be sure to use <code>fit()</code> to resize the image before loading into the ImageView.  Otherwise, you will consume extra memory, experience sluggish scrolling, or encounter out of memory issues if you render a lot of pictures. In addition to <code>placeholder</code> and <code>error</code>, there is also <a href="https://futurestud.io/blog/picasso-placeholders-errors-and-fading">other configuration options</a> such as <code>noFade()</code> and <code>noPlaceholder()</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Placeholders and error images are <strong>not resized</strong> and must be fairly small images. Open up your static placeholder or error images in your drawable folders and make sure that the dimensions of the images are relatively small (i.e &lt; 500px width). If not, resize those static images first and save them back to the project.</p>
</div>
<h3 id="resizing-with-picasso">Resizing with Picasso<a class="headerlink" href="#resizing-with-picasso" title="Permanent link">&para;</a></h3>
<p>We can resize an image with respect to the aspect ratio using <code>resize</code> and specifying 0 for the other dimension as <a href="https://github.com/square/picasso/pull/663">outlined here</a>:</p>
<div class="codehilite"><pre><span></span><span class="c1">// Resize to the width specified maintaining aspect ratio</span>
<span class="n">Picasso</span><span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="k">this</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="n">imageUrl</span><span class="o">).</span>
  <span class="n">resize</span><span class="o">(</span><span class="n">someWidth</span><span class="o">,</span> <span class="mi">0</span><span class="o">).</span><span class="na">into</span><span class="o">(</span><span class="n">imageView</span><span class="o">);</span>
</pre></div>


<p>We can combine resizing with certain transforms to make the image appear differently. For example, we can do a center cropping with:</p>
<div class="codehilite"><pre><span></span><span class="n">Picasso</span><span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">context</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="n">url</span><span class="o">).</span><span class="na">resize</span><span class="o">(</span><span class="mi">50</span><span class="o">,</span> <span class="mi">50</span><span class="o">).</span>
  <span class="n">centerCrop</span><span class="o">().</span><span class="na">into</span><span class="o">(</span><span class="n">imageView</span><span class="o">);</span>
</pre></div>


<p>Transform options include <code>centerCrop()</code> (Crops an image inside of the bounds), <code>centerInside()</code> (Centers an image inside of the bounds), <code>fit()</code> (Attempt to resize the image to fit exactly into the target). See <a href="https://futurestud.io/blog/picasso-image-resizing-scaling-and-fit">this post for more details</a>.</p>
<h2 id="troubleshooting_1">Troubleshooting<a class="headerlink" href="#troubleshooting_1" title="Permanent link">&para;</a></h2>
<h3 id="outofmemoryerror-loading-errors">OutOfMemoryError Loading Errors<a class="headerlink" href="#outofmemoryerror-loading-errors" title="Permanent link">&para;</a></h3>
<p>If an image or set of images aren't loading, make sure to check the Android monitor log in Android Studio. There's a good chance you might see an <code>java.lang.OutOfMemoryError "Failed to allocate a [...] byte allocation with [...] free bytes"</code> or a <code>Out of memory on a 51121168-byte allocation.</code>. This is quite common and means that <strong>you are loading one or more large images</strong> that have not been properly resized.</p>
<p>First, you have to find which image(s) being loaded are likely causing this error. For any given <code>Picasso</code> call, we can fix this by <strong>one or more of the following approaches</strong>:</p>
<ol>
<li>Add an explicit width or height to the <code>ImageView</code> by setting <code>layout_width=500dp</code> in the layout file and then be sure to call <code>fit()</code> during your load: <code>Picasso.with(...).load(imageUri).fit().into(...)</code></li>
<li>Call <code>.resize(width, height)</code> during the Picasso load and explicitly set a width or height for the image such as: <code>Picasso.with(...).load(imageUri).resize(500, 0).into(...)</code>. By passing 0, the correct height is automatically calculated.</li>
<li>Try removing <code>android:adjustViewBounds="true"</code> from your <code>ImageView</code> if present if you are calling <code>.fit()</code> rather than using <code>.resize(width, 0)</code></li>
<li>Open up your static placeholder or error images and make sure their dimensions are relatively small (&lt; 500px width). If not, resize those static images and save them back to your project.</li>
</ol>
<p>Applying these tips to all of your Picasso image loads should resolve any out of memory issues. As a fallback, you might want to open up your <code>AndroidManifest.xml</code> and then add <code>android:largeHeap</code> to your manifest:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;application</span>
        <span class="na">android:name=</span><span class="s">&quot;.MyApplication&quot;</span>
        <span class="err">...</span>
        <span class="na">android:largeHeap=</span><span class="s">&quot;true&quot;</span>
        <span class="err">...</span>
</pre></div>


<p>Note that this is not generally a good idea, but can be used temporarily to trigger less out of memory errors.</p>
<h3 id="loading-errors">Loading Errors<a class="headerlink" href="#loading-errors" title="Permanent link">&para;</a></h3>
<p>If you experience errors loading images, you can attach a listener to the <code>Builder</code> object to print the stack trace.</p>
<div class="codehilite"><pre><span></span><span class="n">Picasso</span><span class="o">.</span><span class="na">Builder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Picasso</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">());</span>
<span class="n">builder</span><span class="o">.</span><span class="na">listener</span><span class="o">(</span><span class="k">new</span> <span class="n">Picasso</span><span class="o">.</span><span class="na">Listener</span><span class="o">()</span> <span class="o">{</span>
     <span class="nd">@Override</span>
     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onImageLoadFailed</span><span class="o">(</span><span class="n">Picasso</span> <span class="n">picasso</span><span class="o">,</span> <span class="n">Uri</span> <span class="n">uri</span><span class="o">,</span> <span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span>
         <span class="n">exception</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">});</span>
</pre></div>


<h2 id="advanced-usages">Advanced Usages<a class="headerlink" href="#advanced-usages" title="Permanent link">&para;</a></h2>
<h3 id="showing-progressbar-with-picasso">Showing ProgressBar with Picasso<a class="headerlink" href="#showing-progressbar-with-picasso" title="Permanent link">&para;</a></h3>
<p>We can add a progress bar or otherwise handle callbacks for an image that is loading with:</p>
<div class="codehilite"><pre><span></span><span class="c1">// Show progress bar</span>
<span class="n">progressBar</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">VISIBLE</span><span class="o">);</span>
<span class="c1">// Hide progress bar on successful load</span>
<span class="n">Picasso</span><span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="k">this</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="n">imageUrl</span><span class="o">)</span>
  <span class="o">.</span><span class="na">into</span><span class="o">(</span><span class="n">imageView</span><span class="o">,</span> <span class="k">new</span> <span class="n">com</span><span class="o">.</span><span class="na">squareup</span><span class="o">.</span><span class="na">picasso</span><span class="o">.</span><span class="na">Callback</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">progressBar</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
              <span class="n">progressBar</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">GONE</span><span class="o">);</span>
          <span class="o">}</span>
      <span class="o">}</span>

      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onError</span><span class="o">()</span> <span class="o">{</span>

      <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<h3 id="adjusting-image-size-dynamically">Adjusting Image Size Dynamically<a class="headerlink" href="#adjusting-image-size-dynamically" title="Permanent link">&para;</a></h3>
<p>If we wish to readjust the ImageView size after the image has been retrieved, we first define a <code>Target</code> object that governs how the Bitmap is handled:</p>
<div class="codehilite"><pre><span></span><span class="kd">private</span> <span class="n">Target</span> <span class="n">target</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Target</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onBitmapLoaded</span><span class="o">(</span><span class="n">Bitmap</span> <span class="n">bitmap</span><span class="o">,</span> <span class="n">Picasso</span><span class="o">.</span><span class="na">LoadedFrom</span> <span class="n">from</span><span class="o">)</span> <span class="o">{</span>  
       <span class="c1">// Bitmap is loaded, use image here</span>
       <span class="n">imageView</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="n">bitmap</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onBitmapFailed</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Fires if bitmap couldn&#39;t be loaded.</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Next, we can use the <code>Target</code> with a Picasso call with:</p>
<div class="codehilite"><pre><span></span><span class="n">Picasso</span><span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="k">this</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="s">&quot;url&quot;</span><span class="o">).</span><span class="na">into</span><span class="o">(</span><span class="n">target</span><span class="o">);</span>
</pre></div>


<p>You can still use all normal Picasso options like <code>resize</code>, <code>fit</code>, etc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>Target</code> object must be <strong>stored as a member field or method</strong> and cannot be an anonymous class otherwise this won't work as expected.  The reason is that Picasso accepts this parameter as a weak memory reference.  Because anonymous classes are eligible for garbage collection when there are no more references, the network request to fetch the image may finish after this anonymous class has already been reclaimed.  See this <a href="http://stackoverflow.com/questions/24180805/onbitmaploaded-of-target-object-not-called-on-first-load#answers">Stack Overflow</a> discussion for more details.</p>
</div>
<p>In other words, you are not allowed to do <code>Picasso.with(this).load("url").into(new Target() { ... })</code>.   </p>
<h4 id="creating-staggered-grid-images-with-recyclerview">Creating Staggered Grid Images with RecyclerView<a class="headerlink" href="#creating-staggered-grid-images-with-recyclerview" title="Permanent link">&para;</a></h4>
<p>We can use this custom Target approach to create a staggered image view using <code>RecyclerView</code>.</p>
<p><img src="https://i.imgur.com/gsp1prk.png" width="300"/></p>
<p>We first need to replace the <code>ImageView</code> with the <a href="https://github.com/etsy/AndroidStaggeredGrid/blob/master/library/src/main/java/com/etsy/android/grid/util/DynamicHeightImageView.java">DynamicHeightImageView.java</a> that enables us to update the <code>ImageView</code> width and height while still preserving the aspect ratio when new images are replaced with old recycled views. We can then set the ratio before the image has loaded if we already know the height:width ratio using <code>onBindViewHolder</code> as shown below:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PhotosAdapter</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">Adapter</span><span class="o">&lt;</span><span class="n">PhotoViewHolder</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="c1">// implement other methods here</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onBindViewHolder</span><span class="o">(</span><span class="n">PhotoViewHolder</span> <span class="n">holder</span><span class="o">,</span> <span class="kt">int</span> <span class="n">position</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Photo</span> <span class="n">photo</span> <span class="o">=</span> <span class="n">mPhotos</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">position</span><span class="o">);</span>
        <span class="c1">// `holder.ivPhoto` should be of type `DynamicHeightImageView`</span>
        <span class="c1">// Set the height ratio before loading in image into Picasso</span>
        <span class="n">holder</span><span class="o">.</span><span class="na">ivPhoto</span><span class="o">.</span><span class="na">setHeightRatio</span><span class="o">(((</span><span class="kt">double</span><span class="o">)</span><span class="n">photo</span><span class="o">.</span><span class="na">getHeight</span><span class="o">())/</span><span class="n">photo</span><span class="o">.</span><span class="na">getWidth</span><span class="o">());</span>
        <span class="c1">// Load the image into the view using Picasso</span>
        <span class="n">Picasso</span><span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">mContext</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="n">photo</span><span class="o">.</span><span class="na">getUrl</span><span class="o">()).</span><span class="na">into</span><span class="o">(</span><span class="n">holder</span><span class="o">.</span><span class="na">ivPhoto</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>


<p>Alternatively, we can set the ratio after the bitmap has loaded if we don't know that ratio ahead of time. To avoid using an anonymous class, we will implement the <code>Target</code> interface on the ViewHolder class itself for RecyclerView. When the callback is fired, we will calculate and update the image aspect ratio:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ViewHolder</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">ViewHolder</span> <span class="kd">implements</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">,</span> <span class="n">Target</span> <span class="o">{</span>
    <span class="n">DynamicHeightImageView</span> <span class="n">ivImage</span><span class="o">;</span>

    <span class="c1">// implement ViewHolder methods here</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onBitmapLoaded</span><span class="o">(</span><span class="n">Bitmap</span> <span class="n">bitmap</span><span class="o">,</span> <span class="n">Picasso</span><span class="o">.</span><span class="na">LoadedFrom</span> <span class="n">from</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Calculate the image ratio of the loaded bitmap</span>
        <span class="kt">float</span> <span class="n">ratio</span> <span class="o">=</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">bitmap</span><span class="o">.</span><span class="na">getHeight</span><span class="o">()</span> <span class="o">/</span> <span class="o">(</span><span class="kt">float</span><span class="o">)</span> <span class="n">bitmap</span><span class="o">.</span><span class="na">getWidth</span><span class="o">();</span>
        <span class="c1">// Set the ratio for the image </span>
        <span class="n">ivImage</span><span class="o">.</span><span class="na">setHeightRatio</span><span class="o">(</span><span class="n">ratio</span><span class="o">);</span>
        <span class="c1">// Load the image into the view</span>
        <span class="n">ivImage</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="n">bitmap</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>With either of these approaches the staggered grid of images should now render as expected.</p>
<h3 id="other-transformations">Other Transformations<a class="headerlink" href="#other-transformations" title="Permanent link">&para;</a></h3>
<p>You can also use this <a href="https://github.com/wasabeef/picasso-transformations">third-party library</a> for other transformations, such as blur, crop, color, and mask.  </p>
<div class="codehilite"><pre><span></span><span class="nv">dependencies</span> {
    <span class="nv">compile</span> <span class="s1">&#39;</span><span class="s">jp.wasabeef:picasso-transformations:2.1.0</span><span class="s1">&#39;</span>
    <span class="o">//</span> <span class="k">If</span> <span class="nv">you</span> <span class="nv">want</span> <span class="nv">to</span> <span class="nv">use</span> <span class="nv">the</span> <span class="nv">GPU</span> <span class="nv">Filters</span>
    <span class="nv">compile</span> <span class="s1">&#39;</span><span class="s">jp.co.cyberagent.android.gpuimage:gpuimage-library:1.4.1</span><span class="s1">&#39;</span>
}
</pre></div>


<p>To do a rounded corner transformation, you would do the following:</p>
<div class="codehilite"><pre><span></span><span class="n">Picasso</span><span class="o">.</span><span class="na">with</span><span class="o">(</span><span class="n">mContext</span><span class="o">).</span><span class="na">load</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">demo</span><span class="o">)</span>
        <span class="o">.</span><span class="na">transform</span><span class="o">(</span><span class="k">new</span> <span class="n">RoundedCornersTransformation</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">10</span><span class="o">)).</span><span class="na">into</span><span class="o">((</span><span class="n">ImageView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">image</span><span class="o">));</span>
</pre></div>


<h2 id="converting-json-to-models">Converting JSON to Models<a class="headerlink" href="#converting-json-to-models" title="Permanent link">&para;</a></h2>
<p>This guide describes the process of converting JSON data retrieved from a network request and converting that data to simple Model objects. This approach will be compatible with nearly any basic data-driven application and fits well with any ORM solution for persistence such as <code>DBFlow</code> or <a href="http://satyan.github.io/sugar/">SugarORM</a> that may be introduced.</p>
<p>For this guide, we will be using the <a href="http://www.yelp.com/developers/documentation/v2/search_api#searchGP">Yelp API</a> as the example. The goal of this guide is to <strong>perform a Yelp API Search</strong> and then <strong>process the results into Java objects</strong> which we can then use to populate information within our application.</p>
<p>The model in this case is <strong>Business</strong> and for our application, let's suppose we just need the <em>name</em>, <em>phone</em>, and <em>image</em> of the business which are all provided by the <a href="http://www.yelp.com/developers/documentation/v2/search_api#searchGP">Search API</a>.</p>
<h3 id="fetching-json-results">Fetching JSON Results<a class="headerlink" href="#fetching-json-results" title="Permanent link">&para;</a></h3>
<p>The first step in retrieving any API-based model data is to execute a network request to retrieve the JSON response that represents the underlying data that we want to use. In this case, we want to execute a request to <code>http://api.yelp.com/v2/search?term=food&amp;location=San+Francisco</code> and then this will return us a JSON dictionary that looks like:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;businesses&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;yelp-tropisueno&quot;</span><span class="p">,</span>
      <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;Tropisueno&quot;</span><span class="p">,</span>
      <span class="nt">&quot;display_phone&quot;</span><span class="p">:</span> <span class="s2">&quot;+1-415-908-3801&quot;</span><span class="p">,</span>
      <span class="nt">&quot;image_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://s3-media2.ak.yelpcdn.com/bphoto/7DIHu8a0AHhw-BffrDIxPA/ms.jpg&quot;</span><span class="p">,</span>
      <span class="err">...</span>
    <span class="p">}</span>
  <span class="p">]</span> 
<span class="p">}</span>
</pre></div>


<p>Sending out this API request can be done in any number of ways but first requires us to register for a Yelp developer account and use OAuth 1.0a to authenticate with our provided access_token. You might for example use the <a href="https://github.com/codepath/android-rest-client-template">rest-client-template</a> to manage this authentication and then construct a <code>YelpClient</code> that has a <code>search</code> method:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">YelpClient</span> <span class="kd">extends</span> <span class="n">OAuthBaseClient</span> <span class="o">{</span>
    <span class="c1">// LOTS OF TOKENS AND STUFF ...</span>

    <span class="c1">// Setting up the search endpoint</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">search</span><span class="o">(</span><span class="n">String</span> <span class="n">term</span><span class="o">,</span> <span class="n">String</span> <span class="n">location</span><span class="o">,</span> <span class="n">AsyncHttpResponseHandler</span> <span class="n">handler</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// http://api.yelp.com/v2/search?term=food&amp;location=San+Francisco</span>
        <span class="n">String</span> <span class="n">apiUrl</span> <span class="o">=</span> <span class="n">getApiUrl</span><span class="o">(</span><span class="s">&quot;search&quot;</span><span class="o">);</span>
        <span class="n">RequestParams</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RequestParams</span><span class="o">();</span>
        <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;term&quot;</span><span class="o">,</span> <span class="n">term</span><span class="o">);</span>
        <span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;location&quot;</span><span class="o">,</span> <span class="n">location</span><span class="o">);</span>
        <span class="n">client</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">apiUrl</span><span class="o">,</span> <span class="n">params</span><span class="o">,</span> <span class="n">handler</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>This <code>search</code> method will take care of executing our JSON request to the Yelp API. The API call might be executed in an Activity now when the user performs a search. Executing the API request would look like:</p>
<div class="codehilite"><pre><span></span><span class="n">YelpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">YelpClientApp</span><span class="o">.</span><span class="na">getRestClient</span><span class="o">();</span>
<span class="n">client</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="s">&quot;food&quot;</span><span class="o">,</span> <span class="s">&quot;san francisco&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">JsonHttpResponseHandler</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="kt">int</span> <span class="n">code</span><span class="o">,</span> <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span><span class="o">,</span> <span class="n">JSONObject</span> <span class="n">body</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">JSONArray</span> <span class="n">businessesJson</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">&quot;businesses&quot;</span><span class="o">);</span>
                        <span class="c1">// Here we now have the json array of businesses!</span>
            <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;DEBUG&quot;</span><span class="o">,</span> <span class="n">businesses</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="n">Throwable</span> <span class="n">arg0</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">SearchActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">&quot;FAIL&quot;</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<p>We could now run the app and verify that the JSON array of business has the format we expect from the provided sample response in the documentation.</p>
<h3 id="setting-up-our-model">Setting up our Model<a class="headerlink" href="#setting-up-our-model" title="Permanent link">&para;</a></h3>
<p>The primary resource in the Yelp API is the <strong>Business</strong>. Let's create a Java class that will act as the <strong>Business</strong> model in our application:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Business</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">phone</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">imageUrl</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPhone</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">phone</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getImageUrl</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">imageUrl</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>So far, the business model is just a series of declared fields and then getters to access those fields. Next, we need to add method that would manage the deserialization of a JSON dictionary into a populated Business object:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Business</span> <span class="o">{</span>
  <span class="c1">// ...</span>

  <span class="c1">// Decodes business json into business model object</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">Business</span> <span class="nf">fromJson</span><span class="o">(</span><span class="n">JSONObject</span> <span class="n">jsonObject</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Business</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Business</span><span class="o">();</span>
        <span class="c1">// Deserialize json into object fields</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">b</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">);</span>
            <span class="n">b</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">);</span>
            <span class="n">b</span><span class="o">.</span><span class="na">phone</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;display_phone&quot;</span><span class="o">);</span>
            <span class="n">b</span><span class="o">.</span><span class="na">imageUrl</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;image_url&quot;</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="c1">// Return new object</span>
    <span class="k">return</span> <span class="n">b</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>With this method in place, we could take a single business JSON dictionary such as:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
 <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;yelp-tropisueno&quot;</span><span class="p">,</span>
 <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;Tropisueno&quot;</span><span class="p">,</span>
 <span class="nt">&quot;display_phone&quot;</span><span class="p">:</span> <span class="s2">&quot;+1-415-908-3801&quot;</span><span class="p">,</span>
 <span class="nt">&quot;image_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://s3-media2.ak.yelpcdn.com/bphoto/7DIHu8a0AHhw-BffrDIxPA/ms.jpg&quot;</span><span class="p">,</span>
  <span class="err">...</span>
<span class="p">}</span>
</pre></div>


<p>and successfully create a Business with <code>Business.fromJson(json)</code>. However, in the API response, we actually get a collection of business JSON in an array. So ideally we also would have an easy way of processing an <strong>array of businesses</strong>  into an <strong>ArrayList of Business objects</strong>. That might look like:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Business</span> <span class="o">{</span>
  <span class="c1">// ...fields and getters</span>
  <span class="c1">// ...fromJson for an object</span>

  <span class="c1">// Decodes array of business json results into business model objects</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Business</span><span class="o">&gt;</span> <span class="nf">fromJson</span><span class="o">(</span><span class="n">JSONArray</span> <span class="n">jsonArray</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">JSONObject</span> <span class="n">businessJson</span><span class="o">;</span>
      <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Business</span><span class="o">&gt;</span> <span class="n">businesses</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Business</span><span class="o">&gt;(</span><span class="n">jsonArray</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
      <span class="c1">// Process each result in json array, decode and convert to business object</span>
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">jsonArray</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
          <span class="k">try</span> <span class="o">{</span>
            <span class="n">businessJson</span> <span class="o">=</span> <span class="n">jsonArray</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
          <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
              <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
              <span class="k">continue</span><span class="o">;</span>
          <span class="o">}</span>

          <span class="n">Business</span> <span class="n">business</span> <span class="o">=</span> <span class="n">Business</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">businessJson</span><span class="o">);</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">business</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">businesses</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">business</span><span class="o">);</span>
          <span class="o">}</span>
      <span class="o">}</span>

      <span class="k">return</span> <span class="n">businesses</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>With that in place, we can now pass an JSONArray of business json data and process that easily into a nice ArrayList<Business> object for easy use in our application with <code>Business.fromJson(myJsonArray)</code>.</p>
<h3 id="putting-it-all-together">Putting It All Together<a class="headerlink" href="#putting-it-all-together" title="Permanent link">&para;</a></h3>
<p>Now, we can return to our Activity where we are executing the network request and use the new Model to get easy access to our Business data. Let's tweak the network request handler in our activity:</p>
<div class="codehilite"><pre><span></span><span class="c1">// Within an activity or fragment</span>
<span class="n">YelpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">YelpClientApp</span><span class="o">.</span><span class="na">getRestClient</span><span class="o">();</span>
<span class="n">client</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="s">&quot;food&quot;</span><span class="o">,</span> <span class="s">&quot;san francisco&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">JsonHttpResponseHandler</span><span class="o">()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="kt">int</span> <span class="n">statusCode</span><span class="o">,</span> <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span><span class="o">,</span> <span class="n">JSONObject</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">JSONArray</span> <span class="n">businessesJson</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">&quot;businesses&quot;</span><span class="o">);</span>
      <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Business</span><span class="o">&gt;</span> <span class="n">businesses</span> <span class="o">=</span> <span class="n">Business</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">businessesJson</span><span class="o">);</span>
      <span class="c1">// Now we have an array of business objects</span>
      <span class="c1">// Might now create an adapter BusinessArrayAdapter&lt;Business&gt; to load the businesses into a list</span>
      <span class="c1">// You might also simply update the data in an existing array and then notify the adapter</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="kt">int</span> <span class="n">statusCode</span><span class="o">,</span> <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span><span class="o">,</span> <span class="n">String</span> <span class="n">res</span><span class="o">,</span> <span class="n">Throwable</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">getBaseContext</span><span class="o">(),</span> <span class="s">&quot;FAIL&quot;</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<p>This approach works very similarly for any simple API data which often is returned in collections whether it be images on Instagram, tweets on Twitter, or auctions on Ebay. </p>
<h3 id="bonus-setting-up-your-adapter">Bonus: Setting Up Your Adapter<a class="headerlink" href="#bonus-setting-up-your-adapter" title="Permanent link">&para;</a></h3>
<p>The next step might be to create an adapter and populate these new model objects into a <code>ListView</code> or <code>RecyclerView</code>.</p>
<div class="codehilite"><pre><span></span><span class="c1">// Within an activity</span>
<span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Business</span><span class="o">&gt;</span> <span class="n">businesses</span><span class="o">;</span>
<span class="n">BusinessRecyclerViewAdapter</span> <span class="n">adapter</span><span class="o">;</span>

<span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
   <span class="c1">// ...</span>
   <span class="c1">// Lookup the recyclerview in activity layout</span>
   <span class="n">RecyclerView</span> <span class="n">rvBusinesses</span> <span class="o">=</span> <span class="o">(</span><span class="n">RecyclerView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(...);</span>
   <span class="c1">// Initialize default business array</span>
   <span class="n">businesses</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Business</span><span class="o">&gt;();</span>
   <span class="c1">// Create adapter passing in the sample user data</span>
   <span class="n">adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BusinessRecyclerViewAdapter</span><span class="o">(</span><span class="n">business</span><span class="o">);</span>
   <span class="n">rvBusinesses</span><span class="o">.</span><span class="na">setAdapter</span><span class="o">(</span><span class="n">adapter</span><span class="o">);</span>
   <span class="c1">// Set layout manager to position the items</span>
   <span class="n">rvBusinesses</span><span class="o">.</span><span class="na">setLayoutManager</span><span class="o">(</span><span class="k">new</span> <span class="n">LinearLayoutManager</span><span class="o">(</span><span class="k">this</span><span class="o">));</span>
<span class="o">}</span>

<span class="c1">// Anywhere in your activity</span>
<span class="n">client</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="s">&quot;food&quot;</span><span class="o">,</span> <span class="s">&quot;san francisco&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">JsonHttpResponseHandler</span><span class="o">()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="kt">int</span> <span class="n">statusCode</span><span class="o">,</span> <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span><span class="o">,</span> <span class="n">JSONObject</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">try</span> <span class="o">{</span>
          <span class="c1">// Get and store decoded array of business results</span>
          <span class="n">JSONArray</span> <span class="n">businessesJson</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getJSONArray</span><span class="o">(</span><span class="s">&quot;businesses&quot;</span><span class="o">);</span>
          <span class="n">businesses</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span> <span class="c1">// clear existing items if needed</span>
          <span class="n">businesses</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">Business</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">businessesJson</span><span class="o">));</span> <span class="c1">// add new items</span>
          <span class="n">adapter</span><span class="o">.</span><span class="na">notifyDataSetChanged</span><span class="o">();</span>
      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
      <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h2 id="leveraging-the-gson-librarys">Leveraging the Gson Librarys<a class="headerlink" href="#leveraging-the-gson-librarys" title="Permanent link">&para;</a></h2>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Google's <a href="https://github.com/google/gson">Gson</a> library provides a powerful framework for converting between JSON strings and Java objects.  This library helps to avoid needing to write boilerplate code to parse JSON responses yourself.   It can be used with any networking library, including the <a href="https://github.com/loopj/android-async-http">Android Async HTTP Client</a> and <a href="http://square.github.io/okhttp/">OkHttp</a>.</p>
<h3 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">&para;</a></h3>
<p>Add the following line to your Gradle configuration:</p>
<div class="codehilite"><pre><span></span><span class="n">dependencies</span> <span class="err">{</span>
  <span class="n">compile</span> <span class="s1">&#39;com.google.code.gson:gson:2.8.0&#39;</span>
<span class="err">}</span>
</pre></div>


<p><a href="http://www.javadoc.io/doc/com.google.code.gson/gson"><img alt="Javadoc" src="https://javadoc-emblem.rhcloud.com/doc/com.google.code.gson/gson/badge.svg" /></a></p>
<h3 id="auto-generating-model-classes">Auto-generating Model Classes<a class="headerlink" href="#auto-generating-model-classes" title="Permanent link">&para;</a></h3>
<p>You can <a href="http://www.jsonschema2pojo.org/">auto-generate much of the model code</a>.</p>
<h3 id="generating-models-manually">Generating Models Manually<a class="headerlink" href="#generating-models-manually" title="Permanent link">&para;</a></h3>
<p>First, we need to know what type of JSON response we will be receiving.    The following example uses the <a href="http://developer.rottentomatoes.com/docs">Rotten Tomatoes API</a> as an example and show how to create Java objects that will be able to parse the latest <a href="http://developer.rottentomatoes.com/docs/read/json/v10/Box_Office_Movies">box office movies</a>.  Based on the JSON response returned for this API call, let's first define how a basic movie representation should look like:</p>
<div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">Movie</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">title</span><span class="o">;</span>
    <span class="kt">int</span> <span class="n">year</span><span class="o">;</span>
    <span class="n">Production</span> <span class="n">production</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTitle</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">title</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getYear</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">year</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Production</span> <span class="nf">getProduction</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">production</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">};</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="kd">class</span> <span class="nc">Production</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">director</span><span class="o">;</span>
    <span class="n">String</span> <span class="n">screenplay</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getDirector</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">director</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getScreenplay</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">screenplay</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">};</span>
</pre></div>


<p>By default, the Gson library will map the fields defined in the class to the JSON keys defined in the response.  For instance, the fields <code>id</code>, <code>title</code>, and <code>year</code> will be mapped automatically.   We do not need any special annotations unless the field names and JSON keys are different.</p>
<p>In this specific case, the Movie class will correspond to each individual movie element and the Production class corresponds to the nested JSON object under movie's production element: </p>
<div class="codehilite"><pre><span></span><span class="err">movies:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="err">id:</span> <span class="nt">&quot;771305050&quot;</span><span class="p">,</span>
    <span class="err">title:</span> <span class="nt">&quot;Straight Outta Compton&quot;</span><span class="p">,</span>
    <span class="err">production:</span> <span class="err">{</span>
      <span class="err">director:</span> <span class="nt">&quot;F. Gary Gray&quot;</span>
      <span class="err">screenplay</span><span class="p">:</span> <span class="s2">&quot;Jonathan Herman&quot;</span>
    <span class="p">},</span>
    <span class="err">year:</span> <span class="mi">2015</span><span class="p">,</span>
  <span class="err">}</span><span class="p">,</span>
  <span class="p">{</span> 
    <span class="err">id:</span> <span class="nt">&quot;771357161&quot;</span><span class="p">,</span>
    <span class="err">title:</span> <span class="nt">&quot;Mission: Impossible Rogue Nation&quot;</span><span class="p">,</span>
    <span class="err">production:</span> <span class="err">{</span>
      <span class="err">director:</span> <span class="nt">&quot;Christopher McQuarrie&quot;</span><span class="p">,</span>
      <span class="err">screenplay:</span> <span class="nt">&quot;Christopher McQuarrie&quot;</span>
    <span class="p">},</span>
    <span class="err">year:</span> <span class="mi">2015</span>
  <span class="err">}</span>
<span class="p">]</span>
</pre></div>


<h3 id="initializing-collections">Initializing collections<a class="headerlink" href="#initializing-collections" title="Permanent link">&para;</a></h3>
<p>Because the API returns a list of movies and not just an individual one, we also need to create a class that will map the <code>movies</code> key to a list of Movie objects.</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoxOfficeMovieResponse</span> <span class="o">{</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">Movie</span><span class="o">&gt;</span> <span class="n">movies</span><span class="o">;</span>

    <span class="c1">// public constructor is necessary for collections</span>
    <span class="kd">public</span> <span class="nf">BoxOfficeMovieResponse</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">movies</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Movie</span><span class="o">&gt;();</span>
    <span class="o">}</span>
</pre></div>


<p>Note below that a public constructor may be needed to initialize the list.  To avoid null pointer exceptions that may result from trying to get back the movie lists, it is highly recommended to initialize these objects in the empty constructor.</p>
<h3 id="parsing-the-response">Parsing the response<a class="headerlink" href="#parsing-the-response" title="Permanent link">&para;</a></h3>
<p>Assuming we have the JSON response in string form, we simply need to use the Gson library and using the  <code>fromJson</code> method.  The first parameter for this method is the JSON response in text form, and the second parameter is the class that should be mapped.  We can create a static method that returns back a <code>BoxOfficeMovieResponse</code> class as shown below:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoxOfficeMovieResponse</span> <span class="o">{</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="o">.</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">BoxOfficeMovieResponse</span> <span class="nf">parseJSON</span><span class="o">(</span><span class="n">String</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GsonBuilder</span><span class="o">().</span><span class="na">create</span><span class="o">();</span>
        <span class="n">BoxOfficeMovieResponse</span> <span class="n">boxOfficeMovieResponse</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">response</span><span class="o">,</span> <span class="n">BoxOfficeMovieResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">boxOfficeMovieResponse</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h3 id="custom-options">Custom options<a class="headerlink" href="#custom-options" title="Permanent link">&para;</a></h3>
<p>The <a href="https://github.com/google/gson/blob/master/gson/src/main/java/com/google/gson/GsonBuilder.java">Gson Builder</a> class enables a variety of different options that help provide more flexibility for the JSON parsing.  Before we instantiate a Gson parser, it's important to know what options are available using the Builder class.  </p>
<div class="codehilite"><pre><span></span><span class="n">GsonBuilder</span> <span class="n">gsonBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GsonBuilder</span><span class="o">();</span>
<span class="c1">// register type adapters here, specify field naming policy, etc.</span>
<span class="n">Gson</span> <span class="n">Gson</span> <span class="o">=</span> <span class="n">gsonBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
</pre></div>


<h4 id="matching-variable-names-to-json-keys">Matching variable names to JSON keys<a class="headerlink" href="#matching-variable-names-to-json-keys" title="Permanent link">&para;</a></h4>
<p>For instance, if our property name matches that of the JSON key, then we do not need to annotate the attributes.  However, if we have a different name we wish to
use, we can simply annotate the declaration with <code>@SerializedName</code>:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoxOfficeMovieResponse</span> <span class="o">{</span>

    <span class="nd">@SerializedName</span><span class="o">(</span><span class="s">&quot;movies&quot;</span><span class="o">)</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Movie</span><span class="o">&gt;</span> <span class="n">movieList</span><span class="o">;</span>
</pre></div>


<h4 id="mapping-enums">Mapping Enums<a class="headerlink" href="#mapping-enums" title="Permanent link">&para;</a></h4>
<p>Enums are not necessarily recommended by Google as described in this <a href="https://developer.android.com/training/articles/memory.html#Overhead">section</a>.  However, if you need to use them for decoding JSON responses, you can map them from string names.   Suppose we had an enum of different colors:</p>
<div class="codehilite"><pre><span></span>    <span class="kd">public</span> <span class="n">ColorTypes</span> <span class="n">colorType</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">enum</span> <span class="n">ColorTypes</span> <span class="o">{</span> <span class="n">RED</span><span class="o">,</span> <span class="n">WHITE</span><span class="o">,</span> <span class="n">BLUE</span> <span class="o">};</span>
</pre></div>


<p>We can annotate these attributes with <code>@SerializedName</code> too:</p>
<div class="codehilite"><pre><span></span>    <span class="nd">@SerializedName</span><span class="o">(</span><span class="s">&quot;color&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">ColorTypes</span> <span class="n">colorType</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">enum</span> <span class="n">ColorTypes</span> <span class="o">{</span>
        <span class="nd">@SerializedName</span><span class="o">(</span><span class="s">&quot;red&quot;</span><span class="o">)</span>
        <span class="n">RED</span><span class="o">,</span>

        <span class="nd">@SerializedName</span><span class="o">(</span><span class="s">&quot;white&quot;</span><span class="o">)</span>
        <span class="n">WHITE</span><span class="o">,</span>

        <span class="nd">@SerializedName</span><span class="o">(</span><span class="s">&quot;blue&quot;</span><span class="o">)</span>
        <span class="n">BLUE</span>
    <span class="o">};</span>
</pre></div>


<h4 id="mapping-camel-case-field-names">Mapping camel case field names<a class="headerlink" href="#mapping-camel-case-field-names" title="Permanent link">&para;</a></h4>
<p>There is also the option to specify how Java field names should map to JSON keys by default.   For instance, the Rotten Tomatoes API response includes an <code>mpaa_rating</code> key in the JSON response.  If we followed Java conventions and named this variable as <code>mpaaRating</code>, then we would have to add a <code>SerializedName</code> decorator to map them correctly:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoxOfficeMovieResponse</span> <span class="o">{</span>

    <span class="nd">@SerializedName</span><span class="o">(</span><span class="s">&quot;mpaa_rating&quot;</span><span class="o">)</span> 
    <span class="n">String</span> <span class="n">mpaaRating</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>


<p>An alternate way, especially if we have many cases similar to this one, is to set the field naming policy in the Gson library.  We can specify that all field names should be converted to lower cases and separated with underscores, which would caused camel case field names to be converted from <code>mpaaRating</code> to <code>mpaa_rating</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">GsonBuilder</span> <span class="n">gsonBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GsonBuilder</span><span class="o">();</span>
<span class="n">gsonBuilder</span><span class="o">.</span><span class="na">setFieldNamingPolicy</span><span class="o">(</span><span class="n">FieldNamingPolicy</span><span class="o">.</span><span class="na">LOWER_CASE_WITH_UNDERSCORES</span><span class="o">);</span>
<span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="n">gsonBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
</pre></div>


<h4 id="mapping-java-date-objects">Mapping Java Date objects<a class="headerlink" href="#mapping-java-date-objects" title="Permanent link">&para;</a></h4>
<p>If we know what date format is used in the response by default, we also specify this date format.  The Rotten Tomatoes API for instance returns a release date for theaters (i.e. "2015-08-14").    If we wanted to map the data directly from a String to a Date object, we could specify the date format:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="n">String</span> <span class="n">DATE_FORMAT</span> <span class="o">=</span> <span class="s">&quot;yyyy-MM-dd&quot;</span><span class="o">;</span>

<span class="n">GsonBuilder</span> <span class="n">gsonBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GsonBuilder</span><span class="o">();</span>
<span class="n">gsonBuilder</span><span class="o">.</span><span class="na">setDateFormat</span><span class="o">(</span><span class="n">DATE_FORMAT</span><span class="o">);</span>
<span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="n">gsonBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
</pre></div>


<p>Similarly, the date format could also be used for parsing standard ISO format time directly into a Date object:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="n">String</span> <span class="n">ISO_FORMAT</span> <span class="o">=</span> <span class="s">&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ssZ&quot;</span><span class="o">;</span>
<span class="n">GsonBuilder</span> <span class="n">gsonBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GsonBuilder</span><span class="o">();</span>
<span class="n">gsonBuilder</span><span class="o">.</span><span class="na">setDateFormat</span><span class="o">(</span><span class="n">ISO_FORMAT</span><span class="o">);</span>
<span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="n">gsonBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
</pre></div>


<p>In the event that Date fields need to mapped depending on the format, you are likely to need to need to use the custom deserializer approach described in the next section.</p>
<h4 id="mapping-custom-java-types">Mapping custom Java types<a class="headerlink" href="#mapping-custom-java-types" title="Permanent link">&para;</a></h4>
<p>By default, the Gson library is not aware of many Java types such as Timestamps.  If we wish to convert these types, we can also create a custom deserializer class that will handle this work for us.</p>
<p>Here is an example of a deserializer that will convert any JSON data that needs to be converted to a  Java field declared as a Timestamp:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">com.google.gson.JsonDeserializationContext</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.gson.JsonDeserializer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.gson.JsonElement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.gson.JsonParseException</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.lang.reflect.Type</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Timestamp</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TimestampDeserializer</span> <span class="kd">implements</span> <span class="n">JsonDeserializer</span><span class="o">&lt;</span><span class="n">Timestamp</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Timestamp</span> <span class="nf">deserialize</span><span class="o">(</span><span class="n">JsonElement</span> <span class="n">json</span><span class="o">,</span> <span class="n">Type</span> <span class="n">typeOfT</span><span class="o">,</span> <span class="n">JsonDeserializationContext</span> <span class="n">context</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="n">JsonParseException</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Timestamp</span><span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">getAsJsonPrimitive</span><span class="o">().</span><span class="na">getAsLong</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Then we simply need to register this new type adapter and enable the Gson library to map any JSON value that needs to be converted into a Java Timestamp.</p>
<div class="codehilite"><pre><span></span><span class="n">GsonBuilder</span> <span class="n">gsonBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GsonBuilder</span><span class="o">();</span>
<span class="n">gsonBuilder</span><span class="o">.</span><span class="na">registerTypeAdapter</span><span class="o">(</span><span class="n">Timestamp</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">TimestampDeserializer</span><span class="o">());</span>
<span class="n">Gson</span> <span class="n">Gson</span> <span class="o">=</span> <span class="n">gsonBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
</pre></div>


<h4 id="mapping-multiple-date-formats">Mapping multiple Date formats<a class="headerlink" href="#mapping-multiple-date-formats" title="Permanent link">&para;</a></h4>
<p>If an API uses different Date formats, then a custom type adapter can be used to make parsing more robust.  To use this approach, a default date policy should not be set by calling the method <code>setDateFormat()</code> as described in the <a href="#mapping-java-date-objects">earlier section</a>.  In addition, a custom deserializer should be registered and created:</p>
<div class="codehilite"><pre><span></span><span class="n">GsonBuilder</span> <span class="n">gsonBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GsonBuilder</span><span class="o">();</span>
<span class="n">gsonBuilder</span><span class="o">.</span><span class="na">registerTypeAdapter</span><span class="o">(</span><span class="n">Date</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">DateDeserializer</span><span class="o">());</span>
<span class="n">Gson</span> <span class="n">Gson</span> <span class="o">=</span> <span class="n">gsonBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
</pre></div>


<p>Leveraging the <code>DateUtils</code> class in the Apache Commons Language library, we can try multiple formats when attempting to parse a value to a Date field:</p>
<p>Add this line to your Gradle file:</p>
<div class="codehilite"><pre><span></span>    <span class="n">compile</span> <span class="s1">&#39;org.apache.commons:commons-lang3:3.3.2&#39;</span>
</pre></div>


<p>We can then use the <a href="https://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/time/DateUtils.html#parseDate">parseDate()</a> method to try multiple date formats:</p>
<div class="codehilite"><pre><span></span><span class="kd">final</span> <span class="kd">class</span> <span class="nc">DateAdapter</span> <span class="kd">implements</span> <span class="n">JsonDeserializer</span><span class="o">&lt;</span><span class="n">Date</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="n">DateAdapter</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Date</span> <span class="nf">convertISO8601ToDate</span><span class="o">(</span><span class="n">String</span> <span class="n">date</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ParseException</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">DateUtils</span><span class="o">.</span><span class="na">parseDate</span><span class="o">(</span><span class="n">date</span><span class="o">,</span> <span class="n">Locale</span><span class="o">.</span><span class="na">getDefault</span><span class="o">(),</span>
                <span class="n">DateFormatUtils</span><span class="o">.</span><span class="na">ISO_DATETIME_FORMAT</span><span class="o">.</span><span class="na">getPattern</span><span class="o">(),</span>
                <span class="n">DateFormatUtils</span><span class="o">.</span><span class="na">ISO_DATETIME_TIME_ZONE_FORMAT</span><span class="o">.</span><span class="na">getPattern</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Date</span> <span class="nf">deserializeToDate</span><span class="o">(</span><span class="n">JsonElement</span> <span class="n">json</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">convertISO8601ToDate</span><span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">getAsString</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">JsonSyntaxException</span><span class="o">(</span><span class="n">json</span><span class="o">.</span><span class="na">getAsString</span><span class="o">(),</span> <span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h4 id="decoding-collections-of-items">Decoding collections of items<a class="headerlink" href="#decoding-collections-of-items" title="Permanent link">&para;</a></h4>
<p>Sometimes our JSON response will be a list of items.  We may also have declared a Java object and want to map the JSON response to a collection of these objects.  </p>
<p>Since the Gson library needs to know what type should be used for decoding a string, we want to pass a type that defines a list of these objects.  Because Java normally doesn't retain generic types because of <a href="https://docs.oracle.com/javase/tutorial/java/generics/erasure.html">type erasure</a>, we need to implement a workaround.   This workaround involves  subclassing <code>TypeToken</code> with a parameterized type and creating an anonymous class:</p>
<div class="codehilite"><pre><span></span><span class="n">Type</span> <span class="n">collectionType</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TypeToken</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Multimedia</span><span class="o">&gt;&gt;(){}.</span><span class="na">getType</span><span class="o">();</span>
<span class="n">GsonBuilder</span> <span class="n">gsonBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GsonBuilder</span><span class="o">();</span>
<span class="n">gsonBuilder</span><span class="o">.</span><span class="na">registerTypeAdapter</span><span class="o">(</span><span class="n">collectionType</span><span class="o">,</span> <span class="k">new</span> <span class="n">MultimediaDeserializer</span><span class="o">());</span>
<span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="n">gsonBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
</pre></div>


<p>If are deserializing the string directly, we can use this custom type using the <code>fromJson()</code> method:</p>
<div class="codehilite"><pre><span></span><span class="n">Type</span> <span class="n">collectionType</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TypeToken</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ImageResult</span><span class="o">&gt;&gt;(){}.</span><span class="na">getType</span><span class="o">();</span>
<span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="n">gsonBuilder</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">ImageResult</span><span class="o">&gt;</span> <span class="n">imageResults</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">jsonObject</span><span class="o">,</span> <span class="n">collectionType</span><span class="o">);</span>
</pre></div>


<p>This approach essentially creates a custom type for a list of objects for the Gson library.  See this Stack Overflow <a href="http://stackoverflow.com/questions/15479724/why-the-typetoken-construction-in-gson-is-so-weird">discussion</a> for more details.</p>
<h3 id="http-client-libraries">HTTP Client Libraries<a class="headerlink" href="#http-client-libraries" title="Permanent link">&para;</a></h3>
<p>We can use any type of HTTP client library with Gson, such as Android Async HTTP Client or Square's OkHttp library.</p>
<h4 id="android-async-http-client">Android Async HTTP Client<a class="headerlink" href="#android-async-http-client" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="n">String</span> <span class="n">apiKey</span> <span class="o">=</span> <span class="s">&quot;YOUR-API-KEY-HERE&quot;</span><span class="o">;</span>

<span class="n">AsyncHttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AsyncHttpClient</span><span class="o">();</span>
 <span class="n">client</span><span class="o">.</span><span class="na">get</span><span class="o">(</span>
         <span class="s">&quot;http://api.rottentomatoes.com/api/public/v1.0/lists/movies/box_office.json?apikey=&quot;</span> <span class="o">+</span> <span class="n">apiKey</span><span class="o">,</span>
         <span class="k">new</span> <span class="n">TextHttpResponseHandler</span><span class="o">()</span> <span class="o">{</span>
             <span class="nd">@Override</span>
             <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="kt">int</span> <span class="n">statusCode</span><span class="o">,</span> <span class="n">Header</span><span class="o">[]</span> <span class="n">headers</span><span class="o">,</span> <span class="n">String</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
                 <span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GsonBuilder</span><span class="o">().</span><span class="na">create</span><span class="o">();</span>
                 <span class="n">Movie</span> <span class="n">movie</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">response</span><span class="o">,</span> <span class="n">Movie</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
             <span class="o">}</span>
         <span class="o">});</span>
<span class="o">}</span>
</pre></div>


<p>Be sure to use the <code>TextHttpResponseHandler</code> rather than <code>JsonHttpResponseHandler</code>. Then you can access the response model to access the parsed data model. </p>
<h4 id="retrofit-2">Retrofit 2<a class="headerlink" href="#retrofit-2" title="Permanent link">&para;</a></h4>
<p>Retrofit uses <a href="http://square.github.io/okhttp/">OkHttp</a> for the underlying networking library and can use the Gson library to decode API-based responses.  To use it, we first need to define an interface file called <code>RottenTomatoesService.java</code>.  To ensure that the API call will be made asynchronously, we also define a callback interface.  Note that if this API call required other parameters, we should always make sure that the <code>Callback</code> declaration is last.</p>
<div class="codehilite"><pre><span></span> <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RottenTomatoesService</span> <span class="o">{</span>
        <span class="nd">@GET</span><span class="o">(</span><span class="s">&quot;/lists/movies/box_office.json&quot;</span><span class="o">)</span>
        <span class="kd">public</span> <span class="n">Call</span><span class="o">&lt;</span><span class="n">BoxOfficeMovieResponse</span><span class="o">&gt;</span> <span class="nf">listMovies</span><span class="o">();</span>
    <span class="o">}</span>
</pre></div>


<p>Then we can make sure to always inject the API key for each request by defining a <code>RequestInterceptor</code>.  class.  In this way, we can avoid needing to have it be defined for each API call.</p>
<div class="codehilite"><pre><span></span><span class="n">String</span> <span class="n">apiKey</span> <span class="o">=</span> <span class="s">&quot;YOUR-API-KEY-HERE&quot;</span><span class="o">;</span>

<span class="n">RequestInterceptor</span> <span class="n">requestInterceptor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RequestInterceptor</span><span class="o">()</span> <span class="o">{</span>
   <span class="nd">@Override</span>
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">intercept</span><span class="o">(</span><span class="n">RequestFacade</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">request</span><span class="o">.</span><span class="na">addQueryParam</span><span class="o">(</span><span class="s">&quot;apikey&quot;</span><span class="o">,</span> <span class="n">apiKey</span><span class="o">);</span>
   <span class="o">}</span>
<span class="o">};</span>
</pre></div>


<p>Next, we need to create a <code>Retrofit</code> instance with a Gson converter and make sure to associate the adapter to this <code>RequestInterceptor</code>:</p>
<div class="codehilite"><pre><span></span><span class="c1">// Add the interceptor to OkHttpClient </span>
<span class="n">OkHttpClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OkHttpClient</span><span class="o">();</span>
<span class="n">client</span><span class="o">.</span><span class="na">interceptors</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">requestInterceptor</span><span class="o">);</span>

<span class="n">Retrofit</span> <span class="n">retrofit</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Retrofit</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
               <span class="o">.</span><span class="na">client</span><span class="o">(</span><span class="n">client</span><span class="o">)</span>
               <span class="o">.</span><span class="na">baseUrl</span><span class="o">(</span><span class="s">&quot;http://api.rottentomatoes.com/api/public/v1.0&quot;</span><span class="o">)</span>
               <span class="o">.</span><span class="na">addConverterFactory</span><span class="o">(</span><span class="n">GsonConverterFactory</span><span class="o">.</span><span class="na">create</span><span class="o">())</span>
               <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></div>


<p>We then simply need to create a service class that will enable us to make API calls:</p>
<div class="codehilite"><pre><span></span><span class="n">RottenTomatoesService</span> <span class="n">service</span> <span class="o">=</span> <span class="n">retrofit</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">RottenTomatoesService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="n">Call</span><span class="o">&lt;</span><span class="n">BoxOfficeMovieResponse</span><span class="o">&gt;</span> <span class="n">call</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="na">listMovies</span><span class="o">();</span>
<span class="n">call</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="k">new</span> <span class="n">Callback</span><span class="o">&lt;</span><span class="n">BoxOfficeMovieResponse</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResponse</span><span class="o">(</span><span class="n">Call</span><span class="o">&lt;</span><span class="n">BoxOfficeMovieresponse</span><span class="o">&gt;</span> <span class="n">call</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// handle response here</span>
                <span class="n">BoxOfficeMovieResponse</span> <span class="n">boxOfficeMovieResponse</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">body</span><span class="o">();</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="n">Throwable</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>

            <span class="o">}</span>
        <span class="o">});</span>
</pre></div>


<h2 id="displaying-images-with-the-fresco-library">Displaying Images with the Fresco Library<a class="headerlink" href="#displaying-images-with-the-fresco-library" title="Permanent link">&para;</a></h2>
<p>[[Fresco|http://frescolib.org]] is a powerful library for displaying images in Android, supporting applications all the way back to GingerBread (API 9). It downloads and caches remote images in a memory efficient manner, using a special region of non-garbage collected memory on Android called <code>ashmem</code>.</p>
<h2 id="terms">Terms<a class="headerlink" href="#terms" title="Permanent link">&para;</a></h2>
<p>When working with <code>Fresco</code>, it's helpful to be familiar with the following terms:
* ImagePipeline - Responsible for getting you the image. It fetches from the network, a local file, a content provider, or a local resource. It keeps a cache of compressed images in local storage, and a second cache of decompressed images in memory.
* Drawee - Drawees deal with rendering images on screen and are made up of 3 parts.
  * DraweeView - The view that shows the image. It extends from <code>ImageView</code>, but only for convenience (see the [[gotchas|Displaying-Images-with-the-Fresco-Library#gotchas]] below for more info on this). Most of the time you'll be using a <code>SimpleDraweeView</code> in your code.
  * DraweeHierarchy - Fresco provides a lot of customization. You can add a placeholderImage, a retryImage, a failureImage, a backgroundImage, etc. The hierarchy is what keeps track of all these drawables and when they should be shown.
  * DraweeController - This is the class responsible for dealing with the image loader. Fresco allows you to customize the image loader if you don't want to use the provided <code>ImagePipeline</code>.</p>
<h2 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<p>First, make sure to add the Fresco dependency in your app/build.gradle file:</p>
<div class="codehilite"><pre><span></span><span class="n">dependencies</span> <span class="err">{</span>
    <span class="n">compile</span> <span class="s1">&#39;com.facebook.fresco:fresco:0.6.1&#39;</span>
<span class="err">}</span>
</pre></div>


<p>Then, in your <code>AndroidManifest.xml</code> make you have the Internet permission if you plan to fetch any images from the network:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span><span class="nt">/&gt;</span>
</pre></div>


<p>Next, make sure to initialize Fresco. Fresco needs to be initialized before you call <code>setContentView()</code> in any <code>Activity</code> that uses <code>Fresco</code>.</p>
<div class="codehilite"><pre><span></span><span class="n">Fresco</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
</pre></div>


<p>And then include it in your layout:</p>
<div class="codehilite"><pre><span></span><span class="o">&lt;</span><span class="n">com</span><span class="o">.</span><span class="na">facebook</span><span class="o">.</span><span class="na">drawee</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">SimpleDraweeView</span>
    <span class="n">android</span><span class="o">:</span><span class="n">id</span><span class="o">=</span><span class="s">&quot;@+id/sdvImage&quot;</span>
    <span class="n">android</span><span class="o">:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">&quot;130dp&quot;</span>
    <span class="n">android</span><span class="o">:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">&quot;130dp&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">placeholderImage</span><span class="o">=</span><span class="s">&quot;@drawable/myPlaceholderImage&quot;</span> <span class="o">/&gt;</span>
</pre></div>


<p><strong>Note:</strong> If you want to use any Fresco defined properties, you'll need to add a custom namespace definition:
<code>xmlns:fresco="http://schemas.android.com/apk/res-auto"</code></p>
<p>Finally, set the actual image URI:</p>
<div class="codehilite"><pre><span></span><span class="n">Uri</span> <span class="n">imageUri</span> <span class="o">=</span> <span class="n">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">&quot;https://i.imgur.com/tGbaZCY.jpg&quot;</span><span class="o">);</span>
<span class="n">SimpleDraweeView</span> <span class="n">draweeView</span> <span class="o">=</span> <span class="o">(</span><span class="n">SimpleDraweeView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sdvImage</span><span class="o">);</span>
<span class="n">draweeView</span><span class="o">.</span><span class="na">setImageURI</span><span class="o">(</span><span class="n">imageUri</span><span class="o">);</span>
</pre></div>


<h2 id="customization">Customization<a class="headerlink" href="#customization" title="Permanent link">&para;</a></h2>
<p>That's all you need to get started using Fresco, but Fresco can do much more than that. Below you can find a majority of the properties that Fresco supports.</p>
<div class="codehilite"><pre><span></span><span class="o">&lt;</span><span class="n">com</span><span class="o">.</span><span class="na">facebook</span><span class="o">.</span><span class="na">drawee</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">SimpleDraweeView</span>
    <span class="n">android</span><span class="o">:</span><span class="n">id</span><span class="o">=</span><span class="s">&quot;@+id/my_image_view&quot;</span>
    <span class="n">android</span><span class="o">:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">&quot;20dp&quot;</span>
    <span class="n">android</span><span class="o">:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">&quot;20dp&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">fadeDuration</span><span class="o">=</span><span class="s">&quot;300&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">actualImageScaleType</span><span class="o">=</span><span class="s">&quot;focusCrop&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">placeholderImage</span><span class="o">=</span><span class="s">&quot;@color/wait_color&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">placeholderImageScaleType</span><span class="o">=</span><span class="s">&quot;fitCenter&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">failureImage</span><span class="o">=</span><span class="s">&quot;@drawable/error&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">failureImageScaleType</span><span class="o">=</span><span class="s">&quot;centerInside&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">retryImage</span><span class="o">=</span><span class="s">&quot;@drawable/retrying&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">retryImageScaleType</span><span class="o">=</span><span class="s">&quot;centerCrop&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">progressBarImage</span><span class="o">=</span><span class="s">&quot;@drawable/progress_bar&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">progressBarImageScaleType</span><span class="o">=</span><span class="s">&quot;centerInside&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">progressBarAutoRotateInterval</span><span class="o">=</span><span class="s">&quot;1000&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">backgroundImage</span><span class="o">=</span><span class="s">&quot;@color/blue&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">overlayImage</span><span class="o">=</span><span class="s">&quot;@drawable/watermark&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">pressedStateOverlayImage</span><span class="o">=</span><span class="s">&quot;@color/red&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">roundAsCircle</span><span class="o">=</span><span class="s">&quot;false&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">roundedCornerRadius</span><span class="o">=</span><span class="s">&quot;1dp&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">roundTopLeft</span><span class="o">=</span><span class="s">&quot;true&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">roundTopRight</span><span class="o">=</span><span class="s">&quot;false&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">roundBottomLeft</span><span class="o">=</span><span class="s">&quot;false&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">roundBottomRight</span><span class="o">=</span><span class="s">&quot;true&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">roundWithOverlayColor</span><span class="o">=</span><span class="s">&quot;@color/corner_color&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">roundingBorderWidth</span><span class="o">=</span><span class="s">&quot;2dp&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">roundingBorderColor</span><span class="o">=</span><span class="s">&quot;@color/border_color&quot;</span> <span class="o">/&gt;</span>
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DraweeView doesn't support specifying <code>wrap_content</code> for the <code>layout_width</code> or <code>layout_height</code> attributes. This is to prevent situations where your placeholder image might be a different size than your actual image, forcing Android to do another layout pass once the actual image comes in.</p>
</div>
<p>There is only one case where DraweeView supports <code>wrap_content</code> and this is for the helpful <code>viewAspectRatio</code> property, allowing you to configure an aspect ratio.</p>
<div class="codehilite"><pre><span></span><span class="o">&lt;</span><span class="n">com</span><span class="o">.</span><span class="na">facebook</span><span class="o">.</span><span class="na">drawee</span><span class="o">.</span><span class="na">view</span><span class="o">.</span><span class="na">SimpleDraweeView</span>
    <span class="n">android</span><span class="o">:</span><span class="n">id</span><span class="o">=</span><span class="s">&quot;@+id/my_image_view&quot;</span>
    <span class="n">android</span><span class="o">:</span><span class="n">layout_width</span><span class="o">=</span><span class="s">&quot;20dp&quot;</span>
    <span class="n">android</span><span class="o">:</span><span class="n">layout_height</span><span class="o">=</span><span class="s">&quot;wrap_content&quot;</span>
    <span class="n">fresco</span><span class="o">:</span><span class="n">viewAspectRatio</span><span class="o">=</span><span class="s">&quot;1.33&quot;</span> <span class="o">/&gt;</span>
</pre></div>


<p>You can read more about Fresco's capabilities in the [[Fresco docs|http://frescolib.org/docs/index.html]].</p>
<h2 id="getting-the-underlying-bitmap-out-of-a-draweeview">Getting the underlying Bitmap out of a DraweeView<a class="headerlink" href="#getting-the-underlying-bitmap-out-of-a-draweeview" title="Permanent link">&para;</a></h2>
<p>Getting the bitmap out of a SimpleDraweeView requires working with the <code>ImagePipeline</code> instead of the <code>DraweeView</code> itself. The code below shows how to get a bitmap out of the <code>ImagePipeline</code>, which comes in useful when you want to share an image with another user.</p>
<div class="codehilite"><pre><span></span><span class="n">ImagePipeline</span> <span class="n">imagePipeline</span> <span class="o">=</span> <span class="n">Fresco</span><span class="o">.</span><span class="na">getImagePipeline</span><span class="o">();</span>

<span class="n">ImageRequest</span> <span class="n">imageRequest</span> <span class="o">=</span> <span class="n">ImageRequestBuilder</span>
       <span class="o">.</span><span class="na">newBuilderWithSource</span><span class="o">(</span><span class="n">imageUri</span><span class="o">)</span>
       <span class="o">.</span><span class="na">setRequestPriority</span><span class="o">(</span><span class="n">Priority</span><span class="o">.</span><span class="na">HIGH</span><span class="o">)</span>
       <span class="o">.</span><span class="na">setLowestPermittedRequestLevel</span><span class="o">(</span><span class="n">ImageRequest</span><span class="o">.</span><span class="na">RequestLevel</span><span class="o">.</span><span class="na">FULL_FETCH</span><span class="o">)</span>
       <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">DataSource</span><span class="o">&lt;</span><span class="n">CloseableReference</span><span class="o">&lt;</span><span class="n">CloseableImage</span><span class="o">&gt;&gt;</span> <span class="n">dataSource</span> <span class="o">=</span>
       <span class="n">imagePipeline</span><span class="o">.</span><span class="na">fetchDecodedImage</span><span class="o">(</span><span class="n">imageRequest</span><span class="o">,</span> <span class="n">mContext</span><span class="o">);</span>

<span class="k">try</span> <span class="o">{</span>
   <span class="n">dataSource</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="k">new</span> <span class="n">BaseBitmapDataSubscriber</span><span class="o">()</span> <span class="o">{</span>
       <span class="nd">@Override</span>
       <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onNewResultImpl</span><span class="o">(</span><span class="nd">@Nullable</span> <span class="n">Bitmap</span> <span class="n">bitmap</span><span class="o">)</span> <span class="o">{</span>
           <span class="k">if</span> <span class="o">(</span><span class="n">bitmap</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
               <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&quot;Bitmap data source returned success, but bitmap null.&quot;</span><span class="o">);</span>
               <span class="k">return</span><span class="o">;</span>
           <span class="o">}</span>
           <span class="c1">// The bitmap provided to this method is only guaranteed to be around</span>
           <span class="c1">// for the lifespan of this method. The image pipeline frees the</span>
           <span class="c1">// bitmap&#39;s memory after this method has completed.</span>
           <span class="c1">//</span>
           <span class="c1">// This is fine when passing the bitmap to a system process as</span>
           <span class="c1">// Android automatically creates a copy.</span>
           <span class="c1">//</span>
           <span class="c1">// If you need to keep the bitmap around, look into using a</span>
           <span class="c1">// BaseDataSubscriber instead of a BaseBitmapDataSubscriber.</span>
       <span class="o">}</span>

       <span class="nd">@Override</span>
       <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailureImpl</span><span class="o">(</span><span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">)</span> <span class="o">{</span>
           <span class="c1">// No cleanup required here</span>
       <span class="o">}</span>
   <span class="o">},</span> <span class="n">CallerThreadExecutor</span><span class="o">.</span><span class="na">getInstance</span><span class="o">());</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
   <span class="k">if</span> <span class="o">(</span><span class="n">dataSource</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">dataSource</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
   <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h2 id="sharing-an-image-from-fresco">Sharing an Image from Fresco<a class="headerlink" href="#sharing-an-image-from-fresco" title="Permanent link">&para;</a></h2>
<p>Make sure to add the following permissions to your <code>AndroidManifest.xml</code>:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span> <span class="nt">/&gt;</span>
</pre></div>


<p><strong>Note:</strong> The permissions model has changed starting in Marshmallow. If your <code>targetSdkVersion</code> &gt;= <code>23</code> and you are running on a Marshmallow (or later) device, you may need to [[enable runtime permissions|Managing-Runtime-Permissions-with-PermissionsDispatcher]]. You can also read more about the [[runtime permissions changes here|Understanding-App-Permissions#runtime-permissions]].</p>
<p>To share an image from Fresco, you first need to <a href="#getting-the-underlying-bitmap-out-of-a-draweeview">get the bitmap</a> from the <code>ImagePipeline</code>. Then you can use the following code to save the bitmap to the Media image store and pass the path into a share intent.</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">shareBitmap</span><span class="o">(</span><span class="n">Bitmap</span> <span class="n">bitmap</span><span class="o">)</span> <span class="o">{</span>
   <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">MediaStore</span><span class="o">.</span><span class="na">Images</span><span class="o">.</span><span class="na">Media</span><span class="o">.</span><span class="na">insertImage</span><span class="o">(</span><span class="n">mContext</span><span class="o">.</span><span class="na">getContentResolver</span><span class="o">(),</span>
                                                     <span class="n">bitmap</span><span class="o">,</span> <span class="s">&quot;Image Description&quot;</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
   <span class="n">Uri</span> <span class="n">bmpUri</span> <span class="o">=</span> <span class="n">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
   <span class="n">Intent</span> <span class="n">shareIntent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">ACTION_SEND</span><span class="o">);</span>
   <span class="n">shareIntent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">EXTRA_STREAM</span><span class="o">,</span> <span class="n">bmpUri</span><span class="o">);</span>
   <span class="n">shareIntent</span><span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="s">&quot;image/*&quot;</span><span class="o">);</span>

   <span class="n">mContext</span><span class="o">.</span><span class="na">startActivity</span><span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">createChooser</span><span class="o">(</span><span class="n">shareIntent</span><span class="o">,</span> <span class="s">&quot;Share Image&quot;</span><span class="o">));</span>
<span class="o">}</span>
</pre></div>


<p>See the [[guide on sharing|Sharing-Content-with-Intents]] if you want to read more about the different sharing options.</p>
<h2 id="gotchas">Gotchas<a class="headerlink" href="#gotchas" title="Permanent link">&para;</a></h2>
<p>Make sure you review the list of [[gotchas|http://frescolib.org/docs/gotchas.html]] in the Fresco documentation. The most notable one is to avoid <code>ImageView</code> methods and properties when dealing with a <code>DraweeView</code> (even though <code>DraweeView</code> extends <code>ImageView</code>).
*  Don't call ImageView methods <code>setImageBitmap</code>, <code>setImageDrawable</code>, etc as this will wipe out the <code>DraweeHierarchy</code>
*  Don't set <code>ImageView</code> properties like <code>scaleType</code>, <code>src</code>, etc. Instead use the DraweeView counterparts for these properties.</p>
<h2 id="configuring-a-parse-server">Configuring a Parse Server<a class="headerlink" href="#configuring-a-parse-server" title="Permanent link">&para;</a></h2>
<p>Parse provides a cloud-based backend service to build data-driven mobile apps quickly.  Facebook, which acquired the company more than 3 years ago, announced that the service would be shutting down on <strong>January 28, 2017</strong>.   An <a href="https://github.com/ParsePlatform/parse-server">open source version</a> enables developers to continue using Parse to build apps.</p>
<p>While there are many
<a href="https://github.com/relatedcode/ParseAlternatives">alternate options to Parse</a>, most of them lack either the functionality, documentation, or sample code to enable quick prototyping.  For this reason, the open source Parse version is a good option to use with minimal deployment/configuration needed.</p>
<h4 id="differences-with-open-source-parse">Differences with Open Source Parse<a class="headerlink" href="#differences-with-open-source-parse" title="Permanent link">&para;</a></h4>
<p>You can review this <a href="https://github.com/ParsePlatform/parse-server/wiki">Wiki</a> to understand the current development progress of this app.  There are a few notable differences in the open source version:</p>
<ul>
<li>
<p><strong>Authentication</strong>: By default, only an application ID is needed to authenticate with open source Parse.  The <a href="https://github.com/ParsePlatform/parse-server-example/blob/master/index.js#L13-L18">base configuration</a> that comes with the one-click deploy options does not require authenticating with any other types of keys.   Therefore, specifying client keys on Android or iOS is not needed.</p>
</li>
<li>
<p><strong>Push notifications</strong>: Because of the implicit <a href="https://github.com/ParsePlatform/parse-server/issues/396#issuecomment-183792657">security issues</a> with allowing push notifications to be sent through Android or iOS directly to other devices, this feature is disabled. Note that for open source Parse, you must implement pre-defined code written in JavaScript that can be called by the clients to execute, otherwise known as <a href="http://blog.parse.com/announcements/pushing-from-the-javascript-sdk-and-cloud-code/">Parse Cloud</a>.</p>
</li>
<li>
<p><strong>Single app aware</strong>: The current version only supports single app instances.  There is ongoing work to make this version multi-app aware.  However, if you intend to run many different apps with different datastores, you currently would need to instantiate separate instances.</p>
</li>
<li>
<p><strong>File upload limitations</strong>: The backend for open source is backed by MongoDB, and the default storage layer relies on Mongo's GridFS layer.  The current limit is set for 20 MB but if you depend on storing large files, you should really configure the server to use Amazon's Simple Storage Service (S3).</p>
</li>
</ul>
<p>Many of the options need to be configured by tweaking your own configuration.  You may wish to fork the <a href="https://github.com/ParsePlatform/parse-server-example/">code</a> that helps instantiate a Parse server and change them based on your own needs.  The guide below includes instructions on [[how to add push notifications|Configuring-a-Parse-Server#enabling push notifications]] and [[storing files with Parse|Configuring-a-Parse-Server#storing files with parse]].</p>
<h3 id="setting-a-new-parse-server">Setting a new Parse Server<a class="headerlink" href="#setting-a-new-parse-server" title="Permanent link">&para;</a></h3>
<p>The steps described this guide walk through most of the process of setting an open source version with Parse.  There are obviously many other hosting options, but the one-click deploys made available with Heroku as discussed in <a href="https://github.com/ParsePlatform/parse-server-example">this guide</a> are the simplest.   In both cases, you are likely to need a credit card attached to your account to activate.</p>
<h4 id="signing-up-with-heroku">Signing up with Heroku<a class="headerlink" href="#signing-up-with-heroku" title="Permanent link">&para;</a></h4>
<p>Use Heroku if you have little or no experience with setting up web sites. Heroku allows you to manage changes to deploy easily by specifying a GitHub repository to use.  In addition, it comes with a UI data viewer from mLab.</p>
<ol>
<li>
<p>Sign Up / Sign In at <a href="https://www.heroku.com">Heroku</a></p>
</li>
<li>
<p>Click on the button below to create a Parse App</p>
<p><a href="https://dashboard.heroku.com/new?button-url=https%3A%2F%2Fgithub.com%2FParsePlatform%2Fparse-server-example&template=https%3A%2F%2Fgithub.com%2FParsePlatform%2Fparse-server-example"><img src="https://camo.githubusercontent.com/c0824806f5221ebb7d25e559568582dd39dd1170/68747470733a2f2f7777772e6865726f6b7563646e2e636f6d2f6465706c6f792f627574746f6e2e706e67" alt="Deploy" data-canonical-src="https://www.herokucdn.com/deploy/button.png" style="max-width:100%;"></a></p>
</li>
<li>
<p>Make sure to enter an App Name.  Scroll to the bottom of the page.</p>
<p><img src="http://imgur.com/0JcJrn5.png"></p>
</li>
<li>
<p>Make sure to change the config values.
      <img src="http://imgur.com/vQV0X0S.png"/></p>
<ul>
<li>Leave <code>PARSE_MOUNT</code> to be <code>/parse</code>.  It does not need to be changed.</li>
<li>Set <code>APP_ID</code> for the app identifier.  If you do not set one, the default is set as <code>myAppId</code>.  You will need this info for the Client SDK setup.</li>
<li>Set <code>MASTER_KEY</code> to be the master key used to read/write all data.  <strong>Note</strong>: in hosted Parse, client keys are not used by default.</li>
<li>Set <code>SERVER_URL</code> to be <code>http://yourappname.herokuapp.com/parse</code>.  Assuming you have left <code>PARSE_MOUNT</code> to be /parse, this will enable the use of Parse Cloud to work correctly.</li>
<li>If you intend to use Parse's Facebook authentication, set <code>FACEBOOK_APP_ID</code> to be the <a href="https://developers.facebook.com/apps">FB application ID</a>.</li>
<li>If you intend to setup push notifications, there are additional environment variables such as <code>GCM_SENDER_KEY</code> and <code>GCM_API_KEY</code>that will need to be configured.  See [[this section|Configuring-a-Parse-Server#enabling-push-notifications]] for the required steps.</li>
</ul>
</li>
<li>
<p>Deploy the Heroku app.  The app should be hosted at <code>https://&lt;app name&gt;.herokuapp.com</code> where <code>&lt;app name&gt;</code> represents your App Name that you provided (or if one was assigned to you if you left this field blank).</p>
</li>
</ol>
<p>If you ever need to change these values later, you can go to (<code>https://dashboard.heroku.com/apps/&lt;app name&gt;/settings</code>). Check out <a href="https://devcenter.heroku.com/articles/deploying-a-parse-server-to-heroku">this guide</a> for a more detailed set of steps for deploying Parse to Heroku.</p>
<p>Now, we can [[test our deployment|Configuring-a-Parse-Server#testing-deployment]] to verify that the Parse deployment is working as expected!</p>
<h3 id="testing-deployment">Testing Deployment<a class="headerlink" href="#testing-deployment" title="Permanent link">&para;</a></h3>
<p>After deployment, try to connect to the site.  You should see <code>I dream of being a website. Please star the parse-server repo on GitHub!</code> if the site loaded correctly.   If you try to connect to the <code>/parse</code> endpoint, you should see <code>{error: "unauthorized"}</code>.  If both tests pass, the basic configuration is successful.</p>
<p>Next, make sure you can create Parse objects.  You do not need a client Key to write new data:</p>
<div class="codehilite"><pre><span></span>curl -X POST -H <span class="s2">&quot;X-Parse-Application-Id: myAppId&quot;</span> <span class="se">\</span>
-H <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="se">\</span>
-d <span class="s1">&#39;{&quot;score&quot;:1337,&quot;playerName&quot;:&quot;Sean Plott&quot;,&quot;cheatMode&quot;:false}&#39;</span> <span class="se">\</span>
https://yourappname.herokuapp.com/parse/classes/GameScore
</pre></div>


<p>Be sure to <strong>replace the values</strong> for <code>myAppId</code> and the server URL. If you see <code>Cannot POST</code> error then be sure both the <code>X-Parse-Application-Id</code> and the URL are correct for your application. To read data back, you will need to specify your master key as well:</p>
<div class="codehilite"><pre><span></span>curl -X GET -H <span class="s2">&quot;X-Parse-Application-Id: myAppId&quot;</span> -H <span class="s2">&quot;X-Parse-Master-Key: abc&quot;</span>  <span class="se">\</span>
https://yourappname.herokuapp.com/parse/classes/GameScore
</pre></div>


<p>Be sure to <strong>replace the values</strong> for <code>myAppId</code> and the server URL. If these commands work as expected, then your Parse instance is now setup and ready to be used!</p>
<h3 id="browsing-parse-data">Browsing Parse Data<a class="headerlink" href="#browsing-parse-data" title="Permanent link">&para;</a></h3>
<p>There are several options that allow you to view the data.  First, you can use the <code>mLab</code> viewer to examine the store data.  Second, you can setup the open source verson of the Parse Dashboard, which gives you a similar UI used in hosted Parse.  Finally, you can use Robomongo.</p>
<h4 id="mlab">mLab<a class="headerlink" href="#mlab" title="Permanent link">&para;</a></h4>
<p>The hosted Parse instance deployed uses <a href="https://mlab.com/">mLab</a> (previously called MongoLab) to store all of your data. mLab is a hosted version of <a href="https://www.mongodb.org/">MongoDB</a> which is a document-store which uses JSON to store your data.</p>
<p>If you are using Heroku, you can verify whether the objects were created by clicking on the MongoDB instance in the Heroku panel:</p>
<p><img src="http://imgur.com/bbj2e9N.png"/></p>
<p><img src="http://imgur.com/snPqYkz.png"/></p>
<h4 id="parse-dashboard">Parse Dashboard<a class="headerlink" href="#parse-dashboard" title="Permanent link">&para;</a></h4>
<p>You can also install Parse's open source dashboard locally. Download <a href="https://nodejs.org/en/download/">NodeJS v4.3</a> or higher.  Make sure you have at least Parse server v2.1.3 or higher (later versions include a <code>/parse/serverInfo</code> that is needed).</p>
<div class="codehilite"><pre><span></span>npm install -g parse-dashboard
parse-dashboard --appId myAppId --masterKey myMasterKey --serverURL <span class="s2">&quot;https://yourapp.herokuapp.com/parse&quot;</span>
</pre></div>


<p>Connect to your dashboard at <code>http://localhost:4040/apps</code>. Assuming you have specified the correct application ID, master Key, and server URL, as well as installed a Parse open source version v2.1.3 or higher, you should see the app appear correctly:</p>
<p><img src="http://imgur.com/Z0Rz5Xs.png"/></p>
<h4 id="robomongo">Robomongo<a class="headerlink" href="#robomongo" title="Permanent link">&para;</a></h4>
<p>You can also setup <a href="https://robomongo.org/download">Robomongo</a> to connect to your remote mongo database hosted on Heroku to get a better data browser and dashboard for your app.</p>
<p><a href="https://robomongo.org/download"><img src="http://i.imgur.com/9Qtt6Xs.png" width="450" /></a></p>
<p>To access mLab databases using Robomongo, be sure to go the MongoDB instance in the Heroku panel as shown above. Look for the following URL: <code>mongodb://&lt;dbuser&gt;:&lt;dbpassword&gt;@ds017212.mlab.com:11218/heroku_2flx41aa</code>. Use that to identify the login credentials:</p>
<div class="codehilite"><pre><span></span><span class="n">address</span><span class="o">:</span> <span class="n">ds017212</span><span class="o">.</span><span class="na">mlab</span><span class="o">.</span><span class="na">com</span>
<span class="n">port</span><span class="o">:</span> <span class="mi">11218</span>
<span class="n">db</span><span class="o">:</span> <span class="n">heroku_2flx41aa</span>
<span class="n">user</span><span class="o">:</span> <span class="n">dbuser</span>
<span class="n">password</span><span class="o">:</span> <span class="n">dbpassword</span>
</pre></div>


<p>Note that the <strong>user and password</strong> provided are for a database user you configure and are <strong>not your mLab login credentials</strong>. Using that cross-platform app to easily access and modify the data for your Parse MongoDB data.</p>
<h3 id="adding-support-for-live-queries">Adding Support for Live Queries<a class="headerlink" href="#adding-support-for-live-queries" title="Permanent link">&para;</a></h3>
<p>One of the newer features of Parse is that you can monitor for live changes made to objects in your database  To get started, make sure you have defined the ParseObjects that you want in your NodeJS server.  Make sure to define a list of all the objects by declaring it in the <code>liveQuery</code> and <code>classNames listing</code>:</p>
<div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParseServer</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="c1">// Make sure to define liveQuery AND classNames</span>
  <span class="nx">liveQuery</span><span class="o">:</span> <span class="p">{</span>
    <span class="c1">// define your ParseObject names here</span>
    <span class="nx">classNames</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">,</span> <span class="s1">&#39;Comment&#39;</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>


<p>See <a href="http://parseplatform.org/docs/parse-server/guide/#live-queries">this guide</a> for more details.  Parse Live Queries rely on the websocket protocol, which creates a bidirectional channel between the client and server and periodically exchange ping/pong frames to validate the connection is still alive.</p>
<p>Websocket URLs are usually prefixed with ws:// or wss:// (secure) URLs.  Heroku instances already provide websocket support, but if you are deploying to a different server (Amazon), you may need to make sure that TCP port 80 or TCP port 443 are available.</p>
<h3 id="enabling-client-sdk-integration">Enabling Client SDK integration<a class="headerlink" href="#enabling-client-sdk-integration" title="Permanent link">&para;</a></h3>
<p>Follow the [[setup guide|Building-Data-driven-Apps-with-Parse#setup]].
Make sure you have the latest Parse-Android SDK <img src="https://camo.githubusercontent.com/4da68f9e3fc719ae9f0198d780c611d61bb8843b/68747470733a2f2f6d6176656e2d6261646765732e6865726f6b756170702e636f6d2f6d6176656e2d63656e7472616c2f636f6d2e70617273652f70617273652d616e64726f69642f62616467652e7376673f7374796c653d666c6174" alt="Maven Central" data-canonical-src="https://maven-badges.herokuapp.com/maven-central/com.parse/parse-android/badge.svg?style=flat" style="max-width:100%;">
 in your <code>app/build.gradle</code> file.</p>
<h3 id="troubleshooting-parse-server">Troubleshooting Parse Server<a class="headerlink" href="#troubleshooting-parse-server" title="Permanent link">&para;</a></h3>
<ul>
<li>If you see <code>Application Error</code> or <code>An error occurred in the application and your page could not be served. Please try again in a few moments.</code>, double-check that you set a <code>MASTER_KEY</code> in the environment settings for that app.</li>
</ul>
<p><img src="http://imgur.com/uMYwPmS.png"></p>
<ul>
<li>If you are using Heroku, download the Heroku Toolbelt app <a href="https://toolbelt.heroku.com/">here</a> to help view system logs.</li>
</ul>
<p><img src="http://imgur.com/Ch0mZOK.png"/></p>
<p>First, you must login with your Heroku login and password:</p>
<p><code>bash
  heroku login</code></p>
<p>You can then view the system logs by specifying the app name:
   <code>bash
   heroku logs --app &lt;app name&gt;</code></p>
<p>The logs should show the response from any types of network requests made to the site.  Check the <code>status</code> code.
   <code>2016-02-07T08:28:14.292475+00:00 heroku[router]: at=info method=POST path="/parse/classes/Message" host=parse-testing-port.herokuapp.com request_id=804c2533-ac56-4107-ad05-962d287537e9 fwd="101.12.34.12" dyno=web.1 connect=1ms service=2ms status=404 bytes=179</code></p>
<ul>
<li>
<p>If you are seeing <code>Master key is invalid, you should only use master key to send push</code>, chances are you are trying to send Push notifications without enable client push.  On hosted parse there is an outstanding <a href="https://github.com/ParsePlatform/parse-server/issues/396">issue</a> that must be resolved to start supporting it.</p>
</li>
<li>
<p>If you see the exception <code>Error Loading Messagescom.parse.ParseException: java.lang.IllegalArgumentException: value == null</code>, try setting the <code>clientKey</code> to a blank string such as <code>Parse.initialize(...).applicationId(...).clientKey("")</code> rather than <code>null</code>. Review <a href="https://github.com/ParsePlatform/Parse-SDK-Android/issues/392">this issue</a> and <a href="https://github.com/ParsePlatform/Parse-SDK-Android/issues/201">this issue</a> for further details.</p>
</li>
<li>
<p>You can also use Facebook's <a href="http://facebook.github.io/stetho/">Stetho</a> interceptor to watch network logs with Chrome:</p>
<p><code>gradle
dependencies {
  compile 'com.facebook.stetho:stetho:1.3.0'
}</code></p>
</li>
</ul>
<p>And add this network interceptor as well:</p>
<p>```java
     Stetho.initializeWithDefaults(this); // init Stetho before Parse</p>
<div class="codehilite"><pre><span></span> <span class="n">Parse</span><span class="p">.</span><span class="k">initialize</span><span class="p">(</span><span class="k">new</span> <span class="n">Parse</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="n">Builder</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
   <span class="p">.</span><span class="n">addNetworkInterceptor</span><span class="p">(</span><span class="k">new</span> <span class="n">ParseStethoInterceptor</span><span class="p">())</span>
</pre></div>


<p>```</p>
<ul>
<li>If you wish to troubleshoot your Parse JavaScript code is to run the Parse server locally (see <a href="https://github.com/ParsePlatform/parse-server-example#for-local-development">instructions</a>).  You should also install node-inspector for Node.js, which allows you to use Chrome or Safari to step through the code yourself:</li>
</ul>
<p><code>bash
   npm install node-inspector
   node --debug index.js
   node_modules/.bin/node-inspector</code></p>
<p>Open up http://127.0.0.1:8080/?port=5858 locally.   You can use the Chrome debugging tools to set breakpoints in the JavaScript code.</p>
<p>Point your Android client to this server::</p>
<p><code>java
   Parse.initialize(new Parse.Configuration.Builder(this)
        .applicationId("myAppId")
        .server("http://192.168.3.116:1337/parse/")  // lookup your IP address of your machine</code></p>
<ul>
<li><strong>Running into issues with mLab and MongoDB or <code>MONGODB_URL</code>?</strong> Check the <a href="https://gist.github.com/nesquena/7786c5a876e335737fb28d037400fd40">more detailed instructions here</a> for getting the <code>MONGODB_URL</code> setup properly. </li>
</ul>
<h3 id="enabling-push-notifications">Enabling Push Notifications<a class="headerlink" href="#enabling-push-notifications" title="Permanent link">&para;</a></h3>
<p>See [[this guide|Push-Notifications-Setup-for-Parse]] for more details about how to setup both the Parse open source version and the Parse Android SDK Client.</p>
<h3 id="storing-files-with-parse">Storing Files with Parse<a class="headerlink" href="#storing-files-with-parse" title="Permanent link">&para;</a></h3>
<p>You can continue to save large files to your Parse backend using <code>ParseFile</code> without any major changes:</p>
<div class="codehilite"><pre><span></span><span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="s">&quot;Working at Parse is great!&quot;</span><span class="o">.</span><span class="na">getBytes</span><span class="o">();</span>
<span class="n">ParseFile</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ParseFile</span><span class="o">(</span><span class="s">&quot;resume.txt&quot;</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
<span class="n">file</span><span class="o">.</span><span class="na">saveInBackground</span><span class="o">();</span>
</pre></div>


<p>By default, the open source version of Parse relies on the MongoDB <a href="https://mongodb.github.io/node-mongodb-native/api-generated/gridstore.html">GridStore</a> adapter to store large files.  There is an alternate option to leverage Amazon's Simple Storage Service (S3) but still should be considered experimental.</p>
<h4 id="using-amazon-s3">Using Amazon S3<a class="headerlink" href="#using-amazon-s3" title="Permanent link">&para;</a></h4>
<p>If you wish to store the files in an Amazon S3 bucket, you will need to make sure to setup your Parse server to use the S3 adapter instead of the default GridStore adapter.  See <a href="https://github.com/ParsePlatform/parse-server/wiki/Configuring-File-Adapters#configuring-s3adapter">this Wiki</a> for how to configure your setup.  The steps basically include:</p>
<ol>
<li>Modify the Parse server to use the S3 adapter.  See <a href="https://github.com/codepath/parse-server-example/blob/master/index.js#L20-L29">these changes</a> as an example.</li>
<li>Create an Amazon S3 bucket.</li>
<li>Create an Amazon user with access to this S3 bucket.</li>
<li>Generate an authorized key/secret pair to write to this bucket.</li>
<li>Set the environment variables:<ul>
<li>Set <code>S3_ENABLE</code> to be 1.</li>
<li>Set <code>AWS_BUCKET_NAME</code> to be the AWS bucket name.</li>
<li>Set <code>AWS_ACCESS_KEY</code> and <code>AWS_SECRET_ACCESS_KEY</code> to be the user that has access to read/write to this S3 bucket.</li>
</ul>
</li>
</ol>
<p>When testing, try to write a file and use the Amazon S3 console to see if the files were created in the right place.</p>
<h2 id="building-data-driven-apps-with-parse">Building Data driven Apps with Parse<a class="headerlink" href="#building-data-driven-apps-with-parse" title="Permanent link">&para;</a></h2>
<p><a href="http://parseplatform.org/">Parse</a> is an open-source platform that provides one of the easiest ways to get a database and RESTful API up and running. If you want to build a mobile app and don't want to code the back-end by hand, give Parse a try.</p>
<p><img src="http://i.imgur.com/Xo47jSc.gif" alt="Parse" width="750" /></p>
<h3 id="parse-on-heroku">Parse on Heroku<a class="headerlink" href="#parse-on-heroku" title="Permanent link">&para;</a></h3>
<p>We can deploy our own Parse data store and push notifications systems to <a href="https://www.heroku.com/">Heroku</a> leveraging the <a href="https://github.com/ParsePlatform/parse-server-example">server open-sourced by Parse</a>. Parse is built on top of the MongoDB database which can be added to Heroku using MongoLab.</p>
<p>To get started setting up our own Parse backend, check out our [[configuring a Parse Server]] guide. Once the Parse server is configured, we can <a href="http://guides.codepath.com/android/Configuring-a-Parse-Server#enabling-client-sdk-integration">initialize Parse within our Android app</a> pointing the client to our self-hosted URL. After that, the functions demonstrated in this guide work the same as they did before.</p>
<h3 id="alternatives-to-parse">Alternatives to Parse<a class="headerlink" href="#alternatives-to-parse" title="Permanent link">&para;</a></h3>
<p>A comprehensive list of alternatives can be <a href="https://github.com/relatedcode/ParseAlternatives">reviewed here</a>. One of the primary alternatives is Google's <a href="http://firebase.google.com">Firebase</a>, which provides a hosted solution for analytics, crash reporting, and a realtime JSON database.  One major difference is that Parse still provides many powerful constructs for querying data, whereas Firebase requires you to perform this querying based on child/parent relations.  See <a href="https://firebase.google.com/support/guides/parse-android">this guide</a> for more information to porting Parse applications to Firebase.</p>
<h2 id="what-is-parse">What is Parse?<a class="headerlink" href="#what-is-parse" title="Permanent link">&para;</a></h2>
<p>Parse is an open-source Android SDK and back-end solution that enables developers to build mobile apps with shared data quickly and without writing any back-end code or custom APIs.</p>
<p><img src="http://i.imgur.com/LylIn7w.png" /></p>
<p>Parse is a Node.js application which is deployed onto a host such as Heroku (or AWS) and then creates an automatic API for user authentication and storing data to a MongoDB document store. Parse has the following features included by combining the mobile SDK and back-end service:</p>
<ul>
<li>User registration and authentication</li>
<li>Connecting user with Facebook to create a user account.</li>
<li>Creating, querying, modifying and deleting arbitrary data models</li>
<li>Makes sending push notifications easier</li>
<li>Uploading files to a server for access across clients</li>
</ul>
<p>In short, Parse makes building mobile app ideas much easier!</p>
<h2 id="setup_1">Setup<a class="headerlink" href="#setup_1" title="Permanent link">&para;</a></h2>
<p>Setting up Parse starts with [[deploying your own Parse instance|Configuring-a-Parse-Server#setting-a-new-parse-server]] to Heroku or another app hosting provider.</p>
<p>Open the <code>app/build.gradle</code> in your project and add the following dependencies:</p>
<div class="codehilite"><pre><span></span><span class="nv">dependencies</span> {
    <span class="nv">compile</span> <span class="s1">&#39;</span><span class="s">com.parse.bolts:bolts-android:1.4.0</span><span class="s1">&#39;</span>
    <span class="nv">compile</span> <span class="s1">&#39;</span><span class="s">com.parse:parse-android:1.15.1</span><span class="s1">&#39;</span>
    <span class="nv">compile</span> <span class="s1">&#39;</span><span class="s">com.squareup.okhttp3:logging-interceptor:3.6.0</span><span class="s1">&#39;</span> <span class="o">//</span> <span class="k">for</span> <span class="nv">logging</span> <span class="nv">API</span> <span class="nv">calls</span> <span class="nv">to</span> <span class="nv">LogCat</span>
}
</pre></div>


<table>
<thead>
<tr>
<th>Package</th>
<th align="center">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Parse Bolts</td>
<td align="center"><img alt="" src="https://maven-badges.herokuapp.com/maven-central/com.parse.bolts/bolts-android/badge.svg?style=flat" /></td>
</tr>
<tr>
<td>Parse Android SDK</td>
<td align="center"><img alt="" src="https://maven-badges.herokuapp.com/maven-central/com.parse/parse-android/badge.svg?style=flat" /></td>
</tr>
<tr>
<td>Parse Interceptors</td>
<td align="center"><img alt="" src="https://maven-badges.herokuapp.com/maven-central/com.parse/parseinterceptors/badge.svg?style=flat" /></td>
</tr>
</tbody>
</table>
<p>Select <code>Tools -&gt; Android -&gt; Sync Project with Gradle Files</code> to load the libraries through Gradle. When you sync, it will import everything automatically. You can see the imported files in the External Libraries folder.</p>
<p>Next, we need to create an <code>Application</code> class and initialize Parse. Be sure to replace the initialization line below with <strong>your correct Parse keys</strong>:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ParseApplication</span> <span class="kd">extends</span> <span class="n">Application</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">();</span>

        <span class="c1">// Use for troubleshooting -- remove this line for production</span>
        <span class="n">Parse</span><span class="o">.</span><span class="na">setLogLevel</span><span class="o">(</span><span class="n">Parse</span><span class="o">.</span><span class="na">LOG_LEVEL_DEBUG</span><span class="o">);</span>

        <span class="c1">// Use for monitoring Parse OkHttp trafic        </span>
        <span class="c1">// Can be Level.BASIC, Level.HEADERS, or Level.BODY</span>
        <span class="c1">// See http://square.github.io/okhttp/3.x/logging-interceptor/ to see the options.</span>
        <span class="n">OkHttpClient</span><span class="o">.</span><span class="na">Builder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OkHttpClient</span><span class="o">.</span><span class="na">Builder</span><span class="o">();</span>
        <span class="n">HttpLoggingInterceptor</span> <span class="n">httpLoggingInterceptor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpLoggingInterceptor</span><span class="o">();</span>
        <span class="n">httpLoggingInterceptor</span><span class="o">.</span><span class="na">setLevel</span><span class="o">(</span><span class="n">HttpLoggingInterceptor</span><span class="o">.</span><span class="na">Level</span><span class="o">.</span><span class="na">BODY</span><span class="o">);</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">networkInterceptors</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">httpLoggingInterceptor</span><span class="o">);</span>

        <span class="c1">// set applicationId, and server server based on the values in the Heroku settings.</span>
        <span class="c1">// clientKey is not needed unless explicitly configured</span>
        <span class="c1">// any network interceptors must be added with the Configuration Builder given this syntax</span>
        <span class="n">Parse</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="k">new</span> <span class="n">Parse</span><span class="o">.</span><span class="na">Configuration</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="k">this</span><span class="o">)</span>
                <span class="o">.</span><span class="na">applicationId</span><span class="o">(</span><span class="s">&quot;myAppId&quot;</span><span class="o">)</span> <span class="c1">// should correspond to APP_ID env variable</span>
                <span class="o">.</span><span class="na">clientKey</span><span class="o">(</span><span class="kc">null</span><span class="o">)</span>  <span class="c1">// set explicitly unless clientKey is explicitly configured on Parse server</span>
                <span class="o">.</span><span class="na">clientBuilder</span><span class="o">(</span><span class="n">builder</span><span class="o">)</span>
                <span class="o">.</span><span class="na">server</span><span class="o">(</span><span class="s">&quot;https://my-parse-app-url.herokuapp.com/parse/&quot;</span><span class="o">).</span><span class="na">build</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>The <code>/parse/</code> path needs to match the <code>PARSE_MOUNT</code> environment variable, which is set to this value by default.</p>
<p>We also need to make sure to set the application instance above as the <code>android:name</code> for the application within the <code>AndroidManifest.xml</code>. This change in the manifest determines which application class is instantiated when the app is launched and also adding the application ID metadata tag:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;com.example.parsetododemo&quot;</span>
    <span class="na">android:versionCode=</span><span class="s">&quot;1&quot;</span>
    <span class="na">android:versionName=</span><span class="s">&quot;1.0&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;application</span>
        <span class="na">android:name=</span><span class="s">&quot;.ParseApplication&quot;</span>
        <span class="na">android:icon=</span><span class="s">&quot;@drawable/ic_launcher&quot;</span>
        <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span>
        <span class="na">android:theme=</span><span class="s">&quot;@style/AppTheme&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;/application&gt;</span>
<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<p>We also need to add a few important network permissions to the <code>AndroidManifest.xml</code>:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;com.example.parsetododemo&quot;</span>
    <span class="na">android:versionCode=</span><span class="s">&quot;1&quot;</span>
    <span class="na">android:versionName=</span><span class="s">&quot;1.0&quot;</span> <span class="nt">&gt;</span>

    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span> <span class="nt">/&gt;</span>

   ...
<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<h3 id="testing-parse-client">Testing Parse Client<a class="headerlink" href="#testing-parse-client" title="Permanent link">&para;</a></h3>
<p>Assuming you have access to the Parse instance, you can test the SDK to verify that Parse is working with this application.</p>
<p>Let's add the test code to <code>ParseApplication</code> as follows:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ParseApplication</span> <span class="kd">extends</span> <span class="n">Application</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">();</span>

        <span class="c1">// Your initialization code from above here</span>
        <span class="n">Parse</span><span class="o">.</span><span class="na">initialize</span><span class="o">(...);</span>

        <span class="c1">// New test creation of object below</span>
        <span class="n">ParseObject</span> <span class="n">testObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ParseObject</span><span class="o">(</span><span class="s">&quot;TestObject&quot;</span><span class="o">);</span>
        <span class="n">testObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="s">&quot;bar&quot;</span><span class="o">);</span>
        <span class="n">testObject</span><span class="o">.</span><span class="na">saveInBackground</span><span class="o">();</span>
    <span class="o">}</span>       
<span class="o">}</span>
</pre></div>


<p>Run your app and a new object of class <code>TestObject</code> will be sent to the Parse Cloud and saved. See [[browsing Parse data|Configuring-a-Parse-Server#browsing-parse-data]] for more information about how to check this data.</p>
<p>If needed in your application, you might also want to [[setup push notifications|Push-Notifications-Setup-for-Parse]] through Parse as well at this time.</p>
<p>You should be setup now!  Follow the remaining documentation guide to understand how to leverage Parse for your entire backend.  </p>
<h2 id="working-with-users">Working with Users<a class="headerlink" href="#working-with-users" title="Permanent link">&para;</a></h2>
<p>At the core of many apps, there is a notion of user accounts that lets users access their information in a secure manner. Parse has a specialized <code>ParseUser</code> as a part of their SDK which handles this functionality. Be sure to check out the <a href="http://docs.parseplatform.org/android/guide/#users">Users</a> docs for a complete overview. See the API docs for <a href="http://parseplatform.org/Parse-SDK-Android/api/com/parse/ParseUser.html">ParseUser</a> for more details.</p>
<h3 id="user-signup">User Signup<a class="headerlink" href="#user-signup" title="Permanent link">&para;</a></h3>
<p>Creating a new user account is the process of constructing a <code>ParseUser</code> object and calling <code>signUpInBackground</code>:</p>
<div class="codehilite"><pre><span></span><span class="c1">// Create the ParseUser</span>
<span class="n">ParseUser</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ParseUser</span><span class="o">();</span>
<span class="c1">// Set core properties</span>
<span class="n">user</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">&quot;joestevens&quot;</span><span class="o">);</span>
<span class="n">user</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="s">&quot;secret123&quot;</span><span class="o">);</span>
<span class="n">user</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&quot;email@example.com&quot;</span><span class="o">);</span>
<span class="c1">// Set custom properties</span>
<span class="n">user</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;phone&quot;</span><span class="o">,</span> <span class="s">&quot;650-253-0000&quot;</span><span class="o">);</span>
<span class="c1">// Invoke signUpInBackground</span>
<span class="n">user</span><span class="o">.</span><span class="na">signUpInBackground</span><span class="o">(</span><span class="k">new</span> <span class="n">SignUpCallback</span><span class="o">()</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Hooray! Let them use the app now.</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="c1">// Sign up didn&#39;t succeed. Look at the ParseException</span>
      <span class="c1">// to figure out what went wrong</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<p>This call will asynchronously create a new user in your Parse App. Before it does this, it checks to make sure that both the username and email are unique. See the <a href="http://docs.parseplatform.org/android/guide/#signing-up">signup up docs</a> for more details.</p>
<h3 id="user-session-login">User Session Login<a class="headerlink" href="#user-session-login" title="Permanent link">&para;</a></h3>
<p>We can allow a user to signin by calling <code>logInInBackground</code> and passing the user details:</p>
<div class="codehilite"><pre><span></span><span class="n">ParseUser</span><span class="o">.</span><span class="na">logInInBackground</span><span class="o">(</span><span class="s">&quot;joestevens&quot;</span><span class="o">,</span> <span class="s">&quot;secret123&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">LogInCallback</span><span class="o">()</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">ParseUser</span> <span class="n">user</span><span class="o">,</span> <span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">user</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Hooray! The user is logged in.</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="c1">// Signup failed. Look at the ParseException to see what happened.</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<p>If the credentials are correct, the <code>ParseUser</code> will be passed back accordingly. You can now access the cached current user for your application at any time in order to determine the session status:</p>
<div class="codehilite"><pre><span></span><span class="n">ParseUser</span> <span class="n">currentUser</span> <span class="o">=</span> <span class="n">ParseUser</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">();</span>
<span class="k">if</span> <span class="o">(</span><span class="n">currentUser</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// do stuff with the user</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
  <span class="c1">// show the signup or login screen</span>
<span class="o">}</span>
</pre></div>


<p>A user can be signed back out with:</p>
<div class="codehilite"><pre><span></span><span class="n">ParseUser</span><span class="o">.</span><span class="na">logOut</span><span class="o">();</span>
<span class="n">ParseUser</span> <span class="n">currentUser</span> <span class="o">=</span> <span class="n">ParseUser</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">();</span> <span class="c1">// this will now be null</span>
</pre></div>


<p>That's the basics of what you need to work with users. See more details by checking out the <a href="http://docs.parseplatform.org/android/guide/#users">User</a> official docs.</p>
<p>You can also have a <a href="http://docs.parseplatform.org/android/guide/#facebook-users">Facebook Login</a> or <a href="http://docs.parseplatform.org/android/guide/#twitter-users">Twitter Login</a> for your users easily following the guides linked.</p>
<h3 id="querying-users">Querying Users<a class="headerlink" href="#querying-users" title="Permanent link">&para;</a></h3>
<p>To query for users, you need to use the special user query:</p>
<div class="codehilite"><pre><span></span><span class="n">ParseQuery</span><span class="o">&lt;</span><span class="n">ParseUser</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">ParseUser</span><span class="o">.</span><span class="na">getQuery</span><span class="o">();</span>
<span class="n">query</span><span class="o">.</span><span class="na">whereGreaterThan</span><span class="o">(</span><span class="s">&quot;age&quot;</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span> <span class="c1">// find adults</span>
<span class="n">query</span><span class="o">.</span><span class="na">findInBackground</span><span class="o">(</span><span class="k">new</span> <span class="n">FindCallback</span><span class="o">&lt;</span><span class="n">ParseUser</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ParseUser</span><span class="o">&gt;</span> <span class="n">objects</span><span class="o">,</span> <span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// The query was successful.</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="c1">// Something went wrong.</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<p>See a list of <a href="http://docs.parseplatform.org/android/guide/#query-constraints">query constraints</a> here.</p>
<h2 id="working-with-data-objects">Working With Data Objects<a class="headerlink" href="#working-with-data-objects" title="Permanent link">&para;</a></h2>
<p>Storing data on Parse is built around the <code>ParseObject</code>. Each <code>ParseObject</code> contains key-value pairs of JSON-compatible data. This data is schema-less, which means that you don't need to specify ahead of time what keys exist on each <code>ParseObject</code>. Each <code>ParseObject</code> has a class name that you can use to distinguish different sorts of data. See the API docs for <a href="http://parseplatform.org/Parse-SDK-Android/api/com/parse/ParseObject.html">ParseObject</a> for more details.</p>
<h3 id="creating-parse-models">Creating Parse Models<a class="headerlink" href="#creating-parse-models" title="Permanent link">&para;</a></h3>
<p>When using Parse, the best practice is to create models that represent our data and that subclass <code>ParseObject</code> to allow for Parse persistence. Suppose we wanted to create a <code>TodoItem</code> model:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">com.parse.ParseObject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.parse.ParseClassName</span><span class="o">;</span>

<span class="nd">@ParseClassName</span><span class="o">(</span><span class="s">&quot;TodoItem&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TodoItem</span> <span class="kd">extends</span> <span class="n">ParseObject</span> <span class="o">{</span>
  <span class="c1">// Ensure that your subclass has a public default constructor</span>

<span class="o">}</span>
</pre></div>


<p>We need to make sure to register this class with Parse <strong>before</strong> we call <code>Parse.initialize</code>:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ParseApplication</span> <span class="kd">extends</span> <span class="n">Application</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">();</span>
    <span class="c1">// Register your parse models</span>
    <span class="n">ParseObject</span><span class="o">.</span><span class="na">registerSubclass</span><span class="o">(</span><span class="n">TodoItem</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="c1">// Add your initialization code here</span>
    <span class="n">Parse</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">&quot;7zBztvyG4hYQ9XghgfqYxfRcL3SMBYWAj0GUL&quot;</span><span class="o">,</span> <span class="s">&quot;iZWhgJRu6yKm3iNMbTaguLcNCV3qedijWL&quot;</span><span class="o">);</span>
  <span class="o">}</span>     
<span class="o">}</span>
</pre></div>


<p>Now we can add fields and constructors to our <code>TodoItem</code>:</p>
<div class="codehilite"><pre><span></span><span class="nd">@ParseClassName</span><span class="o">(</span><span class="s">&quot;TodoItem&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TodoItem</span> <span class="kd">extends</span> <span class="n">ParseObject</span> <span class="o">{</span>
  <span class="c1">// Ensure that your subclass has a public default constructor</span>
  <span class="kd">public</span> <span class="nf">TodoItem</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="c1">// Add a constructor that contains core properties</span>
  <span class="kd">public</span> <span class="nf">TodoItem</span><span class="o">(</span><span class="n">String</span> <span class="n">body</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">();</span>
    <span class="n">setBody</span><span class="o">(</span><span class="n">body</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="c1">// Use getString and others to access fields</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getBody</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">getString</span><span class="o">(</span><span class="s">&quot;body&quot;</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="c1">// Use put to modify field values</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBody</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">put</span><span class="o">(</span><span class="s">&quot;body&quot;</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="c1">// Get the user for this item</span>
  <span class="kd">public</span> <span class="n">ParseUser</span> <span class="nf">getUser</span><span class="o">()</span>  <span class="o">{</span>
    <span class="k">return</span> <span class="n">getParseUser</span><span class="o">(</span><span class="s">&quot;owner&quot;</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="c1">// Associate each item with a user</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setOwner</span><span class="o">(</span><span class="n">ParseUser</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">put</span><span class="o">(</span><span class="s">&quot;owner&quot;</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Notice that now our model has <code>getBody</code>, <code>setBody</code> as well as property methods for storing which user created the TodoItem.</p>
<p><strong>Note:</strong> When creating Parse models, avoid <strong>creating unnecessary member instance variables</strong> and instead rely directly on <code>getString</code>-type methods to retrieve the values of database properties.</p>
<h3 id="saving-or-updating-objects">Saving or Updating Objects<a class="headerlink" href="#saving-or-updating-objects" title="Permanent link">&para;</a></h3>
<p>Let's suppose we wanted to save a <code>TodoItem</code> to the Parse database, create a new <code>TodoItem</code>, set the data attributes and then trigger a save with <code>saveInBackground</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">TodoItem</span> <span class="n">todoItem</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TodoItem</span><span class="o">(</span><span class="s">&quot;Do laundry&quot;</span><span class="o">);</span>
<span class="c1">// Set the current user, assuming a user is signed in</span>
<span class="n">todoItem</span><span class="o">.</span><span class="na">setOwner</span><span class="o">(</span><span class="n">ParseUser</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">());</span>
<span class="c1">// Immediately save the data asynchronously</span>
<span class="n">todoItem</span><span class="o">.</span><span class="na">saveInBackground</span><span class="o">();</span>
<span class="c1">// or for a more robust offline save</span>
<span class="c1">// todoItem.saveEventually();</span>
</pre></div>


<p>Note that there are two ways to save an object: <code>saveInBackground</code> which executes immediately and <code>saveEventually</code> which will store the update on the device and push to the server once internet access is available.</p>
<p>See the <a href="http://docs.parseplatform.org/android/guide/#saving-objects">saving objects</a> and <a href="http://docs.parseplatform.org/android/guide/#updating-objects">updating docs</a> docs for more details. Also, check out the <a href="http://docs.parseplatform.org/android/guide/#relations">relational data</a> section.</p>
<h3 id="querying-objects">Querying Objects<a class="headerlink" href="#querying-objects" title="Permanent link">&para;</a></h3>
<h4 id="objects-by-id">Objects By Id<a class="headerlink" href="#objects-by-id" title="Permanent link">&para;</a></h4>
<p>If you have the objectId, you can retrieve the whole <code>ParseObject</code> using a <code>ParseQuery</code>:</p>
<div class="codehilite"><pre><span></span><span class="c1">// Specify which class to query</span>
<span class="n">ParseQuery</span><span class="o">&lt;</span><span class="n">TodoItem</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">ParseQuery</span><span class="o">.</span><span class="na">getQuery</span><span class="o">(</span><span class="n">TodoItem</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="c1">// Specify the object id</span>
<span class="n">query</span><span class="o">.</span><span class="na">getInBackground</span><span class="o">(</span><span class="s">&quot;aFuEsvjoHt&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">GetCallback</span><span class="o">&lt;</span><span class="n">TodoItem</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">TodoItem</span> <span class="n">item</span><span class="o">,</span> <span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Access data using the `get` methods for the object</span>
      <span class="n">String</span> <span class="n">body</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="na">getBody</span><span class="o">();</span>
      <span class="c1">// Access special values that are built-in to each object</span>
      <span class="n">String</span> <span class="n">objectId</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="na">getObjectId</span><span class="o">();</span>
      <span class="n">Date</span> <span class="n">updatedAt</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="na">getUpdatedAt</span><span class="o">();</span>
      <span class="n">Date</span> <span class="n">createdAt</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="na">getCreatedAt</span><span class="o">();</span>
      <span class="c1">// Do whatever you want with the data...</span>
      <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">TodoItemsActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">body</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="c1">// something went wrong</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<p>See <a href="http://docs.parseplatform.org/android/guide/#retrieving-objects">retrieving objects</a> official docs for information on refreshing stale objects and more.</p>
<h4 id="objects-by-query-conditions">Objects By Query Conditions<a class="headerlink" href="#objects-by-query-conditions" title="Permanent link">&para;</a></h4>
<p>The general pattern is to create a <code>ParseQuery</code>, put conditions on it, and then retrieve a <code>List</code> of matching ParseObjects using the <code>findInBackground</code> method with a <code>FindCallback</code>. For example, to find all items created by a particular user:</p>
<div class="codehilite"><pre><span></span><span class="c1">// Define the class we would like to query</span>
<span class="n">ParseQuery</span><span class="o">&lt;</span><span class="n">TodoItem</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">ParseQuery</span><span class="o">.</span><span class="na">getQuery</span><span class="o">(</span><span class="n">TodoItem</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="c1">// Define our query conditions</span>
<span class="n">query</span><span class="o">.</span><span class="na">whereEqualTo</span><span class="o">(</span><span class="s">&quot;owner&quot;</span><span class="o">,</span> <span class="n">ParseUser</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">());</span>
<span class="c1">// Execute the find asynchronously</span>
<span class="n">query</span><span class="o">.</span><span class="na">findInBackground</span><span class="o">(</span><span class="k">new</span> <span class="n">FindCallback</span><span class="o">&lt;</span><span class="n">TodoItem</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">TodoItem</span><span class="o">&gt;</span> <span class="n">itemList</span><span class="o">,</span> <span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Access the array of results here</span>
            <span class="n">String</span> <span class="n">firstItemId</span> <span class="o">=</span> <span class="n">itemList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getObjectId</span><span class="o">();</span>
            <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">TodoItemsActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">firstItemId</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;item&quot;</span><span class="o">,</span> <span class="s">&quot;Error: &quot;</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<p>See a list of <a href="http://docs.parseplatform.org/android/guide/#query-constraints">query constraints</a> here and check the <a href="http://docs.parseplatform.org/android/guide/#queries">queries overview</a> for explanation of compound queries and relational queries.</p>
<h4 id="objects-by-querying-geolocation">Objects by Querying GeoLocation<a class="headerlink" href="#objects-by-querying-geolocation" title="Permanent link">&para;</a></h4>
<p>Often we might want to query objects within a certain radius of a coordinate (for example to display them on a map). With Parse, querying by <code>GeoPoint</code> to retrieve objects within a certain distance of a location is built in. Check the <a href="https://github.com/rosstapson/AnyWall">AnyWall Tutorial</a> and the <a href="http://parseplatform.org/Parse-SDK-Android/api/com/parse/ParseQuery.html#whereWithinMiles(java.lang.String,%20com.parse.ParseGeoPoint,%20double)">whereWithinMiles</a> and related <code>where</code> conditions for more details.</p>
<p>If you want to query this based on a map, first you can <a href="https://developers.google.com/android/reference/com/google/android/gms/maps/GoogleMap#setOnCameraChangeListener(com.google.android.gms.maps.GoogleMap.OnCameraChangeListener)">add a listener for the map camera</a>. Next, you can determine the <a href="http://stackoverflow.com/q/16056366">visible bounds of the map</a> as shown there. Check the [[Maps Usage Guide|Google-Maps-API-v2-Usage]] for additional information on using the map.</p>
<h4 id="live-queries">Live Queries<a class="headerlink" href="#live-queries" title="Permanent link">&para;</a></h4>
<p>One of the newer features of Parse is that you can monitor for live changes made to objects in your database  To get started, make sure you have defined the ParseObjects that you want in your NodeJS server.  Make sure to define a list of all the objects by declaring it in the <code>liveQuery</code> and <code>classNames listing</code>:</p>
<div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParseServer</span><span class="p">({</span>
  <span class="p">...,</span>
  <span class="c1">// Make sure to define liveQuery AND classNames</span>
  <span class="nx">liveQuery</span><span class="o">:</span> <span class="p">{</span>
    <span class="c1">// define your ParseObject names here</span>
    <span class="nx">classNames</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">,</span> <span class="s1">&#39;Comment&#39;</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>


<p>See <a href="http://parseplatform.org/docs/parse-server/guide/#live-queries">this guide</a> for more details.  Parse Live Queries rely on the websocket protocol, which creates a bidirectional channel between the client and server and periodically exchange ping/pong frames to validate the connection is still alive.  Websocket URLs are usually prefixed with ws:// or wss:// (secure) URLs.  Heroku instances already provide websocket support, but if you are deploying to a different server (Amazon), you may need to make sure that TCP port 80 or TCP port 443 are available.</p>
<p>You will need to also setup the client SDK by adding this dependency to your <code>app/build.gradle</code> config:</p>
<div class="codehilite"><pre><span></span><span class="n">dependencies</span> <span class="err">{</span>
  <span class="o">//</span> <span class="k">add</span> <span class="n">Parse</span> <span class="n">dependencies</span> <span class="n">too</span>
  <span class="n">compile</span> <span class="s1">&#39;com.parse:parse-livequery-android:1.0.2&#39;</span>
<span class="err">}</span>
</pre></div>


<p>Next, instantiate the client:</p>
<div class="codehilite"><pre><span></span><span class="n">ParseLiveQueryClient</span> <span class="n">parseLiveQueryClient</span> <span class="o">=</span> <span class="n">ParseLiveQueryClient</span><span class="o">.</span><span class="na">Factory</span><span class="o">.</span><span class="na">getClient</span><span class="o">();</span>
</pre></div>


<p>Define the query pattern you wish to listen for events:</p>
<div class="codehilite"><pre><span></span><span class="n">ParseQuery</span><span class="o">&lt;</span><span class="n">Comment</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">ParseQuery</span><span class="o">.</span><span class="na">getQuery</span><span class="o">(</span><span class="n">Comment</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>


<p>Create a subscription to this <code>ParseQuery</code> instance:</p>
<div class="codehilite"><pre><span></span><span class="n">SubscriptionHandling</span><span class="o">&lt;</span><span class="n">ParseObject</span><span class="o">&gt;</span> <span class="n">subscriptionHandling</span> <span class="o">=</span> <span class="n">parseLiveQueryClient</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">parseQuery</span><span class="o">)</span>
</pre></div>


<p>Finally, listen to the events. You can listen for <code>Event.UPDATE</code>, <code>Event.DELETE</code>, <code>Event.ENTER</code>, and <code>Event.LEAVE</code>.  An enter and leave event reflects changes to an existing ParseObject that either now fulfill the criteria or no longer do so.  See <a href="https://github.com/ParsePlatform/parse-server/wiki/Parse-LiveQuery-Protocol-Specification">this guide</a> for more information about the live queries protocol specification.</p>
<div class="codehilite"><pre><span></span><span class="n">subscriptionHandling</span><span class="o">.</span><span class="na">handleEvent</span><span class="o">(</span><span class="n">SubscriptionHandling</span><span class="o">.</span><span class="na">Event</span><span class="o">.</span><span class="na">CREATE</span><span class="o">,</span> <span class="k">new</span> <span class="n">SubscriptionHandling</span><span class="o">.</span><span class="na">HandleEventCallback</span><span class="o">&lt;</span><span class="n">Comment</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onEvent</span><span class="o">(</span><span class="n">ParseQuery</span><span class="o">&lt;</span><span class="n">Comment</span><span class="o">&gt;</span> <span class="n">query</span><span class="o">,</span> <span class="n">Comment</span> <span class="n">object</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// HANDLING create event</span>
    <span class="o">}</span>
<span class="o">})</span>
</pre></div>


<h3 id="passing-objects-between-activities">Passing Objects Between Activities<a class="headerlink" href="#passing-objects-between-activities" title="Permanent link">&para;</a></h3>
<p>Often with Android development, you need to pass an object from one Activity to another. This is done using the <code>Intent</code> system and passing objects as extras within a bundle. Unfortunately, <code>ParseObject</code> does not currently implement Parcelable or Serializable.</p>
<p>The simplest way to pass data between activities in Parse is simply to pass the object ID into the Intent:</p>
<div class="codehilite"><pre><span></span><span class="n">Intent</span> <span class="n">i</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">SomeNewActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">i</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">&quot;todo_id&quot;</span><span class="o">,</span> <span class="n">myTodoItem</span><span class="o">.</span><span class="na">getObjectId</span><span class="o">());</span>
<span class="n">startActivity</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
</pre></div>


<p>and then refetch the object using the object ID within the child Activity:</p>
<div class="codehilite"><pre><span></span><span class="n">String</span> <span class="n">todoId</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">().</span><span class="na">getStringExtra</span><span class="o">(</span><span class="s">&quot;todo_id&quot;</span><span class="o">);</span>
<span class="n">ParseQuery</span><span class="o">&lt;</span><span class="n">TodoItem</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">ParseQuery</span><span class="o">.</span><span class="na">getQuery</span><span class="o">(</span><span class="n">TodoItem</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="c1">// First try to find from the cache and only then go to network</span>
<span class="n">query</span><span class="o">.</span><span class="na">setCachePolicy</span><span class="o">(</span><span class="n">ParseQuery</span><span class="o">.</span><span class="na">CachePolicy</span><span class="o">.</span><span class="na">CACHE_ELSE_NETWORK</span><span class="o">);</span> <span class="c1">// or CACHE_ONLY</span>
<span class="c1">// Execute the query to find the object with ID</span>
<span class="n">query</span><span class="o">.</span><span class="na">getInBackground</span><span class="o">(</span><span class="n">todoId</span><span class="o">,</span> <span class="k">new</span> <span class="n">GetCallback</span><span class="o">&lt;</span><span class="n">TodoItem</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">TodoItem</span> <span class="n">item</span><span class="o">,</span> <span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
       <span class="c1">// item was found</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>You can also use <code>query.getFirst()</code> instead to retrieve the item in a synchronous style. Review the different <a href="http://parseplatform.org/docs/android/guide/#caching-queries">caching policies</a> to understand how to make this fast.</p>
<p>While we could <a href="http://www.androidbook.com/akc/display?url=DisplayNoteIMPURL&amp;reportId=4539&amp;ownerUserId=android">implement parceling ourselves</a> this is not ideal as it's pretty complex to manage the state of Parse objects.</p>
<h3 id="associations">Associations<a class="headerlink" href="#associations" title="Permanent link">&para;</a></h3>
<p>Objects can have relationships with other objects. To model this behavior, any <code>ParseObject</code> can be used as a value in other <code>ParseObject</code>s. Internally, the Parse framework will store the referred-to object in just one place, to maintain consistency.</p>
<h4 id="one-to-one-relationships">One-to-One Relationships<a class="headerlink" href="#one-to-one-relationships" title="Permanent link">&para;</a></h4>
<p>For example, each Comment in a blogging app might correspond to one Post. To create a new Post with a single Comment, you could write:</p>
<div class="codehilite"><pre><span></span><span class="nd">@ParseClassName</span><span class="o">(</span><span class="s">&quot;Post&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Post</span> <span class="kd">extends</span> <span class="n">ParseObject</span> <span class="o">{</span>
   <span class="c1">// ...</span>
<span class="o">}</span>

<span class="nd">@ParseClassName</span><span class="o">(</span><span class="s">&quot;Comment&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Comment</span> <span class="kd">extends</span> <span class="n">ParseObject</span> <span class="o">{</span>
        <span class="c1">// ...</span>

    <span class="c1">// Associate each comment with a user</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setOwner</span><span class="o">(</span><span class="n">ParseUser</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">put</span><span class="o">(</span><span class="s">&quot;owner&quot;</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Get the user for this comment</span>
    <span class="kd">public</span> <span class="n">ParseUser</span> <span class="nf">getOwner</span><span class="o">()</span>  <span class="o">{</span>
           <span class="k">return</span> <span class="n">getParseUser</span><span class="o">(</span><span class="s">&quot;owner&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Associate each comment with a post</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPost</span><span class="o">(</span><span class="n">Post</span> <span class="n">post</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">put</span><span class="o">(</span><span class="s">&quot;post&quot;</span><span class="o">,</span> <span class="n">post</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Get the post for this item</span>
    <span class="kd">public</span> <span class="n">Post</span> <span class="nf">getPost</span><span class="o">()</span>  <span class="o">{</span>
           <span class="k">return</span> <span class="o">(</span><span class="n">Post</span><span class="o">)</span> <span class="n">getParseObject</span><span class="o">(</span><span class="s">&quot;post&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Create the post</span>
<span class="n">Post</span> <span class="n">post</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Post</span><span class="o">(</span><span class="s">&quot;Welcome Spring!&quot;</span><span class="o">);</span>
<span class="c1">// Get the user</span>
<span class="n">ParseUser</span> <span class="n">currentUser</span> <span class="o">=</span> <span class="n">ParseUser</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">();</span>
<span class="c1">// Create the comment</span>
<span class="n">Comment</span> <span class="n">comment</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Comment</span><span class="o">(</span><span class="s">&quot;Get milk and eggs&quot;</span><span class="o">);</span>
<span class="n">comment</span><span class="o">.</span><span class="na">setPost</span><span class="o">(</span><span class="n">post</span><span class="o">);</span>
<span class="n">comment</span><span class="o">.</span><span class="na">setOwner</span><span class="o">(</span><span class="n">currentUser</span><span class="o">);</span>
<span class="n">comment</span><span class="o">.</span><span class="na">saveInBackground</span><span class="o">();</span>
</pre></div>


<p>By default, when fetching an object, related <code>ParseObject</code>s are not fetched. We can preload (eagerly fetch these) by using the <code>include</code> method on any <code>ParseQuery</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">ParseQuery</span><span class="o">&lt;</span><span class="n">ParseObject</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">ParseQuery</span><span class="o">.</span><span class="na">getQuery</span><span class="o">(</span><span class="n">Comment</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="c1">// Include the post data with each comment</span>
<span class="n">query</span><span class="o">.</span><span class="na">include</span><span class="o">(</span><span class="s">&quot;owner&quot;</span><span class="o">);</span> <span class="c1">// the key which the associated object was stored</span>
<span class="c1">// Execute query with eager-loaded owner</span>
<span class="n">query</span><span class="o">.</span><span class="na">findInBackground</span><span class="o">(</span><span class="k">new</span> <span class="n">FindCallback</span><span class="o">&lt;</span><span class="n">ParseObject</span><span class="o">&gt;()</span> <span class="o">{</span>
 <span class="o">....</span>
<span class="o">}</span>
</pre></div>


<p>We can eagerly load nested associations as well. If you have an objectA which has a column referencing objectB and then objectB has a column referencing objectC, you can get objectB and objectC by doing:</p>
<div class="codehilite"><pre><span></span><span class="n">ParseQuery</span><span class="o">&lt;</span><span class="n">ParseObject</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">ParseQuery</span><span class="o">.</span><span class="na">getQuery</span><span class="o">(</span><span class="n">ObjectA</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">query</span><span class="o">.</span><span class="na">include</span><span class="o">(</span><span class="s">&quot;ObjectB.ObjectC&quot;</span><span class="o">);</span>
<span class="c1">// ...execute query...</span>
</pre></div>


<p>Otherwise, these associated objects can only be retrieved once they have been fetched separately:</p>
<div class="codehilite"><pre><span></span><span class="n">fetchedTodoItem</span><span class="o">.</span><span class="na">getCategory</span><span class="o">()</span>
    <span class="o">.</span><span class="na">fetchIfNeededInBackground</span><span class="o">(</span><span class="k">new</span> <span class="n">GetCallback</span><span class="o">&lt;</span><span class="n">Category</span><span class="o">&gt;()</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">Category</span> <span class="n">object</span><span class="o">,</span> <span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">String</span> <span class="n">title</span> <span class="o">=</span> <span class="n">category</span><span class="o">.</span><span class="na">getTitle</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">});</span>
</pre></div>


<h4 id="many-to-many-relationships">Many-to-Many Relationships<a class="headerlink" href="#many-to-many-relationships" title="Permanent link">&para;</a></h4>
<p>You can also model a many-to-many relation using the <code>ParseRelation</code> object. This works similar to <code>ArrayList</code>, except that you don't need to download all the <code>ParseObject</code>s in a relation at once.</p>
<div class="codehilite"><pre><span></span><span class="nd">@ParseClassName</span><span class="o">(</span><span class="s">&quot;Tag&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Tag</span> <span class="kd">extends</span> <span class="n">ParseObject</span> <span class="o">{</span>
   <span class="c1">// ...this is a tag to describe an item</span>
<span class="o">}</span>

<span class="nd">@ParseClassName</span><span class="o">(</span><span class="s">&quot;TodoItem&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TodoItem</span> <span class="kd">extends</span> <span class="n">ParseObject</span> <span class="o">{</span>
   <span class="kd">public</span> <span class="n">ParseRelation</span><span class="o">&lt;</span><span class="n">Tag</span><span class="o">&gt;</span> <span class="nf">getTagsRelation</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">getRelation</span><span class="o">(</span><span class="s">&quot;tags&quot;</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addTag</span><span class="o">(</span><span class="n">Tag</span> <span class="n">tag</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">getTagsRelation</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">tag</span><span class="o">);</span>
    <span class="n">saveInBackground</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeTag</span><span class="o">(</span><span class="n">Tag</span> <span class="n">tag</span><span class="o">)</span> <span class="o">{</span>
     <span class="n">getTagsRelation</span><span class="o">().</span><span class="na">remove</span><span class="o">(</span><span class="n">tag</span><span class="o">);</span>
     <span class="n">saveInBackground</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>By default, the list of objects in this relation are not downloaded. You can get the list of Posts by calling findInBackground on the ParseQuery returned by getQuery. The code would look like:</p>
<div class="codehilite"><pre><span></span><span class="n">fetchedTodoItem</span><span class="o">.</span><span class="na">getTagsRelation</span><span class="o">().</span><span class="na">getQuery</span><span class="o">().</span><span class="na">findInBackground</span><span class="o">(</span><span class="k">new</span> <span class="n">FindCallback</span><span class="o">&lt;</span><span class="n">Tag</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Tag</span><span class="o">&gt;</span> <span class="n">results</span><span class="o">,</span> <span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// results have all the Posts the current user liked.</span>
      <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="c1">// There was an error</span>
      <span class="o">}</span>
    <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<p>For more details, check out the official <a href="http://docs.parseplatform.org/android/guide/#using-pointers">Relational Data</a> guide. For more complex many-to-many relationships, check out this official <a href="http://docs.parseplatform.org/android/guide/#using-join-tables">join tables</a> guide when the many-to-many requires additional metadata.</p>
<h3 id="deleting-objects">Deleting Objects<a class="headerlink" href="#deleting-objects" title="Permanent link">&para;</a></h3>
<p>To delete an object from the Parse Cloud:</p>
<div class="codehilite"><pre><span></span><span class="n">todoItem</span><span class="o">.</span><span class="na">deleteInBackground</span><span class="o">();</span>
</pre></div>


<p>Naturally we can also delete in an offline manner with:</p>
<div class="codehilite"><pre><span></span><span class="n">todoItem</span><span class="o">.</span><span class="na">deleteEventually</span><span class="o">();</span>
</pre></div>


<h2 id="local-storage-mode">Local Storage Mode<a class="headerlink" href="#local-storage-mode" title="Permanent link">&para;</a></h2>
<p>Parse now supports a more powerful form of <a href="http://parseplatform.org/docs/android/guide/#local-datastore">local data storage</a> out of the box which can be used to store and retrieve ParseObjects, even when the network is unavailable. To enable this functionality, simply call Parse.enableLocalDatastore() before your call to initialize:</p>
<div class="codehilite"><pre><span></span><span class="c1">// Within the Android Application where Parse is initialized</span>
<span class="n">Parse</span><span class="o">.</span><span class="na">enableLocalDatastore</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
<span class="n">Parse</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">PARSE_APPLICATION_ID</span><span class="o">,</span> <span class="n">PARSE_CLIENT_KEY</span><span class="o">);</span>
</pre></div>


<h3 id="saving-to-local-store">Saving To Local Store<a class="headerlink" href="#saving-to-local-store" title="Permanent link">&para;</a></h3>
<p>You can store a ParseObject in the local datastore by pinning it. Pinning a ParseObject is recursive, just like saving, so any objects that are pointed to by the one you are pinning will also be pinned:</p>
<div class="codehilite"><pre><span></span><span class="n">TodoItem</span> <span class="n">todoItem</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TodoItem</span><span class="o">(</span><span class="s">&quot;Do laundry&quot;</span><span class="o">);</span>
<span class="c1">// Set the current user, assuming a user is signed in</span>
<span class="n">todoItem</span><span class="o">.</span><span class="na">setOwner</span><span class="o">(</span><span class="n">ParseUser</span><span class="o">.</span><span class="na">getCurrentUser</span><span class="o">());</span>
<span class="c1">// Store object offline</span>
<span class="n">todoItem</span><span class="o">.</span><span class="na">pinInBackground</span><span class="o">();</span>
</pre></div>


<h3 id="querying-from-local-store">Querying from Local Store<a class="headerlink" href="#querying-from-local-store" title="Permanent link">&para;</a></h3>
<p>We can query from the local offline store with the <code>fromLocalDatastore</code> flag during any query operation:</p>
<div class="codehilite"><pre><span></span><span class="c1">// Specify which class to query</span>
<span class="n">ParseQuery</span><span class="o">&lt;</span><span class="n">TodoItem</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">ParseQuery</span><span class="o">.</span><span class="na">getQuery</span><span class="o">(</span><span class="n">TodoItem</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="c1">// Flag indicates we will use offline store</span>
<span class="n">query</span><span class="o">.</span><span class="na">fromLocalDatastore</span><span class="o">();</span>
<span class="c1">// Specify the object id</span>
<span class="n">query</span><span class="o">.</span><span class="na">getInBackground</span><span class="o">(</span><span class="s">&quot;aFuEsvjoHt&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">GetCallback</span><span class="o">&lt;</span><span class="n">TodoItem</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">TodoItem</span> <span class="n">item</span><span class="o">,</span> <span class="n">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
     <span class="c1">// ...</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<h3 id="further-details">Further Details<a class="headerlink" href="#further-details" title="Permanent link">&para;</a></h3>
<p>For the full summary of how to utilize the offline mode for Parse, be sure to review the <a href="http://parseplatform.org/docs/android/guide/#local-datastore">official local store guide</a> in the Parse docs.</p>
<h2 id="using-the-data-browser">Using the Data Browser<a class="headerlink" href="#using-the-data-browser" title="Permanent link">&para;</a></h2>
<p>Suppose we had a simple todo application with user accounts and items persisted to Parse. The next step is to setup and create our models using the <a href="http://guides.codepath.com/android/Configuring-a-Parse-Server#parse-dashboard">Parse dashboard</a> to manage your new app. Visit the "Data Browser" for the correct application and let's create our <code>User</code> and <code>TodoItem</code> objects for our app.</p>
<p>First, <strong>remove the test code that we added previously</strong> and drop the "TestObject" listed in the browser to clear testing data.</p>
<p><img src="https://i.imgur.com/ZFds0Fn.png" alt="screen_5" width="400" /></p>
<p>Next, select "New Class" and pick "User" to create the user object used to manage session authetication:</p>
<p><img src="https://i.imgur.com/7hQZz3y.png" alt="screen_6" width="300" /></p>
<p>Let's also add our "Custom" class which can represent any custom data. In this case, we will create a <code>TodoItem</code> class:</p>
<p><img src="https://i.imgur.com/MIZkV8L.png" alt="screen_7" width="300" /></p>
<p>Now, we need to add our custom columns to our class. In this case, let's add a "body" field to our <code>TodoItem</code> by selecting "+Col" and then selecting the type as a String and column name as "body":</p>
<p><img src="https://i.imgur.com/qYel2NP.png" alt="screen_8" width="300" /></p>
<p>Once you've finished adding your columns to the class, you can create as many additional classes as necessary and configure their respective columns. Let's add a row of data to the class directly through the data browser:</p>
<p><img src="https://i.imgur.com/QFMEnb7.png" alt="screen_9" width="600" /></p>
<p>We are now ready to access these classes within our application.</p>
<h2 id="troubleshooting_2">Troubleshooting<a class="headerlink" href="#troubleshooting_2" title="Permanent link">&para;</a></h2>
<p>Check out our [[Troubleshooting Common Issues with Parse]] guide for a detailed look at common issues encountered and related solutions.</p>
<h2 id="additional-features">Additional Features<a class="headerlink" href="#additional-features" title="Permanent link">&para;</a></h2>
<p>Parse has many powerful features in addition to the core functionality listed above.</p>
<h3 id="uploading-photos">Uploading Photos<a class="headerlink" href="#uploading-photos" title="Permanent link">&para;</a></h3>
<p>Parse has full support for storing images and files uploaded by an application. Photos are stored using the <code>ParseFile</code> construct <a href="http://parseplatform.org/docs/android/guide/#files">described in more detail here</a>. Refer to the following resources for more details:</p>
<ul>
<li><a href="http://parseplatform.org/docs/android/guide/#files">Parse Docs on File Uploads</a></li>
<li><a href="http://www.androidbegin.com/tutorial/android-parse-com-image-upload-tutorial">Parse Image Upload Tutorial</a> - Tutorial on using <code>ParseFile</code> to upload images.</li>
<li><a href="https://github.com/rufflez/MealSpottingTutorial">Mealspotting Sample App</a> - Detailed app sample showing how to store images associated to a record. Here's a <a href="https://www.youtube.com/watch?v=X9ttMA5ca9U">related video</a>.</li>
<li>[[CodePath Camera and Gallery Guide|Accessing-the-Camera-and-Stored-Media]] - Guide on capturing photos with the camera.</li>
<li>[[Handling Files after API 24|Sharing-Content-with-Intents#sharing-files-with-api-24-or-higher]] - Section on how to store files using <code>FileProvider</code></li>
<li><a href="http://stackoverflow.com/questions/31227547/how-to-upload-image-to-parse-in-android">How to upload images onto Parse post</a> - Good StackOverflow post on uploading images to Parse</li>
</ul>
<h3 id="geo-location">Geo Location<a class="headerlink" href="#geo-location" title="Permanent link">&para;</a></h3>
<p>Parse has support for geolocation services and querying:</p>
<ul>
<li><a href="https://github.com/rosstapson/AnyWall">AnyWall Sample App</a> - Sample app including how to read geolocation and use this data within your app.</li>
</ul>
<h3 id="push-notifications">Push Notifications<a class="headerlink" href="#push-notifications" title="Permanent link">&para;</a></h3>
<p>Parse supports push notifications made easy:</p>
<ul>
<li>[[Parse Push Messaging|Push-Messaging]] - CodePath Guide</li>
<li>[[Parse Push|Configuring-a-Parse-Server#enabling-push-notifications]] - Super easy push notifications</li>
</ul>
<h3 id="facebook-sdk">Facebook SDK<a class="headerlink" href="#facebook-sdk" title="Permanent link">&para;</a></h3>
<p>For a quick way of incorporating Facebook login, check out Parse's <a href="https://github.com/ParsePlatform/ParseUI-Android/wiki/Login-Library">UI Library</a>.  It leverages Parse's <a href="https://github.com/ParsePlatform/ParseFacebookUtils-Android/">FacebookUtils</a> library, which acts as a wrapper for associating <code>ParseUser</code> objects with Facebook users.  </p>
<p>The official step by step instructions for integrating Parse with Facebook SDK is located <a href="http://parseplatform.org/docs/android/guide/#facebook-users">here</a>.  The manual process of integrating with Facebook's SDK is discussed below.</p>
<p>You will first need to create a <a href="https://developers.facebook.com/apps">Facebook app</a> and get an Application ID.
If you are using open source Parse, make sure to set the <code>FACEBOOK_APP_ID</code> environment variable too.</p>
<p>You will also need to get access to your keystore hash and make sure to include it:</p>
<p><img src="https://scontent.fsnc1-1.fna.fbcdn.net/hphotos-xaf1/t39.2178-6/851568_627654437290708_1803108402_n.png"/></p>
<p>OS X:</p>
<div class="codehilite"><pre><span></span>keytool -exportcert -alias androiddebugkey -keystore ~/.android/debug.keystore <span class="p">|</span> openssl sha1 -binary <span class="p">|</span> openssl base64
</pre></div>


<p>Windows:</p>
<div class="codehilite"><pre><span></span>keytool -exportcert -alias androiddebugkey -keystore %HOMEPATH%<span class="se">\.</span>android<span class="se">\d</span>ebug.keystore <span class="p">|</span> openssl sha1 -binary <span class="p">|</span> openssl
base64
</pre></div>


<p>Next, you will need to include Parse's <a href="https://github.com/ParsePlatform/ParseFacebookUtils-Android/">FacebookUtils</a> library, which provides an easy-to-use wrapper to work with the Facebook SDK, as well as Facebook's SDK:</p>
<div class="codehilite"><pre><span></span><span class="n">dependencies</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">  </span><span class="n">compile</span><span class="w"> </span><span class="s1">&#39;com.facebook.android:facebook-android-sdk:4.10.0&#39;</span><span class="w"></span>
<span class="w">  </span><span class="n">compile</span><span class="w"> </span><span class="s1">&#39;com.parse:parsefacebookutils-v4-android:1.10.4@aar&#39;</span><span class="w"></span>
<span class="w">  </span><span class="n">compile</span><span class="w"> </span><span class="s1">&#39;com.parse:parse-android:1.14.1&#39;</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</pre></div>


<p>You will then need to make sure to initialize these libraries by doing so in your <code>MainApplication.java</code> file:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainApplication</span> <span class="kd">extends</span> <span class="n">Application</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">()</span> <span class="o">{</span>
     <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">();</span>

     <span class="n">Parse</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="k">new</span> <span class="n">Parse</span><span class="o">.</span><span class="na">Configuration</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="k">this</span><span class="o">)</span>
           <span class="o">.</span><span class="na">applicationId</span><span class="o">(</span><span class="s">&quot;myAppId&quot;</span><span class="o">)</span>
           <span class="o">.</span><span class="na">clientKey</span><span class="o">(</span><span class="kc">null</span><span class="o">)</span>
           <span class="o">.</span><span class="na">server</span><span class="o">(</span><span class="s">&quot;https://yourappname.herokupapp.com/parse/&quot;</span><span class="o">).</span><span class="na">build</span><span class="o">());</span>

    <span class="c1">// ParseFacebookUtils should initialize the Facebook SDK for you</span>
    <span class="n">ParseFacebookUtils</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
  <span class="o">}</span>
</pre></div>


<p>Make sure to reference this <code>MainApplication</code> in your <code>AndroidManifest.xml</code> file:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;application</span>
<span class="na">android:name=</span><span class="s">&quot;.MainApplication&quot;</span>
</pre></div>


<p>Make sure to add the <code>FacebookActivity</code> to your manifest file, as well as the application ID and permissions you wish to request.  </p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;com.facebook.FacebookActivity&quot;</span>
            <span class="na">android:configChanges=</span>
                <span class="s">&quot;keyboard|keyboardHidden|screenLayout|screenSize|orientation&quot;</span>
            <span class="na">android:theme=</span><span class="s">&quot;@android:style/Theme.Translucent.NoTitleBar&quot;</span>
            <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;meta-data</span>
            <span class="na">android:name=</span><span class="s">&quot;com.facebook.sdk.ApplicationId&quot;</span>
            <span class="na">android:value=</span><span class="s">&quot;@string/facebook_app_id&quot;</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;meta-data</span>
            <span class="na">android:name=</span><span class="s">&quot;com.facebook.sdk.PERMISSIONS&quot;</span>
            <span class="na">android:value=</span><span class="s">&quot;email&quot;</span> <span class="nt">/&gt;</span>
</pre></div>


<p>There are two ways to support Facebook login: one is to use your own custom button/icon, or to use Facebook's <code>LoginButton</code> class as described in the <a href="https://developers.facebook.com/docs/facebook-login/android">walkthrough</a>.  If you choose to use the <code>LoginButton</code> class, you should not use the <code>FacebookUtils</code> library to trigger a login.  The reason is that Facebook's <code>LoginButton</code> already has click handlers that will launch a login screen, so using Parse's code triggers two of these screens to appear.  In addition, you have to do more work to associate a <code>ParseUser</code> object with a Facebook user.  For this reason, it is simpler to use the custom button approach when integrating with Parse.</p>
<h4 id="custom-button">Custom button<a class="headerlink" href="#custom-button" title="Permanent link">&para;</a></h4>
<p>For your <code>LoginActivity.java</code>, add this code to trigger a login.  If you wish to trigger this login, you may add your own custom button:</p>
<div class="codehilite"><pre><span></span>    <span class="nt">&lt;Button</span>
        <span class="na">android:background=</span><span class="s">&quot;@color/com_facebook_blue&quot;</span>
        <span class="na">android:text=</span><span class="s">&quot;Log in with Facebook&quot;</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/login&quot;</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span><span class="nt">/&gt;</span>
</pre></div>


<p>You can then attach a button click handler.</p>
<div class="codehilite"><pre><span></span><span class="n">button</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
                                      <span class="nd">@Override</span>
                                      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>

            <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">permissions</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
            <span class="n">permissions</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;email&quot;</span><span class="o">);</span>
            <span class="n">ParseFacebookUtils</span><span class="o">.</span><span class="na">logInWithReadPermissionsInBackground</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">permissions</span><span class="o">,</span>
                    <span class="k">new</span> <span class="n">LogInCallback</span><span class="o">()</span> <span class="o">{</span>
                        <span class="nd">@Override</span>
                        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">done</span><span class="o">(</span><span class="n">ParseUser</span> <span class="n">user</span><span class="o">,</span> <span class="n">ParseException</span> <span class="n">err</span><span class="o">)</span> <span class="o">{</span>
                            <span class="k">if</span> <span class="o">(</span><span class="n">err</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;MyApp&quot;</span><span class="o">,</span> <span class="s">&quot;Uh oh. Error occurred&quot;</span> <span class="o">+</span> <span class="n">err</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">user</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;MyApp&quot;</span><span class="o">,</span> <span class="s">&quot;Uh oh. The user cancelled the Facebook login.&quot;</span><span class="o">);</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">isNew</span><span class="o">())</span> <span class="o">{</span>
                                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;MyApp&quot;</span><span class="o">,</span> <span class="s">&quot;User signed up and logged in through Facebook!&quot;</span><span class="o">);</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                                <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">&quot;Logged in&quot;</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">)</span>
                                        <span class="o">.</span><span class="na">show</span><span class="o">();</span>
                                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">&quot;MyApp&quot;</span><span class="o">,</span> <span class="s">&quot;User logged in through Facebook!&quot;</span><span class="o">);</span>
                            <span class="o">}</span>
                        <span class="o">}</span>
                    <span class="o">});</span>
        <span class="o">}</span>
<span class="o">});</span>
</pre></div>


<p>You must also override the <code>onActivityResult()</code> to capture the result after a user signs into Facebook:</p>
<div class="codehilite"><pre><span></span><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onActivityResult</span><span class="o">(</span><span class="kt">int</span> <span class="n">requestCode</span><span class="o">,</span> <span class="kt">int</span> <span class="n">resultCode</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">onActivityResult</span><span class="o">(</span><span class="n">requestCode</span><span class="o">,</span> <span class="n">resultCode</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
    <span class="n">ParseFacebookUtils</span><span class="o">.</span><span class="na">onActivityResult</span><span class="o">(</span><span class="n">requestCode</span><span class="o">,</span> <span class="n">resultCode</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>


<h3 id="server-code">Server Code<a class="headerlink" href="#server-code" title="Permanent link">&para;</a></h3>
<p>Running server-side code on Parse:</p>
<ul>
<li><a href="http://parseplatform.org/docs/android/guide/#use-cloud-code">CloudCode Guide</a> - Guide on how to write cloud-based code that adds error checking, validation or triggers "server-side"</li>
</ul>
<h2 id="building-data-driven-apps-with-firebase">Building Data driven Apps with Firebase<a class="headerlink" href="#building-data-driven-apps-with-firebase" title="Permanent link">&para;</a></h2>
<p>At this year's <a href="https://events.google.com/io2016/">Google I/O</a>, Google announced a number of interesting new features in Firebase. The new Firebase is said to be a Unified app platform for mobile developers adding new tools to help develop faster, improve app quality, engage users and monetize apps.</p>
<p>For a quick intro to what the new Firebase is about, you can watch <a href="https://www.youtube.com/watch?v=fgT6r4f9Apc&amp;feature=youtu.be">this video</a>.</p>
<p align="center">
    <a href="http://www.youtube.com/watch?feature=player_embedded&v=fgT6r4f9Apc
    " target="_blank"><img src="http://img.youtube.com/vi/fgT6r4f9Apc/0.jpg" 
    alt="Introducing the new Firebase" width="560" height="315" border="10" /></a>
</p>

<p>The new features that are included in this new Firebase include:</p>
<ol>
<li>[[Crash Reporting|Crash-Reporting-with-Firebase]]</li>
<li>[[Cloud Messaging|Google-Cloud-Messaging]]</li>
<li>Realtime database and storage</li>
<li>Analytics.</li>
<li>Notifications.</li>
<li>Dynamic Links.</li>
<li>App Indexing.</li>
<li>AdWords.</li>
<li>Firebase Invites etc</li>
</ol>
<h2 id="registration">Registration<a class="headerlink" href="#registration" title="Permanent link">&para;</a></h2>
<p>First point to get started with Firebase, is to create an account <a href="https://firebase.google.com/console/">here</a> if you don't have one already.</p>
<h2 id="setup_2">Setup<a class="headerlink" href="#setup_2" title="Permanent link">&para;</a></h2>
<h3 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h3>
<p>Before you can begin to enjoy the new Firebase, please ensure your development machine satisfies these prerequisites:</p>
<ul>
<li>A device running Android 2.3 (Gingerbread) or newer, and Google Play services 9.0.1 or newer</li>
<li>The Google Play services SDK from the Android SDK Manager</li>
<li>Android Studio 1.5 or higher</li>
<li>An Android Studio project and its package name</li>
</ul>
<h3 id="add-firebase-to-your-app">Add Firebase to your app<a class="headerlink" href="#add-firebase-to-your-app" title="Permanent link">&para;</a></h3>
<p>Next step is to add Firebase to your app on the <a href="https://firebase.google.com/console/">Firebase console</a>. Follow the following steps to add firebase to your app.</p>
<h4 id="1-create-project">1. Create project<a class="headerlink" href="#1-create-project" title="Permanent link">&para;</a></h4>
<p>Navigate to the <a href="https://firebase.google.com/console/">console</a>. If you don't already have an existing Firebase project, click on "<strong>Create new project</strong>" and follow through the steps as shown in the gif below. Else, if you have an exisiting Google project, click on "<strong>Import Google Project</strong>"</p>
<p><img alt="" src="https://i.imgur.com/knbrZ4X.gif" /></p>
<h4 id="2-add-firebase-to-your-app">2. Add Firebase to your app<a class="headerlink" href="#2-add-firebase-to-your-app" title="Permanent link">&para;</a></h4>
<p>Now that you've created the project, in the dashboard, click on "<strong>Add Firebase to your Android app</strong>". </p>
<p>To proceed, you need at least a package name unique to your app. If you plan on using Dynamic Links, Invites, and Google Sign-In support in Auth, you have to include a debug signing key SHA1 fingerprint.</p>
<p>To see your debug key SHA1 fingerprint, run the following command if you use Linux or Mac:</p>
<div class="codehilite"><pre><span></span>keytool -list -v -keystore ~/.android/debug.keystore -alias androiddebugkey -storepass android -keypass android 
</pre></div>


<p>If you're running Windows, use this command:</p>
<div class="codehilite"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="n">list</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">keystore</span> <span class="nl">C</span><span class="p">:</span><span class="err">\</span><span class="n">Documents</span> <span class="n">and</span> <span class="n">Settings</span><span class="err">\</span><span class="p">[</span><span class="n">User</span> <span class="n">Name</span><span class="p">]</span><span class="err">\</span><span class="p">.</span><span class="n">android</span><span class="err">\</span><span class="n">debug</span><span class="p">.</span><span class="n">keystore</span> <span class="o">-</span><span class="n">alias</span> <span class="n">androiddebugkey</span> <span class="o">-</span><span class="n">storepass</span> <span class="n">android</span> <span class="o">-</span><span class="n">keypass</span> <span class="n">android</span> 
</pre></div>


<p>The whole process is as shown below:</p>
<p><img alt="" src="https://i.imgur.com/qf8d55l.gif" /></p>
<h4 id="3-configure-your-app">3. Configure your app<a class="headerlink" href="#3-configure-your-app" title="Permanent link">&para;</a></h4>
<p>Clicking add app will download a <code>google-services.json</code> file. You should move this file to your projects app module directory. Usually <code>&lt;project&gt;/app</code> directory. Click continue and follow these instructions:  </p>
<ol>
<li>In your project-level build.gradle file, add the following lines (<code>&lt;project&gt;/build.gradle</code>):</li>
</ol>
<div class="codehilite"><pre><span></span><span class="n">buildscript</span> <span class="err">{</span>
  <span class="n">dependencies</span> <span class="err">{</span>
    <span class="o">//</span> <span class="k">Add</span> <span class="n">this</span> <span class="n">line</span>
    <span class="n">classpath</span> <span class="s1">&#39;com.google.gms:google-services:3.0.0&#39;</span>
  <span class="err">}</span>
<span class="err">}</span>
</pre></div>


<ol>
<li>In your app-level build.gradle (<code>&lt;project&gt;/&lt;app-module&gt;/build.gradle</code>):</li>
</ol>
<div class="codehilite"><pre><span></span><span class="n">apply</span> <span class="n">plugin</span><span class="p">:</span> <span class="s1">&#39;com.android.application&#39;</span>

<span class="n">android</span> <span class="err">{</span>
  <span class="o">//</span> <span class="p">...</span>
<span class="err">}</span>

<span class="n">dependencies</span> <span class="err">{</span>
  <span class="o">//</span> <span class="p">...</span>
  <span class="n">compile</span> <span class="s1">&#39;com.google.firebase:firebase-core:9.0.0&#39;</span>
<span class="err">}</span>

<span class="o">//</span> <span class="k">Add</span> <span class="k">to</span> <span class="n">the</span> <span class="n">bottom</span> <span class="k">of</span> <span class="n">the</span> <span class="n">file</span>
<span class="n">apply</span> <span class="n">plugin</span><span class="p">:</span> <span class="s1">&#39;com.google.gms.google-services&#39;</span>
</pre></div>


<p>Sync your gradle files with the project and you're ready to go with firebase.</p>
<h2 id="attribution">Attribution<a class="headerlink" href="#attribution" title="Permanent link">&para;</a></h2>
<p>This guide was originally drafted by <a href="segunfamisa">Segun Famisa</a>.</p>
<h2 id="references-and-further-reading">References and further reading<a class="headerlink" href="#references-and-further-reading" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="https://firebase.google.com/docs/android/setup">https://firebase.google.com/docs/android/setup</a></li>
</ol>
<h2 id="handling-progressbars">Handling ProgressBars<a class="headerlink" href="#handling-progressbars" title="Permanent link">&para;</a></h2>
<p>ProgressBar is used to display the progress of an activity while the user is waiting. You can display an <strong>indeterminate</strong> progress (spinning wheel) or <strong>result-based</strong> progress.</p>
<p><img alt="ProgressBars" src="https://i.imgur.com/1nUlHOq.png" /></p>
<h3 id="indeterminate">Indeterminate<a class="headerlink" href="#indeterminate" title="Permanent link">&para;</a></h3>
<p>We can display an indeterminate progress bar which we show to indicate waiting:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;ProgressBar</span>
  <span class="na">android:id=</span><span class="s">&quot;@+id/pbLoading&quot;</span>
  <span class="na">android:visibility=</span><span class="s">&quot;invisible&quot;</span>
  <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
  <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span> <span class="nt">/&gt;</span>
</pre></div>


<p>and then manage the visibility in the activity:</p>
<div class="codehilite"><pre><span></span><span class="c1">// on some click or some loading we need to wait for...</span>
<span class="n">ProgressBar</span> <span class="n">pb</span> <span class="o">=</span> <span class="o">(</span><span class="n">ProgressBar</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">pbLoading</span><span class="o">);</span>
<span class="n">pb</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">ProgressBar</span><span class="o">.</span><span class="na">VISIBLE</span><span class="o">);</span>
<span class="c1">// run a background job and once complete</span>
<span class="n">pb</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">ProgressBar</span><span class="o">.</span><span class="na">INVISIBLE</span><span class="o">);</span>
</pre></div>


<p>Typically you want to try to put the <code>ProgressBar</code> in the place where data is going to show (i.e. as a placeholder for an image).  For a ListView, you put the ProgressBar in the header or <a href="http://stackoverflow.com/a/4265324/313399">footer</a>, which lets you put an arbitrary layout outside of the adapter.</p>
<h3 id="result-based">Result-based<a class="headerlink" href="#result-based" title="Permanent link">&para;</a></h3>
<p>ProgressBar can be used to report the progress of a long-running AsyncTask. In this case:</p>
<ul>
<li>ProgressBar can report numerical results for a task.</li>
<li>Must specify horizontal style and result max value.</li>
<li>Must <code>publishProgress(value)</code> in your AsyncTask</li>
</ul>
<div class="codehilite"><pre><span></span><span class="nt">&lt;ProgressBar</span>
  <span class="na">android:id=</span><span class="s">&quot;@+id/progressBar1&quot;</span>
  <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
  <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
  <span class="na">android:visibility=</span><span class="s">&quot;invisible&quot;</span>
  <span class="na">style=</span><span class="s">&quot;?android:attr/progressBarStyleHorizontal&quot;</span>
  <span class="na">android:max=</span><span class="s">&quot;100&quot;</span> <span class="nt">/&gt;</span>
</pre></div>


<p>and then within the AsyncTask:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DelayTask</span> <span class="kd">extends</span> <span class="n">AsyncTask</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">,</span> <span class="n">Integer</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPreExecute</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">pb</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">ProgressBar</span><span class="o">.</span><span class="na">VISIBLE</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">doInBackground</span><span class="o">(</span><span class="n">Void</span><span class="o">...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">count</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">SystemClock</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
            <span class="n">count</span><span class="o">++;</span>
            <span class="n">publishProgress</span><span class="o">(</span><span class="n">count</span> <span class="o">*</span> <span class="mi">20</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;Complete&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onProgressUpdate</span><span class="o">(</span><span class="n">Integer</span><span class="o">...</span> <span class="n">values</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">pb</span><span class="o">.</span><span class="na">setProgress</span><span class="o">(</span><span class="n">values</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
    <span class="o">}</span>   
<span class="o">}</span>
</pre></div>


<p>and using this pattern any background tasks can be reflected by an on-screen progress report.</p>
<h2 id="progress-within-actionbar">Progress within ActionBar<a class="headerlink" href="#progress-within-actionbar" title="Permanent link">&para;</a></h2>
<p>We can add a <code>ProgressBar</code> into our <code>ActionBar</code> or <code>Toolbar</code> [[using a custom ActionView|Extended-ActionBar-Guide#adding-actionview-items]]. First, let's define the progress action-view with a layout file in <code>res/layout/action_view_progress.xml</code> with a progress-bar:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;ProgressBar</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">style=</span><span class="s">&quot;?android:attr/progressBarStyleLarge&quot;</span>
    <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
    <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
    <span class="na">android:id=</span><span class="s">&quot;@+id/pbProgressAction&quot;</span> <span class="nt">/&gt;</span>
</pre></div>


<p>Next, we can add the <code>ActionView</code> to our <code>ActionBar</code> in the <code>res/menu/activity_main.xml</code> as an <code>item</code>:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;menu</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">xmlns:app=</span><span class="s">&quot;http://schemas.android.com/apk/res-auto&quot;</span>
    <span class="na">xmlns:tools=</span><span class="s">&quot;http://schemas.android.com/tools&quot;</span> <span class="na">tools:context=</span><span class="s">&quot;.MainActivity&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;item</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/miActionProgress&quot;</span>
        <span class="na">android:title=</span><span class="s">&quot;Loading...&quot;</span>
        <span class="na">android:visible=</span><span class="s">&quot;false&quot;</span>
        <span class="na">android:orderInCategory=</span><span class="s">&quot;100&quot;</span>
        <span class="na">app:showAsAction=</span><span class="s">&quot;always&quot;</span>
        <span class="na">app:actionLayout=</span><span class="s">&quot;@layout/action_view_progress&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/menu&gt;</span>
</pre></div>


<p>Note the use of <code>android:orderInCategory</code> to append the item at the end (other items should be less than 100), <code>android:visible</code> which hides the menu item and also <code>app:actionLayout</code> which specifies the layout for the action-view. Next, we can use the <code>onPrepareOptionsMenu</code> method to get a reference to the menu item and the associated view within the activity:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">AppCompatActivity</span> <span class="o">{</span>
    <span class="c1">// Instance of the progress action-view</span>
    <span class="n">MenuItem</span> <span class="n">miActionProgressItem</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">onPrepareOptionsMenu</span><span class="o">(</span><span class="n">Menu</span> <span class="n">menu</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Store instance of the menu item containing progress</span>
        <span class="n">miActionProgressItem</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="na">findItem</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">miActionProgress</span><span class="o">);</span>
        <span class="c1">// Extract the action-view from the menu item</span>
        <span class="n">ProgressBar</span> <span class="n">v</span> <span class="o">=</span>  <span class="o">(</span><span class="n">ProgressBar</span><span class="o">)</span> <span class="n">MenuItemCompat</span><span class="o">.</span><span class="na">getActionView</span><span class="o">(</span><span class="n">miActionProgressItem</span><span class="o">);</span>
        <span class="c1">// Return to finish</span>
        <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">onPrepareOptionsMenu</span><span class="o">(</span><span class="n">menu</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Finally, we can toggle the visibility of the <code>miActionProgressItem</code> item to show and hide the progress-bar in the action-bar:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">AppCompatActivity</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">showProgressBar</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Show progress item</span>
        <span class="n">miActionProgressItem</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hideProgressBar</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Hide progress item</span>
        <span class="n">miActionProgressItem</span><span class="o">.</span><span class="na">setVisible</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>and the result:</p>
<p><img alt="Progress Action" src="https://i.imgur.com/DL6O3kT.gif" /></p>
<h2 id="progress-within-listview-footer">Progress Within ListView Footer<a class="headerlink" href="#progress-within-listview-footer" title="Permanent link">&para;</a></h2>
<p>Often the user is waiting for a list of items to be populated into a <code>ListView</code>. In these cases, we can display the progress bar at the bottom of the <code>ListView</code> using a footer. First, let's define the footer xml layout in <code>res/layout/footer_progress.xml</code>:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">android:orientation=</span><span class="s">&quot;vertical&quot;</span> <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
    <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ProgressBar</span>
        <span class="na">style=</span><span class="s">&quot;?android:attr/progressBarStyleLarge&quot;</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/pbFooterLoading&quot;</span>
        <span class="na">android:layout_gravity=</span><span class="s">&quot;center_horizontal&quot;</span>
        <span class="na">android:visibility=</span><span class="s">&quot;gone&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/LinearLayout&gt;</span>
</pre></div>


<p>Note the use of a <code>LinearLayout</code> with the <code>layout_height</code> set to <code>wrap_content</code> as this is important for the footer to be properly hidden. Next, let's setup the footer within our <code>ListView</code> by inflating and inserting the header within the activity:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">AppCompatActivity</span> <span class="o">{</span>
    <span class="c1">// ...</span>
    <span class="c1">// Store reference to the progress bar later</span>
    <span class="n">ProgressBar</span> <span class="n">progressBarFooter</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="c1">// ...</span>
        <span class="n">setupListWithFooter</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">// Adds footer to the list default hidden progress</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setupListWithFooter</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Find the ListView</span>
        <span class="n">ListView</span> <span class="n">lvItems</span> <span class="o">=</span> <span class="o">(</span><span class="n">ListView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">lvItems</span><span class="o">);</span>
        <span class="c1">// Inflate the footer</span>
        <span class="n">View</span> <span class="n">footer</span> <span class="o">=</span> <span class="n">getLayoutInflater</span><span class="o">().</span><span class="na">inflate</span><span class="o">(</span>
            <span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">footer_progress</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
        <span class="c1">// Find the progressbar within footer</span>
        <span class="n">progressBarFooter</span> <span class="o">=</span> <span class="o">(</span><span class="n">ProgressBar</span><span class="o">)</span>
                <span class="n">footer</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">pbFooterLoading</span><span class="o">);</span>
        <span class="c1">// Add footer to ListView before setting adapter</span>
        <span class="n">lvItems</span><span class="o">.</span><span class="na">addFooterView</span><span class="o">(</span><span class="n">footer</span><span class="o">);</span>
        <span class="c1">// Set the adapter AFTER adding footer</span>
        <span class="n">lvItems</span><span class="o">.</span><span class="na">setAdapter</span><span class="o">(</span><span class="n">myAdapter</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Now with the <code>progressBarFooter</code> progress-bar instance stored we can show and hide the footer with <code>setVisibility</code>:</p>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">AppCompatActivity</span> <span class="o">{</span>
    <span class="c1">// Show progress</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">showProgressBar</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">progressBarFooter</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">VISIBLE</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// Hide progress</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hideProgressBar</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">progressBarFooter</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">GONE</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Now we can call these show and hide methods as needed to show the footer in the list:</p>
<p><img src="https://i.imgur.com/43L4Y0R.gif" width="400" alt="progress in footer" /></p>
<h2 id="progress-within-dialog">Progress within Dialog<a class="headerlink" href="#progress-within-dialog" title="Permanent link">&para;</a></h2>
<p>In certain scenarios, a simple solution for displaying a progress bar during a long-running operation is to [[display a modal progress dialog|Using-DialogFragment#displaying-a-progressdialog]] indicating a task is running:</p>
<p>[[<img src="http://i.imgur.com/apLzWt6.png" width="300" />|Using-DialogFragment#displaying-a-progressdialog]]</p>
<p>Note that this modal display prevents the user from interacting with the app until the task is completed. As a result, the progress indicators above generally provide a better user experience.</p>
<h2 id="third-party-libraries">Third-party Libraries<a class="headerlink" href="#third-party-libraries" title="Permanent link">&para;</a></h2>
<p>See this <a href="https://github.com/wasabeef/awesome-android-ui/blob/master/pages/Progress.md">list of third-party progress bars</a> for alternate styles and animations.</p>
<p><img alt="NumberProgress" src="https://github.com/wasabeef/awesome-android-ui/raw/master/art/NumberProgressBar.gif" /></p>
<p>The <a href="https://github.com/daimajia/NumberProgressBar">NumberProgressBar</a> is featured above for example.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../android-permissions/" title="Understanding Android Permissions" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Understanding Android Permissions
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset" style="background-color: #ff9900; color: #fff">
    <div class="md-grid" style="display: flex;">
      <div style="flex: 1;">
        <h2>Consulting</h2>
        <ul style="list-style: none; margin-left: -15px;">
          <li><a href="https://www.peruzal.com/mobile-app-development" target="_blank">Mobile App Development</a></li>
          <li><a href="https://www.peruzal.com/mobile-app-device-security-and-penetration-testing" target="_blank">Mobile App Security and Penetration Testing</a></li>
          <li><a href="https://www.peruzal.com/database-and-web-application-performance-tuning-and-consulting" target="_blank">Database Performance Tuning</a></li>
        </ul>
      </div>
      <div style="flex: 1;">
        <h2>Training</h2>
        <ul style="list-style: none; margin-left: -15px;">
          <li><a href="https://training.peruzal.com/courses/mobile/android-mobile-app-development-training-certification" target="_blank">Android Mobile App Development Training</a></li>
          <li><a href="https://training.peruzal.com/courses/mobile/ios-mobile-app-development-training-with-swift" target="_blank">iOS Mobile App Development Training</a></li>
          <li><a href="https://training.peruzal.com/courses/mobile/xamarin/xamarin-forms-mobile-app-development-training" target="_blank">Xamarin Forms Training</a></li>
          <li><a href="https://training.peruzal.com/courses/mobile/xamarin/android-mobile-app-development-training-with-xamarin" target="_blank">Xamarin Android Training</a></li>
          <li><a href="https://training.peruzal.com/courses/mobile/xamarin/ios-mobile-app-development-training-with-xamarin" target="_blank">Xamarin iOS Training</a></li>
          <li><a href="https://training.peruzal.com/courses/web/reactjs-front-end-web-application-development" target="_blank">ReactJS Training</a></li>
          <li><a href="https://training.peruzal.com/courses/web/reactjs-front-end-web-application-development" target="_blank">React Native Training</a></li>
          <li><a href="https://training.peruzal.com/courses/gaming/unity-certified-game-development-training-south-africa" target="_blank">Unity Game Development Training</a></li>
          <li><a href="https://training.peruzal.com/courses/database/mysql-database-administration-training-certification-south-africa" target="_blank">MySQL Database Adminstration Training</a></li>
          <li><a href="https://training.peruzal.com/courses/programming/java-programming-training-certification" target="_blank">Java Programming Training</a></li>
          <li><a href="https://training.peruzal.com/courses/programming/ruby-programming-training-certification" target="_blank">Ruby Programming Training</a></li>
        </ul>
      </div>
      <div style="flex: 1">
        <h2>Resources</h2>
        <ul style="list-style: none; margin-left: -15px;">
          <li><a href="http://guides.peruzal.com/xamarin-forms-guide" target="_blank">Xamarin Forms Guide</a></li>
          <li><a href="http://guides.peruzal.com/v1/android-guides" target="_blank">Android Development Guides</a></li>
          <li><a href="http://guides.peruzal.com/xamarin-ios" target="_blank">iOS Development Guides</a></li>
          <li><a href="http://xamarin-android-guide.peruzal.com/" target="_blank">Xamarin Android Guides</a></li>
          <li><a href="http://xamarin-ios-guide.peruzal.com/" target="_blank">Xamarin iOS Guide</a></li>
          <li><a href="http://unity-certified-associate-guide.peruzal.com/" target="_blank">Unity Game Development Guide</a></li>
          <li><a href="https://josephkandi.gitbooks.io/mysql-5-6-database-administration-certification-g/content/" target="_blank">MySQL Database Adminstration Guide</a></li>
          <li><a href="https://josephkandi.gitbooks.io/learn-java-by-developing-an-android-app/content/" target="_blank">Java Programming Guide</a></li>
        </ul>
      </div>
    </div>
    <div class="md-footer-meta__inner" style="background-color: rgba(0,0,0,.87)">
      <div style="text-align: center; font-size: 0.7rem">
          <div class="md-footer-copyright__highlight">
            <a href="https://www.peruzal.com" target="_blank">Copyright &copy 2019 - Peruzal</a>
          </div>
      </div>
      
  <div style="text-align: center">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/peruzal" target="_blank" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/peruzal" target="_blank" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-40772582-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-40772582-8');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-6342782466521705",
          enable_page_level_ads: true
     });
</script>
      
    </div>
    
      <script src="../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../assets/js/utils.js"></script>
      
        <script src="../assets/js/mixpanel.js"></script>
      
        <script src="../assets/js/track.js"></script>
      
        <script src="../assets/js/drift.js"></script>
      
    
  </body>
</html>