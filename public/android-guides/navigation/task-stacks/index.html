



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Navigation and Task Stacks">
      
      
        <link rel="canonical" href="https://guides.peruzal.com/xamarin-forms-guide/navigation/task-stacks/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Navigation and Task Stacks - Android Mobile App Development Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="#ffa000">
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="amber" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#navigation-and-task-stacks" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://guides.peruzal.com/xamarin-forms-guide" title="Android Mobile App Development Guide" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo-lines.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Android Mobile App Development Guide
            </span>
            <span class="md-header-nav__topic">
              
                Navigation and Task Stacks
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/Peruzal/xamarin-forms-guide/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Github
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://guides.peruzal.com/xamarin-forms-guide" title="Android Mobile App Development Guide" class="md-nav__button md-logo">
      
        <img src="../../images/logo-lines.png" width="48" height="48">
      
    </a>
    Android Mobile App Development Guide
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/Peruzal/xamarin-forms-guide/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../project-structure/" title="Android Project Structure" class="md-nav__link">
      Android Project Structure
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../android-resources/" title="Understanding App Resources" class="md-nav__link">
      Understanding App Resources
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Android Common View
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Android Common View
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/view-attributes/" title="View Attributes" class="md-nav__link">
      View Attributes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/textview/" title="TextView" class="md-nav__link">
      TextView
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/button/" title="Button" class="md-nav__link">
      Button
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/edittext/" title="EditText" class="md-nav__link">
      EditText
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/image-view/" title="ImageView" class="md-nav__link">
      ImageView
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/image-button/" title="ImageButton" class="md-nav__link">
      ImageButton
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/radio-button/" title="RadioButton" class="md-nav__link">
      RadioButton
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/view/" title="View" class="md-nav__link">
      View
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/spinner/" title="Spinner" class="md-nav__link">
      Spinner
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/checkbox/" title="CheckBox" class="md-nav__link">
      CheckBox
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/switch/" title="Switch" class="md-nav__link">
      Switch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/seek-bar/" title="SeekBar" class="md-nav__link">
      SeekBar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/rating-bar/" title="RatingBar" class="md-nav__link">
      RatingBar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/progress-bar/" title="ProgressBar" class="md-nav__link">
      ProgressBar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android-common-views/search-view/" title="SearchView" class="md-nav__link">
      SearchView
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Layouts
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Layouts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../layouts/overview/" title="Layouts Overview" class="md-nav__link">
      Layouts Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../layouts/linear-layout/" title="Linear Layout" class="md-nav__link">
      Linear Layout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../layouts/relative-layout/" title="Relative Layout" class="md-nav__link">
      Relative Layout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../layouts/frame-layout/" title="Frame Layout" class="md-nav__link">
      Frame Layout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../layouts/layout-prformance/" title="Optimizing Layout Performance" class="md-nav__link">
      Optimizing Layout Performance
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../activities/" title="Activities" class="md-nav__link">
      Activities
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Navigation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Navigation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../common-navigation-patterns/" title="Common Navigation Patterns" class="md-nav__link">
      Common Navigation Patterns
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../intents/" title="Navigation with Intents" class="md-nav__link">
      Navigation with Intents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../swipe-tabbed-navigation/" title="Swipe and Tabbed Navigation" class="md-nav__link">
      Swipe and Tabbed Navigation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../navigation-drawer/" title="Navigation Drawer" class="md-nav__link">
      Navigation Drawer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bottom-navigation/" title="Bottom Navigation" class="md-nav__link">
      Bottom Navigation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Navigation and Task Stacks
      </label>
    
    <a href="./" title="Navigation and Task Stacks" class="md-nav__link md-nav__link--active">
      Navigation and Task Stacks
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conceptual-overview" title="Conceptual Overview" class="md-nav__link">
    Conceptual Overview
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-the-task-stack" title="Understanding the Task Stack" class="md-nav__link">
    Understanding the Task Stack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-stacks-everywhere" title="Task Stacks Everywhere" class="md-nav__link">
    Task Stacks Everywhere
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-activity-instances" title="Multiple Activity Instances" class="md-nav__link">
    Multiple Activity Instances
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#affinity-groups" title="Affinity Groups" class="md-nav__link">
    Affinity Groups
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-activity-properties" title="Configuring Activity Properties" class="md-nav__link">
    Configuring Activity Properties
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#launch-modes" title="Launch Modes" class="md-nav__link">
    Launch Modes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-no-history" title="Configuring No History" class="md-nav__link">
    Configuring No History
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-intent-flags" title="Configuring Intent Flags" class="md-nav__link">
    Configuring Intent Flags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../common-intents/" title="Common Intents" class="md-nav__link">
      Common Intents
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../fragments/" title="Fragments" class="md-nav__link">
      Fragments
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../common-intents/" title="Common Intents" class="md-nav__link">
      Common Intents
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../android-permissions/" title="Understanding Android Permissions" class="md-nav__link">
      Understanding Android Permissions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../networking/" title="Networking" class="md-nav__link">
      Networking
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conceptual-overview" title="Conceptual Overview" class="md-nav__link">
    Conceptual Overview
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-the-task-stack" title="Understanding the Task Stack" class="md-nav__link">
    Understanding the Task Stack
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-stacks-everywhere" title="Task Stacks Everywhere" class="md-nav__link">
    Task Stacks Everywhere
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-activity-instances" title="Multiple Activity Instances" class="md-nav__link">
    Multiple Activity Instances
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#affinity-groups" title="Affinity Groups" class="md-nav__link">
    Affinity Groups
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-activity-properties" title="Configuring Activity Properties" class="md-nav__link">
    Configuring Activity Properties
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#launch-modes" title="Launch Modes" class="md-nav__link">
    Launch Modes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-no-history" title="Configuring No History" class="md-nav__link">
    Configuring No History
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuring-intent-flags" title="Configuring Intent Flags" class="md-nav__link">
    Configuring Intent Flags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Peruzal/xamarin-forms-guide/edit/master/docs/navigation/task-stacks.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="navigation-and-task-stacks">Navigation and Task Stacks<a class="headerlink" href="#navigation-and-task-stacks" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The core of navigation flows in Android apps centers around the Activity and the Intent. In this guide, we are going to review tasks, navigation, and how to manipulate these when navigating between activities.  </p>
<p>This is typically used in cases where we need to exert more fine-tuned control over the behavior of the task stack which determines the "history" of our application.</p>
<p><strong>Note:</strong> To skip to changing the behavior of the task stack, jump right to the [[Usage|Navigation-and-Task-Stacks#usage]] section of this document.</p>
<h2 id="conceptual-overview">Conceptual Overview<a class="headerlink" href="#conceptual-overview" title="Permanent link">&para;</a></h2>
<p>While the concept of using intents to launch activities should already be familiar to you, let's take a second to explore how launching new activities works and how this navigation is managed. </p>
<p>As we navigate around our app (or even between apps), Android is maintaining a <strong>task stack</strong> which tracks each step in the user's history. A <strong>task</strong> is a collection of activities that users interact with when performing a certain job. The activities are arranged in a stack (the "back stack"), in the order in which each activity is opened.  By default, your activities in your app are organized as part of the same <strong>task affinity group</strong>.</p>
<h3 id="understanding-the-task-stack">Understanding the Task Stack<a class="headerlink" href="#understanding-the-task-stack" title="Permanent link">&para;</a></h3>
<p>When an application is launched from the Home Screen, the application comes to the foreground and the "stack" for that application becomes active. If no task stack exists for this application (first launch recently), then a new task is created and the "main" activity of the app becomes the first (root) item in the stack.</p>
<p>Each time an activity is launched in your app, that activity is pushed onto the top of the stack and becomes active. The previous activity remains in the stack but it is stopped. However, despite being stopped the system retains the state of the Activity UI automatically.</p>
<p><img alt="Task Stack" src="http://developer.android.com/images/fundamentals/diagram_backstack.png" /></p>
<p>If the user hits "back", the current activity is popped from the top of the stack (and destroyed) and the previous activity resumes with the previous UI state restored. If the user continues to press Back, then each activity in the stack is popped off to reveal the previous one, until the user returns to whichever task was happening before this task stack began.</p>
<h3 id="task-stacks-everywhere">Task Stacks Everywhere<a class="headerlink" href="#task-stacks-everywhere" title="Permanent link">&para;</a></h3>
<p>A "task" is a collection of activities stemming from a "root" application. This group is cohesive and when the user hits the home screen, the entire "task" is moved to the background until the stack is re-activated. While in the background, all the activities in the task are stopped, but the back stack for the task remains intact.</p>
<p><img alt="MultiTasking" src="http://developer.android.com/images/fundamentals/diagram_multitasking.png" /></p>
<p>If the user were to open another separate application now, that app would have an entirely separate task stack that would come to the foreground. This means that <strong>multiple discrete stacks</strong> frequently are stored by the system. There might be several task stacks in the background and when the user re-enters the related application, that stack will reappear in the foreground with states restored.</p>
<h3 id="multiple-activity-instances">Multiple Activity Instances<a class="headerlink" href="#multiple-activity-instances" title="Permanent link">&para;</a></h3>
<p>This process of multiple task stacks is just the beginning. The real point of understanding comes from exploring what happens when we launch the same activity multiple times. Because the activities in the back stack are never rearranged, every time an activity is started via an intent, a brand new instance of that activity is <strong>created and pushed onto the stack</strong>.</p>
<p>This means that if you have an activity (say the timeline for twitter), and you launch the timeline activity multiple times using different intents, then <strong>multiple instances of that activity</strong> will be tracked in the stack. </p>
<p><img alt="Multiple Activity" src="http://developer.android.com/images/fundamentals/diagram_multiple_instances.png" /></p>
<p>This gets even more complex when you consider you might launch the same Activity from multiple <strong>different</strong> task stacks. For example, think about how many apps might launch the browser and how many instances of a browser you might have across all task stacks.</p>
<p>By default, if the user navigates backward using the Back button, each instance of the activity is revealed in the order in which they were opened (each with their own UI state). </p>
<p>See <a href="http://developer.android.com/guide/components/tasks-and-back-stack.html">Tasks and Back Stack</a> official guide for the source of the above content and additional details.</p>
<h2 id="affinity-groups">Affinity Groups<a class="headerlink" href="#affinity-groups" title="Permanent link">&para;</a></h2>
<p>Activities within your application all belong to the same affinity group unless you define one differently using the <code>taskAffinity</code> XML property:</p>
<div class="codehilite"><pre><span></span><span class="o">&lt;</span><span class="n">activity</span> <span class="n">android</span><span class="o">:</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;.activities.MyActivity&quot;</span>
<span class="nl">android:</span><span class="n">taskAffinity</span><span class="o">=</span><span class="s">&quot;com.codepath.myapp&quot;</span><span class="o">&gt;</span>
</pre></div>


<p>You can group activities together in this way to dismiss them all at once:</p>
<div class="codehilite"><pre><span></span><span class="n">ActivityCompat</span><span class="o">.</span><span class="na">finishAffinity</span><span class="o">(</span><span class="k">this</span><span class="o">);</span> <span class="c1">// equivalent to finish(true); on Android devices API &gt; 4</span>
</pre></div>


<p>When using <code>finishAffinity()</code>, you may notice that the activity can still show up in the <a href="https://developer.android.com/guide/components/recents.html">Most Recents</a> screen.  You can use the <code>android:autoRemoveFromRecents</code> flag to be true to remove it, which is normally set to false by default.  You can also use <code>finishAndRemoveTask()</code> to accomplish the same effect.</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.MyActivity&quot;</span>
<span class="na">android:autoRemoveFromRecents=</span><span class="s">&quot;true&quot;</span>
<span class="na">android:taskAffinity=</span><span class="s">&quot;com.codepath.myapp&quot;</span><span class="nt">/&gt;</span>
</pre></div>


<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>The behavior described above works automatically and without any special configuration from the developer. The default behavior is to just place all activities started in succession in the same task and in a "last in, first out" stack.</p>
<p>However, there are cases where this behavior may not suit your needs. In the event that you want to tune or tweak this behavior, we need to understand how to change the behavior of our task stack. For example, we might want to:</p>
<ul>
<li>Have an activity in your application to begin a new task when it is started</li>
<li>Want to bring forward an existing instance of an activity (rather than create a new one)</li>
<li>Want to clear the history of the back stack at a particular point</li>
</ul>
<p>In order to change this behavior, there are two approaches available:</p>
<ul>
<li><strong>Activity Properties</strong> - Setting properties on the activity within the manifest that changes the task stack behavior.</li>
<li><strong>Intent Flags</strong> - Adding flags to an intent in order to change the task stack behavior for that launch.</li>
</ul>
<p>If you always want an Activity to show a particular kind of behaviour then you will set the property in the <code>&lt;activity&gt;</code> element corresponding to that Activity in the manifest.</p>
<p>If you only want to exclude it from recent tasks under certain one-off conditions then you set the flag in the Intent and not the manifest.</p>
<h3 id="configuring-activity-properties">Configuring Activity Properties<a class="headerlink" href="#configuring-activity-properties" title="Permanent link">&para;</a></h3>
<p>The first approach to modifying the task stack is to set properties on the <a href="http://developer.android.com/guide/topics/manifest/activity-element.html"><activity></a> element within the <code>AndroidManifest.xml</code>. </p>
<h4 id="launch-modes">Launch Modes<a class="headerlink" href="#launch-modes" title="Permanent link">&para;</a></h4>
<p>To tweak the behavior of the Activity in the manifest, we want to set the <code>launchMode</code> attribute. This looks like:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;com.example.todoapp&quot;</span>
    <span class="err">…</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;application</span>
        <span class="na">android:icon=</span><span class="s">&quot;@drawable/ic_launcher&quot;</span>
        <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span>
        <span class="err">...</span> <span class="nt">&gt;</span>
        <span class="nt">&lt;activity</span>
            <span class="na">android:name=</span><span class="s">&quot;com.example.todoapp.TodoActivity&quot;</span>
            <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span> 
            <span class="na">android:launchMode=</span><span class="s">&quot;singleTop&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>
    <span class="nt">&lt;/application&gt;</span>
<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<p>Notice there we have specified the <code>launchMode</code> as "singleTop". There are four different "launch modes" to choose from that alter the task stack behaviors for that activity:</p>
<ul>
<li><code>standard</code> - The default behavior. Creates a new instance of the activity in the task.</li>
<li><code>singleTop</code> - Reuse an activity instance if already at the top of the stack; otherwise create new instance.</li>
<li><code>singleTask</code> - Reuse an activity instance if exists in an existing stack; otherwise create in a new task stack.</li>
<li><code>singleInstance</code> - Same as <code>singleTask</code> but no other activities are ever inserted into the created task stack.</li>
</ul>
<p>See the <a href="http://developer.android.com/guide/components/tasks-and-back-stack.html#ManifestForTasks">official guide for stacks</a> for a more detailed explanation. This table may help clarify the different launch modes:</p>
<table>
<thead>
<tr>
<th>Mode</th>
<th>Default</th>
<th>Instantiation</th>
<th>New Task on Launch</th>
<th>Allow other activities within Task</th>
</tr>
</thead>
<tbody>
<tr>
<td>standard</td>
<td>Yes</td>
<td>Everytime an intent is created, a new instance is created. Also instances can be member of multiple tasks and more than one instance in a Task.</td>
<td>No. Open in the same Task that originated the intent</td>
<td>Yes</td>
</tr>
<tr>
<td>singleTop</td>
<td>No</td>
<td>Exactly like standard but if the activity is at the top of the Task stack then it uses the existing instance.</td>
<td>No. Open in the same Task that originated the intent</td>
<td>Yes</td>
</tr>
<tr>
<td>singleTask</td>
<td>No</td>
<td>Single instance</td>
<td>Yes. Always a Root Task.</td>
<td>Yes</td>
</tr>
<tr>
<td>singleInstance</td>
<td>No</td>
<td>Single instance</td>
<td>Yes. Always a Root Task.</td>
<td>Never. Always the only activity in the task</td>
</tr>
</tbody>
</table>
<p>It might be useful to understand when various modes might be appropriate in an application. The following provides examples:</p>
<ul>
<li><code>singleTask</code> - There is only one <code>BrowserActivity</code> at a time and it doesn't become part of tasks that send it intents to open web pages. While it might return to whatever most recently launched it when you hit back it is actually fixed at the bottom of its own task activity stack. </li>
<li><code>singleTop</code> - While there can be multiple instances of the <code>BrowserBookmarksPage</code> if there is already one at the top of the task's activity stack it will be reused. This way you only have to hit back once to return to the browser if the bookmarks activity is started multiple times.</li>
<li><code>singleInstance</code> - Only one <code>AlarmAlert</code> activity at a time and it is always its own task. Anything it might launch (if anything) becomes a part of a separate task stack.</li>
</ul>
<p>Check out the <a href="http://www.intridea.com/blog/2011/6/16/android-understanding-activity-launchmode">understanding launch modes</a> guide for more detailed examples. Also check out <a href="http://blog.akquinet.de/2011/02/25/android-activities-and-tasks-series-%E2%80%93-activity%C2%A0attributes/">this blog post</a> for another explanation.</p>
<h4 id="configuring-no-history">Configuring No History<a class="headerlink" href="#configuring-no-history" title="Permanent link">&para;</a></h4>
<p>There are additional properties as well that can be set on an activity. For example, if an activity should not be added to the task stack at all, simply set the <a href="http://developer.android.com/guide/topics/manifest/activity-element.html#nohist">noHistory</a> flag within the manifest:</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class="na">package=</span><span class="s">&quot;com.example.todoapp&quot;</span>
    <span class="err">…</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;application</span>
        <span class="na">android:icon=</span><span class="s">&quot;@drawable/ic_launcher&quot;</span>
        <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span>
        <span class="err">...</span> <span class="nt">&gt;</span>
        <span class="nt">&lt;activity</span>
            <span class="na">android:name=</span><span class="s">&quot;com.example.todoapp.TodoActivity&quot;</span>
            <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span> 
            <span class="na">android:noHistory=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>
    <span class="nt">&lt;/application&gt;</span>
<span class="nt">&lt;/manifest&gt;</span>
</pre></div>


<p>Once this is set, that activity will never be a part of the stack even when launched. You might also want to check out the <a href="http://developer.android.com/guide/topics/manifest/activity-element.html#aff">taskAffinity</a> property as well as the <a href="http://developer.android.com/guide/topics/manifest/activity-element.html#reparent">allowTaskReparenting</a> properties for more fine tuned control over the activity's behavior in the task stack.</p>
<h3 id="configuring-intent-flags">Configuring Intent Flags<a class="headerlink" href="#configuring-intent-flags" title="Permanent link">&para;</a></h3>
<p>The other approach to modifying the task stack is to <a href="http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_TASK">set flags</a> within an intent when starting an Activity.</p>
<p>You can alter the task stack behavior by appending various flags when launching an intent. For example, to clear the task stack when starting a new activity, we can do:</p>
<div class="codehilite"><pre><span></span><span class="n">Intent</span> <span class="n">i</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">SecondActivity</span><span class="o">.</span><span class="na">this</span><span class="o">);</span>
<span class="c1">// Add flags into the intent to alter behavior</span>
<span class="n">i</span><span class="o">.</span><span class="na">intent</span><span class="o">.</span><span class="na">setFlags</span><span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">FLAG_ACTIVITY_NEW_TASK</span> <span class="o">|</span>
<span class="n">IntentCompat</span><span class="o">.</span><span class="na">FLAG_ACTIVITY_CLEAR_TASK</span><span class="o">);</span>
<span class="c1">// Execute as normal</span>
<span class="n">startActivity</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
</pre></div>


<p>The above can be very useful for login activities. The flags launch a new activity such that when the user presses "back", the previous activity would not show up. The following other flags are available to be set on the intent:</p>
<ul>
<li><code>FLAG_ACTIVITY_CLEAR_TASK</code> - Clear any existing tasks on this stack before starting the activity.</li>
<li><code>FLAG_ACTIVITY_NEW_TASK</code> - Start the activity in a new task or reuse an existing task tied to that activity.</li>
<li><code>FLAG_ACTIVITY_SINGLE_TOP</code> - If the activity being started is the same as the current activity, then reuses the existing instance which receives a call to <a href="http://developer.android.com/reference/android/app/Activity.html#onNewIntent(android.content.Intent)">onNewIntent()</a></li>
<li><code>FLAG_ACTIVITY_CLEAR_TOP</code> - If the activity being started is already running in the current task, delivers us back to the existing instance and clears the stack.</li>
</ul>
<p>There are almost a dozen other flags you can set as well, for example <code>FLAG_ACTIVITY_BROUGHT_TO_FRONT</code>, <code>FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS</code>, and <code>FLAG_ACTIVITY_MULTIPLE_TASK</code>.  For a more comprehensive list, check out <a href="http://blog.akquinet.de/2010/04/15/android-activites-and-tasks-series-intent-flags/">this article</a>. </p>
<p>See the <a href="http://developer.android.com/guide/components/tasks-and-back-stack.html#IntentFlagsForTasks">official guide for stacks</a> for a more detailed explanation.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../bottom-navigation/" title="Bottom Navigation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Bottom Navigation
              </span>
            </div>
          </a>
        
        
          <a href="../common-intents/" title="Common Intents" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Common Intents
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset" style="background-color: #ff9900; color: #fff">
    <div class="md-grid" style="display: flex;">
      <div style="flex: 1;">
        <h2>Consulting</h2>
        <ul style="list-style: none; margin-left: -15px;">
          <li><a href="https://www.peruzal.com/mobile-app-development" target="_blank">Mobile App Development</a></li>
          <li><a href="https://www.peruzal.com/mobile-app-device-security-and-penetration-testing" target="_blank">Mobile App Security and Penetration Testing</a></li>
          <li><a href="https://www.peruzal.com/database-and-web-application-performance-tuning-and-consulting" target="_blank">Database Performance Tuning</a></li>
        </ul>
      </div>
      <div style="flex: 1;">
        <h2>Training</h2>
        <ul style="list-style: none; margin-left: -15px;">
          <li><a href="https://training.peruzal.com/courses/mobile/android-mobile-app-development-training-certification" target="_blank">Android Mobile App Development Training</a></li>
          <li><a href="https://training.peruzal.com/courses/mobile/ios-mobile-app-development-training-with-swift" target="_blank">iOS Mobile App Development Training</a></li>
          <li><a href="https://training.peruzal.com/courses/mobile/xamarin/xamarin-forms-mobile-app-development-training" target="_blank">Xamarin Forms Training</a></li>
          <li><a href="https://training.peruzal.com/courses/mobile/xamarin/android-mobile-app-development-training-with-xamarin" target="_blank">Xamarin Android Training</a></li>
          <li><a href="https://training.peruzal.com/courses/mobile/xamarin/ios-mobile-app-development-training-with-xamarin" target="_blank">Xamarin iOS Training</a></li>
          <li><a href="https://training.peruzal.com/courses/web/reactjs-front-end-web-application-development" target="_blank">ReactJS Training</a></li>
          <li><a href="https://training.peruzal.com/courses/web/reactjs-front-end-web-application-development" target="_blank">React Native Training</a></li>
          <li><a href="https://training.peruzal.com/courses/gaming/unity-certified-game-development-training-south-africa" target="_blank">Unity Game Development Training</a></li>
          <li><a href="https://training.peruzal.com/courses/database/mysql-database-administration-training-certification-south-africa" target="_blank">MySQL Database Adminstration Training</a></li>
          <li><a href="https://training.peruzal.com/courses/programming/java-programming-training-certification" target="_blank">Java Programming Training</a></li>
          <li><a href="https://training.peruzal.com/courses/programming/ruby-programming-training-certification" target="_blank">Ruby Programming Training</a></li>
        </ul>
      </div>
      <div style="flex: 1">
        <h2>Resources</h2>
        <ul style="list-style: none; margin-left: -15px;">
          <li><a href="http://guides.peruzal.com/xamarin-forms-guide" target="_blank">Xamarin Forms Guide</a></li>
          <li><a href="http://guides.peruzal.com/v1/android-guides" target="_blank">Android Development Guides</a></li>
          <li><a href="http://guides.peruzal.com/xamarin-ios" target="_blank">iOS Development Guides</a></li>
          <li><a href="http://xamarin-android-guide.peruzal.com/" target="_blank">Xamarin Android Guides</a></li>
          <li><a href="http://xamarin-ios-guide.peruzal.com/" target="_blank">Xamarin iOS Guide</a></li>
          <li><a href="http://unity-certified-associate-guide.peruzal.com/" target="_blank">Unity Game Development Guide</a></li>
          <li><a href="https://josephkandi.gitbooks.io/mysql-5-6-database-administration-certification-g/content/" target="_blank">MySQL Database Adminstration Guide</a></li>
          <li><a href="https://josephkandi.gitbooks.io/learn-java-by-developing-an-android-app/content/" target="_blank">Java Programming Guide</a></li>
        </ul>
      </div>
    </div>
    <div class="md-footer-meta__inner" style="background-color: rgba(0,0,0,.87)">
      <div style="text-align: center; font-size: 0.7rem">
          <div class="md-footer-copyright__highlight">
            <a href="https://www.peruzal.com" target="_blank">Copyright &copy 2019 - Peruzal</a>
          </div>
      </div>
      
  <div style="text-align: center">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/peruzal" target="_blank" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/peruzal" target="_blank" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-40772582-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-40772582-8');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-6342782466521705",
          enable_page_level_ads: true
     });
</script>
      
    </div>
    
      <script src="../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../assets/js/utils.js"></script>
      
        <script src="../../assets/js/mixpanel.js"></script>
      
        <script src="../../assets/js/track.js"></script>
      
        <script src="../../assets/js/drift.js"></script>
      
    
  </body>
</html>