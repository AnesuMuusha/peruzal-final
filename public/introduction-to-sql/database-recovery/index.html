<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Database Recovery - Introduction to SQL</title>
    <meta name="generator" content="Hugo 0.19" />

    
    <meta name="description" content="Introduction to SQL Guide">
    
    <link rel="canonical" href="http://guides.peruzal.com/introduction-to-sql/database-recovery/">
    
    <meta name="author" content="Peruzal">
    

    <meta property="og:url" content="http://guides.peruzal.com/introduction-to-sql/database-recovery/">
    <meta property="og:title" content="Introduction to SQL">
    <meta property="og:image" content="http://guides.peruzal.com/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Introduction to SQL">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://guides.peruzal.com/introduction-to-sql/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="http://guides.peruzal.com/introduction-to-sql/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://guides.peruzal.com/introduction-to-sql/fonts/icon.eot');
        src: url('http://guides.peruzal.com/introduction-to-sql/fonts/icon.eot')
               format('embedded-opentype'),
             url('http://guides.peruzal.com/introduction-to-sql/fonts/icon.woff')
               format('woff'),
             url('http://guides.peruzal.com/introduction-to-sql/fonts/icon.ttf')
               format('truetype'),
             url('http://guides.peruzal.com/introduction-to-sql/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://guides.peruzal.com/introduction-to-sql/stylesheets/application.css">
    <link rel="stylesheet" href="http://guides.peruzal.com/introduction-to-sql/stylesheets/temporary.css">
    <link rel="stylesheet" href="http://guides.peruzal.com/introduction-to-sql/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://guides.peruzal.com/introduction-to-sql/stylesheets/highlight/highlight.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/styles/github-gist.min.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="http://guides.peruzal.com/introduction-to-sql/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-deep-orange palette-accent-light-blue">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Database Recovery
      </div>
    </div>

    
    <div class="button button-twitter" role="button" aria-label="Twitter">
       <a href="https://twitter.com/peruzal" title="@peruzal on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
    </div>
    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/peruzal" title="@peruzal on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://guides.peruzal.com/introduction-to-sql" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://guides.peruzal.com/introduction-to-sql/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Introduction to SQL <span class="version">1.0.0</span></strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Understanding SQL" href="http://guides.peruzal.com/introduction-to-sql/understanding-sql/">
	
	Understanding SQL
</a>



  
</li>



<li>
  
    



<a  title="Retrieving Data" href="http://guides.peruzal.com/introduction-to-sql/retrieving-data/">
	
	Retrieving Data
</a>



  
</li>



<li>
  
    



<a  title="Sorting Data" href="http://guides.peruzal.com/introduction-to-sql/sorting-data/">
	
	Sorting Data
</a>



  
</li>



<li>
  
    



<a  title="Filtering Data" href="http://guides.peruzal.com/introduction-to-sql/filtering-data/">
	
	Filtering Data
</a>



  
</li>



<li>
  
    



<a  title="Functions Data" href="http://guides.peruzal.com/introduction-to-sql/functions/">
	
	Functions Data
</a>



  
</li>



<li>
  
    



<a  title="Grouping Data" href="http://guides.peruzal.com/introduction-to-sql/grouping-data/">
	
	Grouping Data
</a>



  
</li>



<li>
  
    



<a  title="Sub Queries" href="http://guides.peruzal.com/introduction-to-sql/subqueries/">
	
	Sub Queries
</a>



  
</li>



<li>
  
    



<a  title="Joining Tables" href="http://guides.peruzal.com/introduction-to-sql/joining-tables/">
	
	Joining Tables
</a>



  
</li>



<li>
  
    



<a  title="Inserting Data" href="http://guides.peruzal.com/introduction-to-sql/inserting-data/">
	
	Inserting Data
</a>



  
</li>



<li>
  
    



<a  title="Updating Data" href="http://guides.peruzal.com/introduction-to-sql/updating-data/">
	
	Updating Data
</a>



  
</li>



<li>
  
    



<a  title="Deleting Data" href="http://guides.peruzal.com/introduction-to-sql/deleting-data/">
	
	Deleting Data
</a>



  
</li>



<li>
  
    



<a  title="Working with Tables" href="http://guides.peruzal.com/introduction-to-sql/working-with-tables/">
	
	Working with Tables
</a>



  
</li>



<li>
  
    



<a  title="Views" href="http://guides.peruzal.com/introduction-to-sql/views/">
	
	Views
</a>



  
</li>



<li>
  
    



<a  title="Stored Procedures" href="http://guides.peruzal.com/introduction-to-sql/stored-procedures/">
	
	Stored Procedures
</a>



  
</li>



<li>
  
    



<a  title="Transaction" href="http://guides.peruzal.com/introduction-to-sql/transactions/">
	
	Transaction
</a>



  
</li>



<li>
  
    



<a  title="Advanced SQL Features" href="http://guides.peruzal.com/introduction-to-sql/advanced-sql-features/">
	
	Advanced SQL Features
</a>



  
</li>



<li>
  
    



<a  title="Calculated Fields" href="http://guides.peruzal.com/introduction-to-sql/calculated-fields/">
	
	Calculated Fields
</a>



  
</li>



<li>
  
    



<a  title="Installing SQL Server" href="http://guides.peruzal.com/introduction-to-sql/installing-sql-server/">
	
	Installing SQL Server
</a>



  
</li>



<li>
  
    



<a  title="SQL Server Architecture" href="http://guides.peruzal.com/introduction-to-sql/sql-server-architecture/">
	
	SQL Server Architecture
</a>



  
</li>



<li>
  
    



<a class="current" title="Database Recovery" href="http://guides.peruzal.com/introduction-to-sql/database-recovery/">
	
	Database Recovery
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    



<a  title="Security" href="http://guides.peruzal.com/introduction-to-sql/database-security/">
	
	Security
</a>



  
</li>



<li>
  
    



<a  title="AlwaysOn Availability Groups" href="http://guides.peruzal.com/introduction-to-sql/sql-server-alwayson/">
	
	AlwaysOn Availability Groups
</a>



  
</li>



<li>
  
    



<a  title="Intro to SQL" href="http://guides.peruzal.com/introduction-to-sql/">
	
	Intro to SQL
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          
          <li>
            <a href="https://twitter.com/peruzal" target="_blank" title="@peruzal on Twitter">
              @peruzal on Twitter
            </a>
          </li>
          

          
          <li>
            <a href="https://github.com/peruzal" target="_blank" title="@peruzal on GitHub">
              @peruzal on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="mailto:hello@peruzal.com" title="Email of hello@peruzal.com">
              Contact via email
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Database Recovery </h1>

			

<h2 id="backup-and-restore-operations">Backup and Restore Operations</h2>

<p>Database backup is the process of dumping data (from a database, a transaction log, or a file) into backup devices that the system creates and maintains. A backup device can be a disk file or a tape. The Database Engine provides both static and dynamic backups. Static backup means that during the backup process, the only active session supported by the system is the one that creates the backup. In other words, user processes are not allowed during backup. Dynamic backup means that a database backup can be performed without stopping the database server, removing users, or even closing the files.</p>

<p>The Database Engine provides four different backup methods:</p>

<ul>
<li><p>Full database backup</p></li>

<li><p>Differential backup</p></li>

<li><p>Transaction log backup</p></li>

<li><p>File (or filegroup) backup</p></li>
</ul>

<h3 id="full-database-backup">Full Database Backup</h3>

<p>A full database backup captures the state of the database at the time the backup is started. During the full database backup, the system copies the data as well as the schema of all tables of the database and the corresponding file structures. If the full database backup is executed dynamically, the database system records any activity that takes place during the backup. Therefore, even all uncommitted transactions in the transaction log are written to the backup media.</p>

<h3 id="differential-backup">Differential Backup</h3>

<p>A differential backup creates a copy of only the parts of the database that have changed since the last full database backup. The advantage of a differential backup is speed. It minimizes the time required to back up a database, because the amount of data to be backed up has the potential to be considerably smaller than in the case of a full database backup</p>

<h3 id="transaction-log-backup">Transaction Log Backup</h3>

<p>A transaction log backup considers only the changes recorded in the log. This form of backup is therefore not based on physical parts (pages) of the database, but rather on logical operations—that is, changes executed using the DML statements INSERT, UPDATE, and DELETE. Again, because the amount of data to be backed up has the potential to be considerably smaller, this process can be performed significantly quicker than a full database backup and quicker than a differential backup.</p>

<h2 id="file-or-filegroup-backup">File or Filegroup Backup</h2>

<p>File (or filegroup) backup allows you to back up specific database files (or filegroups) instead of the entire database.</p>

<h3 id="performing-database-backup">Performing Database Backup</h3>

<p>You can perform backup operations using the following:</p>

<ul>
<li><p>Transact-SQL statements</p></li>

<li><p>SQL Server Management Studio</p></li>
</ul>

<h2 id="performing-database-recovery">Performing Database Recovery</h2>

<p>Whenever a transaction is submitted for execution, the Database Engine is responsible either for executing the transaction completely and recording its changes permanently in the database or for guaranteeing that the transaction has no effect at all on the database.</p>

<h3 id="automatic-recovery">Automatic Recovery</h3>

<p>Automatic recovery is a fault-tolerant feature that the Database Engine executes every time it is restarted after a failure or shutdown. The automatic recovery process checks to see if the restoration of databases is necessary. If it is, each database is returned to its last consistent state using the transaction log.</p>

<p>During automatic recovery, the Database Engine examines the transaction log from the last <strong>checkpoint</strong> to the point at which the system failed or was shut down. <em>(A checkpoint is the most recent point at which all data changes are written permanently to the database from memory. Therefore, a checkpoint ensures the physical consistency of the data.)</em> The transaction log contains committed transactions (transactions that are successfully executed, but their changes have not yet been written to the database) and uncommitted transactions (transactions that are not successfully executed before a shutdown or failure occurred). The Database Engine rolls forward all committed transactions, thus making permanent changes to the database, and undoes the part of the uncommitted transactions that occurred before the checkpoint.</p>

<p>The Database Engine first performs the automatic recovery of the master database, followed by the recovery of all other system databases. Then, all user-defined databases are recovered.</p>

<h3 id="manual-recovery">Manual Recovery</h3>

<p>A manual recovery of a database specifies the application of the full backup of your database and subsequent application of all transaction logs in the sequence of their creation. (Alternatively, you can use the full database backup together with the last differential backup of the database.) After this, the database is in the same (consistent) state as it was at the point when the transaction log was backed up for the last time.</p>

<h3 id="recovery-models">Recovery Models</h3>

<p>A recovery model allows you to control to what extent you are ready to risk losing committed transactions if a database is damaged. It also determines the speed and size of your transaction log backups. Additionally, the choice of a recovery model has an impact on the size of the transaction log and therefore on the time period needed to back up the log. The Database Engine supports three recovery models:</p>

<ul>
<li><p>Full</p></li>

<li><p>Bulk-logged</p></li>

<li><p>Simple</p></li>
</ul>

<h3 id="full-recovery-model">Full Recovery Model</h3>

<p>During full recovery, all operations are written to the transaction log. Therefore, this model provides complete protection against media failure. This means that you can restore your database up to the last committed transaction that is stored in the log file. Additionally, you can recover data to any point in time (prior to the point of failure). To guarantee this, such operations as SELECT INTO and the execution of the bcp utility are fully logged too.</p>

<p>The disadvantage of this recovery model is that the corresponding transaction log may be very voluminous and the files on the disk containing the log will be filled up very quickly. Also, for such a voluminous log, you will need significantly more time for backup.</p>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use the full recovery model, the transaction log must be protected from media failure. For this reason, using RAID 1 to protect transaction logs is strongly recommended.</p>
</div>

<p>Bulk-Logged Recovery Model
Bulk-logged recovery supports log backups by using minimal space in the transaction log for certain large-scale or bulk operations. The logging of the following operations is minimal and cannot be controlled on an operation-by-operation basis:</p>

<ul>
<li><p>SELECT INTO</p></li>

<li><p>CREATE INDEX (including indexed views)</p></li>

<li><p>bcp utility</p></li>
</ul>

<p>The bulk-logged recovery model allows you to recover a database to the end of a transaction log backup (that is, up to the last committed transaction). Additionally, you can restore your database to any point in time if you haven’t performed any bulk operations.</p>

<p>The advantage of the bulk-logged recovery model is that bulk operations are performed much faster than under the full recovery model, because they are not fully logged.</p>

<h3 id="simple-recovery-model">Simple Recovery Model</h3>

<p>In the simple recovery model, the transaction log is truncated whenever a checkpoint occurs. Therefore, you can recover a damaged database only by using the full database backup or the differential backup, because they do not require log backups. Backup strategy for this model is very simple: restore the database using existing database backups and, if differential backups exist, apply the most recent one.</p>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The simple recovery model doesn’t mean that there is no logging at all. The log content won’t be used for backup purposes, but it is used at the checkpoint time, where all the transactions in the log are committed or rolled back.</p>
</div>

<p>The advantages of the simple recovery model are that the performance of all bulk operations is very high and requirements for the log space are very small. On the other hand, in the case of failure, this model requires the most manual work because all changes since the most recent database (or differential) backup must be redone. Point-in-time and page restore are not possible with this recovery model.</p>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not use the simple recovery model for production databases.</p>
</div>

<h2 id="maintenace-plans">Maintenace Plans</h2>

<p>The Maintenance Plan Wizard provides you with the set of basic tasks needed to maintain a database. It ensures that your database performs well, is regularly backed up, and is free of inconsistencies.</p>

<p>To start the Maintenance Plan Wizard, expand the server in SQL Server Management Studio, expand Management, right-click Maintenance Plans, and choose Maintenance Plan Wizard. As you can see on the starting page of the Maintenance Plan Wizard, you can perform the following administration tasks:</p>

<ul>
<li><p>Check database integrity</p></li>

<li><p>Perform index maintenance</p></li>

<li><p>Update database statistics</p></li>

<li><p>Perform database backups</p></li>
</ul>

<h3 id="maintenance-plan-scripts">Maintenance Plan Scripts</h3>

<p><a href="https://ola.hallengren.com/">https://ola.hallengren.com/</a></p>


			<aside class="copyright" role="note">
				
				&copy; 2017 Copyright 2017 Peruzal &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://guides.peruzal.com/introduction-to-sql/sql-server-architecture/" title="SQL Server Architecture">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              SQL Server Architecture
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://guides.peruzal.com/introduction-to-sql/database-security/" title="Database Security">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Database Security
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="http://guides.peruzal.com/introduction-to-sql/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

